<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CoastalME (Coastal Modelling Environment): do_beach_estimate_actual_erosion.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CoastalME (Coastal Modelling Environment)
   </div>
   <div id="projectbrief">Simulates the long-term behaviour of complex coastlines</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">do_beach_estimate_actual_erosion.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="do__beach__estimate__actual__erosion_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">/*==============================================================================================================================</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> This file is part of CoastalME, the Coastal Modelling Environment.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> CoastalME is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">==============================================================================================================================*/</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//#include &lt;assert.h&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;cfloat&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">using</span> std::cout;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">using</span> std::endl;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cme_8h.html">cme.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="simulation_8h.html">simulation.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="coast_8h.html">coast.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// /*===============================================================================================================================</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//  Since we know the potential erosion for this polygon, this routine is able to determine actual (supply-limited) erosion on the polygon in three sediment size categories. But do not do any actual erosion yet</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">// ===============================================================================================================================*/</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// int CSimulation::nEstimateBeachErosionOnPolygon(int const nCoast, int const nPoly, double const dPotentialErosionOnPolygon)</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">// {</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//    // Totals for this polygon</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//    double</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//       dTotFineEroded = 0,</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//       dTotSandEroded = 0,</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//       dTotCoarseEroded = 0;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//    // Estimate how much we can erode on this polygon: traverse the polygon&#39;s shoreline in a down-coast direction (i.e. in the direction of increasing coastpoint indices), with profiles which are parallel to the polygon&#39;s up-coast boundary</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">//    // NOTE also tried doing a second traverse, going up-coast, with profiles parallel to the down-coast boundary, if the down-coast routine was unable to reach its erosion target. But this second traverse almost always produced zero erosion, so seems not worth doing</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">//    int nRet = nTraversePolygonAndEstimateBeachErosion(nCoast, nPoly, dPotentialErosionOnPolygon, dTotFineEroded, dTotSandEroded, dTotCoarseEroded);</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">//    if (nRet != RTN_OK)</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//       return nRet;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//    // Save these values</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">//    CGeomCoastPolygon* pPolygon = m_VCoast[nCoast].pGetPolygon(nPoly);</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//    pPolygon-&gt;SetDeltaEstimatedUnconsFine(-dTotFineEroded);</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">//    pPolygon-&gt;SetDeltaEstimatedUnconsSand(-dTotSandEroded);</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//    pPolygon-&gt;SetDeltaEstimatedUnconsCoarse(-dTotCoarseEroded);</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">//    // Save the estimated values</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">//    m_dThisTimestepEstimatedActualFineBeachErosion   += dTotFineEroded;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">//    m_dThisTimestepEstimatedActualSandBeachErosion   += dTotSandEroded;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">//    m_dThisTimestepEstimatedActualCoarseBeachErosion += dTotCoarseEroded;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//    return RTN_OK;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">// }</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">/*===============================================================================================================================</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"> This routine estimates how much we can erode on this polygon from profiles which are parallel to the polygon&#39;s up-coast boundary, moving down-coast (i.e. in the direction of increasing coastpoint indices). It does not do any actual erosion. The estimated values for fine, sand, and coarse erosion are depths on a raster cell: to convert to volumes, multiply by m_dCellArea</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">===============================================================================================================================*/</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keywordtype">int</span> CSimulation::nTraversePolygonAndEstimateBeachErosion(<span class="keywordtype">int</span> <span class="keyword">const</span> nCoast, <span class="keywordtype">int</span> <span class="keyword">const</span> nPoly, <span class="keywordtype">double</span> <span class="keyword">const</span> dErosionTarget, <span class="keywordtype">double</span>&amp; dTotFineEroded, <span class="keywordtype">double</span>&amp; dTotSandEroded, <span class="keywordtype">double</span>&amp; dTotCoarseEroded)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;{</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   <span class="keywordtype">double</span> dStillToErodeOnPolygon = dErosionTarget;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   <a class="code" href="class_c_geom_coast_polygon.html">CGeomCoastPolygon</a>* pPolygon = m_VCoast[nCoast].pGetPolygon(nPoly);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   <span class="comment">// Get the up-coast and down-coast boundary details</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   <span class="keywordtype">int</span> nUpCoastProfile = pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aa717d51fde4419cad26236395d047b71">nGetUpCoastProfile</a>();</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   <a class="code" href="class_c_geom_profile.html">CGeomProfile</a>* pUpCoastProfile = m_VCoast[nCoast].pGetProfile(nUpCoastProfile);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   <span class="keywordtype">int</span> nDownCoastProfile = pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#ae2119674d8d0b78f27bc53ed463fead2">nGetDownCoastProfile</a>();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   <a class="code" href="class_c_geom_profile.html">CGeomProfile</a>* pDownCoastProfile = m_VCoast[nCoast].pGetProfile(nDownCoastProfile);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   <span class="comment">// We will use only part of the up-coast boundary profile, seaward as far as the depth of closure. First find the seaward end point of this up-coast part-profile. Note that this does not change as the landwards offset changes</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   <span class="keywordtype">int</span> nIndex = pUpCoastProfile-&gt;<a class="code" href="class_c_geom_profile.html#a10971c49bfeae2df1e16899743662fe4">nGetCellGivenDepth</a>(m_pRasterGrid, m_dDepthOfClosure);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   <span class="keywordflow">if</span> (nIndex == <a class="code" href="cme_8h.html#aee2e0742555937187504ee86b95bc29c">INT_NODATA</a>)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; <a class="code" href="cme_8h.html#ab0094f1ece3facf8eb8afd210a7a7835">ERR</a> &lt;&lt; <span class="stringliteral">&quot;while estimating beach erosion for polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot;, could not find the seaward end point of the up-coast profile (&quot;</span> &lt;&lt; nUpCoastProfile &lt;&lt; <span class="stringliteral">&quot;) for depth of closure = &quot;</span> &lt;&lt; m_dDepthOfClosure &lt;&lt; endl;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="cme_8h.html#acb051023b7bfd97c6178b7e4223bb88a">RTN_ERR_NO_SEAWARD_END_OF_PROFILE_1</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   <span class="comment">// The part-profile length is one greater than nIndex, since pPtiGetCellGivenDepth() returns the index of the cell at the depth of closure</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   <span class="keywordtype">int</span> nUpCoastPartProfileLen = nIndex + 1;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <span class="comment">//    assert(bIsWithinValidGrid(&amp;PtiUpCoastPartProfileSeawardEnd));</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="comment">// Store the cell co-ordinates of the boundary part-profile in reverse (sea to coast) order so we can append to the coastward end as we move inland (i.e. as nInlandOffset increases)</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   vector&lt;CGeom2DIPoint&gt; PtiVUpCoastPartProfileCell;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nUpCoastPartProfileLen; n++)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      PtiVUpCoastPartProfileCell.push_back(*pUpCoastProfile-&gt;<a class="code" href="class_c_geom_profile.html#a6d13079f744085f2d132405e0120ca54">pPtiGetCellInProfile</a>(nUpCoastPartProfileLen - n - 1));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   <span class="keywordtype">int</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      nUpCoastProfileCoastPoint = pUpCoastProfile-&gt;<a class="code" href="class_c_geom_profile.html#a0aead517e2105d6c1a14c27126b1fe92">nGetNumCoastPoint</a>(),</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      nDownCoastProfileCoastPoint = pDownCoastProfile-&gt;<a class="code" href="class_c_geom_profile.html#a0aead517e2105d6c1a14c27126b1fe92">nGetNumCoastPoint</a>(),</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      nXUpCoastProfileExistingCoastPoint = m_VCoast[nCoast].pPtiGetCellMarkedAsCoastline(nUpCoastProfileCoastPoint)-&gt;nGetX(),</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      nYUpCoastProfileExistingCoastPoint = m_VCoast[nCoast].pPtiGetCellMarkedAsCoastline(nUpCoastProfileCoastPoint)-&gt;nGetY(),</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      nCoastSegLen;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <span class="comment">// Store the coast point numbers for this polygon so that we can shuffle them</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   vector&lt;int&gt; nVCoastPoint;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <span class="keywordflow">if</span> (nDownCoastProfileCoastPoint == m_VCoast[nCoast].nGetCoastlineSize()-1)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="comment">// This is the final down-coast polygon, so also include the down-coast polygon boundary</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      nCoastSegLen = nDownCoastProfileCoastPoint - nUpCoastProfileCoastPoint + 1;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoastPoint = nUpCoastProfileCoastPoint; nCoastPoint &lt;= nDownCoastProfileCoastPoint; nCoastPoint++)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;         nVCoastPoint.push_back(nCoastPoint);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="comment">// This is not the final down-coast polygon, so do not include the polygon&#39;s down-coast boundary</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      nCoastSegLen = nDownCoastProfileCoastPoint - nUpCoastProfileCoastPoint;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoastPoint = nUpCoastProfileCoastPoint; nCoastPoint &lt; nDownCoastProfileCoastPoint; nCoastPoint++)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;         nVCoastPoint.push_back(nCoastPoint);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;   }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   <span class="comment">// Estimate the volume of sediment which is to be eroded from each parallel profile</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   <span class="keywordtype">double</span> dAllSedimentTargetPerProfile = dErosionTarget / nCoastSegLen ;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   <span class="comment">// If there is zero (or near zero) sediment to erode, then just return</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   <span class="keywordflow">if</span> (bFPIsEqual(dAllSedimentTargetPerProfile, 0, <a class="code" href="cme_8h.html#a89311a98397f9d6967d2cb10d5152d77">TOLERANCE</a>))</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="cme_8h.html#a71d8d6db0e41ed2022d0a95b9a70528c">RTN_OK</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <span class="comment">// Shuffle the coast points, this is necessary so that leaving the loop does not create sequence-related artefacts</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   Rand1Shuffle(&amp;(nVCoastPoint.at(0)), nCoastSegLen);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   <span class="comment">// Traverse the polygon&#39;s existing coastline in a DOWN-COAST (i.e. increasing coastpoint indices) sequence, at each coast point fitting a Dean profile which is parallel to the up-coast polygon boundary</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nCoastSegLen; n++)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="comment">// Get the coast point</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordtype">int</span> nCoastPoint = nVCoastPoint[n];</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <a class="code" href="class_c_geom2_d_i_point.html">CGeom2DIPoint</a> PtiCoastPoint = *m_VCoast[nCoast].pPtiGetCellMarkedAsCoastline(nCoastPoint);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordtype">int</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;         nCoastX = PtiCoastPoint.<a class="code" href="class_c_geom2_d_i_point.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>(),</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;         nCoastY = PtiCoastPoint.<a class="code" href="class_c_geom2_d_i_point.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>();</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">//       LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: nCoastX = &quot; &lt;&lt; nCoastX &lt;&lt; &quot;, nCoastY = &quot; &lt;&lt; nCoastY &lt;&lt; &quot;, this is {&quot; &lt;&lt; dGridCentroidXToExtCRSX(nCoastX) &lt;&lt; &quot;, &quot; &lt;&lt;  dGridCentroidYToExtCRSY(nCoastY) &lt;&lt; &quot;}&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="comment">// Is the coast cell an intervention structure?</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordflow">if</span> (m_pRasterGrid-&gt;m_Cell[nCoastX][nCoastY].<a class="code" href="class_c_geom_cell.html#af1321d6f96845f7933e6d7167267ed41">pGetLandform</a>()-&gt;<a class="code" href="class_c_r_w_cell_landform.html#a5350a7ac48d1eef3a78bef9bcf041b45">nGetLFCategory</a>() == <a class="code" href="cme_8h.html#ad4c91de5db6eb59e27fe49d05080ca6b">LF_CAT_INTERVENTION</a>)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;         <span class="comment">// No erosion possible on this parallel profile, so move on</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">//          LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: intervention structure at coast point [&quot; &lt;&lt; nCoastX &lt;&lt; &quot;][&quot; &lt;&lt; nCoastY &lt;&lt; &quot;] = {&quot; &lt;&lt; dGridCentroidXToExtCRSX(nCoastX) &lt;&lt; &quot;, &quot; &lt;&lt;  dGridCentroidYToExtCRSY(nCoastY) &lt;&lt; &quot;}, cannot erode this parallel profile&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;         <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">//       LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: PtiVUpCoastPartProfileCell.back().nGetX() = &quot; &lt;&lt; PtiVUpCoastPartProfileCell.back().nGetX() &lt;&lt; &quot;, PtiVUpCoastPartProfileCell.back().nGetY() = &quot; &lt;&lt; PtiVUpCoastPartProfileCell.back().nGetY() &lt;&lt; &quot;, this is {&quot; &lt;&lt; dGridCentroidXToExtCRSX(PtiVUpCoastPartProfileCell.back().nGetX()) &lt;&lt; &quot;, &quot; &lt;&lt;  dGridCentroidYToExtCRSY(PtiVUpCoastPartProfileCell.back().nGetY()) &lt;&lt; &quot;}&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="comment">// Not an intervention structure, so calculate the x-y offset between this coast point, and the coast point of the up-coast normal</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordtype">int</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;         nXOffset = nCoastX - PtiVUpCoastPartProfileCell.back().nGetX(),</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;         nYOffset = nCoastY - PtiVUpCoastPartProfileCell.back().nGetY();</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="comment">// Get the x-y coords of a profile starting from this coast point and parallel to the up-coast polygon boundary profile (these are in reverse sequence, like the boundary part-profile)</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      vector&lt;CGeom2DIPoint&gt; VPtiParProfile;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; nUpCoastPartProfileLen; m++)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;         <span class="comment">// TODO check that each point is within valid grid, do same for other similar places in rest of model</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;         <a class="code" href="class_c_geom2_d_i_point.html">CGeom2DIPoint</a> PtiTmp(PtiVUpCoastPartProfileCell[m].nGetX() + nXOffset, PtiVUpCoastPartProfileCell[m].nGetY() + nYOffset);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;         VPtiParProfile.push_back(PtiTmp);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="comment">// Get the elevations of the start and end points of the parallel profiles (as we extend the profile inland, the elevation of the new coast point of the Dean profile is set to the elevation of the original coast point)</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordtype">int</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;         nParProfEndX = VPtiParProfile[0].nGetX(),</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;         nParProfEndY = VPtiParProfile[0].nGetY();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="comment">// Safety check</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keywordflow">if</span> (! bIsWithinValidGrid(nParProfEndX, nParProfEndY))</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">//          LogStream &lt;&lt; WARN &lt;&lt; &quot;01 @@@@ while estimating actual beach erosion for coast &quot; &lt;&lt; nCoast &lt;&lt; &quot; polygon &quot; &lt;&lt; nPoly &lt;&lt; &quot;, hit edge of grid at [&quot; &lt;&lt; nParProfEndX &lt;&lt; &quot;][&quot; &lt;&lt; nParProfEndY &lt;&lt; &quot;] for parallel profile from coast point &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; at [&quot; &lt;&lt; nCoastX &lt;&lt; &quot;][&quot; &lt;&lt; nCoastY &lt;&lt; &quot;]. Constraining this parallel profile at its seaward end&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;         KeepWithinValidGrid(nCoastX, nCoastY, nParProfEndX, nParProfEndY);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;         VPtiParProfile[0].SetX(nParProfEndX);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;         VPtiParProfile[0].SetY(nParProfEndY);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;         bHitEdge = <span class="keyword">false</span>,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;         bEndProfile = <span class="keyword">false</span>,</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;         bZeroGradient = <span class="keyword">false</span>,</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;         bEnoughEroded = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordtype">int</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;         nParProfLen,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;         nInlandOffset = -1;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordtype">double</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;         dParProfCoastElev = m_pRasterGrid-&gt;m_Cell[nCoastX][nCoastY].<a class="code" href="class_c_geom_cell.html#a6387aaac391af63a9f2be1c809ce169c">dGetSedimentTopElev</a>(),</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;         dParProfEndElev = m_pRasterGrid-&gt;m_Cell[nParProfEndX][nParProfEndY].<a class="code" href="class_c_geom_cell.html#a6387aaac391af63a9f2be1c809ce169c">dGetSedimentTopElev</a>();</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      vector&lt;double&gt; VdParProfileDeanElev;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="comment">// These are for saving values for each offset</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      vector&lt;int&gt; VnParProfLenEachOffset;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      vector&lt;double&gt; VdAmountEachOffset;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      vector&lt; vector&lt;CGeom2DIPoint&gt; &gt; VVPtiParProfileEachOffset;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      vector&lt; vector&lt;double&gt; &gt; VVdParProfileDeanElevEachOffset;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="comment">// OK, loop either until we can erode sufficient unconsolidated sediment, or until the landwards-moving parallel profile hits the grid edge</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;         <span class="comment">// Move inland by one cell</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;         nInlandOffset++;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;         <span class="keywordflow">if</span> (nInlandOffset &gt; 0)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;         {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keywordflow">if</span> (nInlandOffset &gt; (pUpCoastProfile-&gt;<a class="code" href="class_c_geom_profile.html#a8a29c3fa364ab1f7b3930b7a9c83f45f">nGetNumCellsInProfile</a>()-1))</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">//                LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: reached end of up-coast profile &quot; &lt;&lt; nUpCoastProfile &lt;&lt; &quot; during down-coast ESTIMATION of actual beach erosion for coast &quot; &lt;&lt; nCoast &lt;&lt; &quot; polygon &quot; &lt;&lt; nPoly &lt;&lt; &quot; (nCoastPoint = &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; nInlandOffset = &quot; &lt;&lt; nInlandOffset &lt;&lt; &quot;)&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;               bEndProfile = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;               <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="comment">// Extend the parallel profile by one cell in the coastward direction. First get the coords of the cell that is nInlandOffset cells seaward from the existing up-coast part-profile start point</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <a class="code" href="class_c_geom2_d_i_point.html">CGeom2DIPoint</a> PtiUpCoastTmp = *pUpCoastProfile-&gt;<a class="code" href="class_c_geom_profile.html#a6d13079f744085f2d132405e0120ca54">pPtiGetCellInProfile</a>(nInlandOffset);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="comment">// Then get the offset between this PtiUpCoastTmp cell and the existing up-coast part-profile start point, and use the reverse of this offset to get the co-ords of the cell that extends the existing up-coast part-profile landwards</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="keywordtype">int</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;               nXUpCoastStartOffset = PtiUpCoastTmp.<a class="code" href="class_c_geom2_d_i_point.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>() - nXUpCoastProfileExistingCoastPoint,</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;               nYUpCoastStartOffset = PtiUpCoastTmp.<a class="code" href="class_c_geom2_d_i_point.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>() - nYUpCoastProfileExistingCoastPoint,</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;               nXUpCoastThisStart = nCoastX - nXUpCoastStartOffset,</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;               nYUpCoastThisStart = nCoastY - nYUpCoastStartOffset;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="comment">// Is the new landwards point within the raster grid?</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="keywordflow">if</span> (! bIsWithinValidGrid(nXUpCoastThisStart, nYUpCoastThisStart))</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;               <span class="comment">// It isn&#39;t</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">//                LogStream &lt;&lt; WARN &lt;&lt; &quot;reached edge of grid at [&quot; &lt;&lt; nXUpCoastThisStart &lt;&lt; &quot;][&quot; &lt;&lt; nYUpCoastThisStart &lt;&lt; &quot;] = {&quot; &lt;&lt; dGridCentroidXToExtCRSX(nXUpCoastThisStart) &lt;&lt; &quot;, &quot; &lt;&lt; dGridCentroidYToExtCRSY(nYUpCoastThisStart) &lt;&lt; &quot;} during DOWN-COAST estimation of beach erosion for coast &quot; &lt;&lt; nCoast &lt;&lt; &quot; polygon &quot; &lt;&lt; nPoly &lt;&lt; &quot;, nCoastPoint = &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot;, this is [&quot; &lt;&lt; nCoastX &lt;&lt; &quot;][&quot; &lt;&lt; nCoastY &lt;&lt; &quot;] = {&quot; &lt;&lt; dGridCentroidXToExtCRSX(nCoastX) &lt;&lt; &quot;, &quot; &lt;&lt;  dGridCentroidYToExtCRSY(nCoastY) &lt;&lt; &quot;}, nInlandOffset = &quot; &lt;&lt; nInlandOffset &lt;&lt; &quot;)&quot; &lt;&lt; endl &lt;&lt; endl;</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;               <span class="comment">// TODO Need to improve this: at present we just abandon erosion on this coast point and move to another coast point</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;               bHitEdge = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;               <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <a class="code" href="class_c_geom2_d_i_point.html">CGeom2DIPoint</a> PtiThisUpCoastStart(nXUpCoastThisStart, nYUpCoastThisStart);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="comment">// Calculate the co-ords of a possible new landwards cell for the parallel profile</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="keywordtype">int</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;               nXParNew = nXUpCoastThisStart + nXOffset,</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;               nYParNew = nYUpCoastThisStart + nYOffset;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="comment">// Safety check</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="keywordflow">if</span> (! bIsWithinValidGrid(nXParNew, nYParNew))</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">//                LogStream &lt;&lt; WARN &lt;&lt; &quot;02 @@@@ while estimating actual beach erosion on coast &quot; &lt;&lt; nCoast &lt;&lt; &quot; polygon &quot; &lt;&lt; nPoly &lt;&lt; &quot; (nInlandOffset = &quot; &lt;&lt; nInlandOffset &lt;&lt; &quot;), outside valid grid at [&quot; &lt;&lt; nXParNew &lt;&lt; &quot;][&quot; &lt;&lt; nYParNew &lt;&lt; &quot;] for parallel profile from coast point &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; at [&quot; &lt;&lt; nCoastX &lt;&lt; &quot;][&quot; &lt;&lt; nCoastY &lt;&lt; &quot;]. Constraining this parallel profile at its landward end, is now [&quot;;</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;               KeepWithinValidGrid(nCoastX, nCoastY, nXParNew, nYParNew);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">//                LogStream &lt;&lt; &quot;[&quot; &lt;&lt; nXParNew &lt;&lt; &quot;][&quot; &lt;&lt; nYParNew &lt;&lt; &quot;] = {&quot; &lt;&lt; dGridCentroidXToExtCRSX(nXParNew) &lt;&lt; &quot;, &quot; &lt;&lt;  dGridCentroidYToExtCRSY(nYParNew) &lt;&lt; &quot;}&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;               <span class="comment">// Is this cell already in the parallel profile?</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;               <span class="keywordflow">if</span> ((VPtiParProfile.back().nGetX() != nXParNew) || (VPtiParProfile.back().nGetY() != nYParNew))</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;               {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                  <span class="comment">// It isn&#39;t, so append it to the parallel profile</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                  <a class="code" href="class_c_geom2_d_i_point.html">CGeom2DIPoint</a> PtiTmp(nXParNew, nYParNew);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                  VPtiParProfile.push_back(PtiTmp);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;               }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;               <span class="comment">// No problem, so just append this to the parallel profile</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;               <a class="code" href="class_c_geom2_d_i_point.html">CGeom2DIPoint</a> PtiTmp(nXParNew, nYParNew);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;               VPtiParProfile.push_back(PtiTmp);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;         }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;         nParProfLen = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(VPtiParProfile.size());</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;         <span class="keywordflow">if</span> (nParProfLen &lt; <a class="code" href="cme_8h.html#a1c2e8afbb6c48aa6e2ee71105410df4f">MIN_PAR_PROFILE_SIZE</a>)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;         {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="comment">// Can&#39;t have a meaningful parallel profile with very few points</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: only &quot; &lt;&lt; nParProfLen &lt;&lt; &quot; points in parallel profile, min is &quot; &lt;&lt; MIN_PAR_PROFILE_SIZE &lt;&lt; &quot;, abandoning&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;         }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">//          for (int m = 0; m &lt; static_cast&lt;int&gt;(VPtiParProfile.size()); m++)</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">//             LogStream &lt;&lt; &quot;[&quot; &lt;&lt; VPtiParProfile[m].nGetX() &lt;&lt; &quot;][&quot; &lt;&lt; VPtiParProfile[m].nGetY() &lt;&lt; &quot;] &quot;;</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">//          LogStream &lt;&lt; endl;</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;         <span class="comment">// Get the distance between the start and end of the parallel profile, in external CRS units. Note that the parallel profile co-ords are in reverse sequence</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;         <a class="code" href="class_c_geom2_d_point.html">CGeom2DPoint</a></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            PtStart = PtGridCentroidToExt(&amp;VPtiParProfile.back()),</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            PtEnd = PtGridCentroidToExt(&amp;VPtiParProfile[0]);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;         <span class="comment">// Calculate the length of the parallel profile</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;         <span class="keywordtype">double</span> dParProfileLen = dGetDistanceBetween(&amp;PtStart, &amp;PtEnd);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;         <span class="comment">// Calculate the elevation difference between the start and end of the parallel profile</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;         <span class="keywordtype">double</span> dElevDiff = dParProfCoastElev - dParProfEndElev;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;         <span class="keywordflow">if</span> (bFPIsEqual(dElevDiff, 0, <a class="code" href="cme_8h.html#a89311a98397f9d6967d2cb10d5152d77">TOLERANCE</a>))</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;         {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="comment">// Can&#39;t have a meaningful Dean profile with a near-zero elevation difference</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="comment">// TODO Need to improve this: at present we just abandon erosion on this coast point and move to another coast point</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: zero gradient on parallel profile, abandoning&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            bZeroGradient = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;         }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;         <span class="comment">// Solve for dA so that the existing elevations at the end of the parallel profile, and at the end of a Dean equilibrium profile on that part-normal, are the same</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;         <span class="keywordtype">double</span> dParProfA = dElevDiff / pow(dParProfileLen, <a class="code" href="cme_8h.html#abf75660f1852737d3c9eedbb52e8def2">DEAN_POWER</a>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;         VdParProfileDeanElev.resize(nParProfLen, 0);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;         <span class="keywordtype">double</span> dInc = dParProfileLen / (nParProfLen-1);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;         <span class="comment">// For the parallel profile, calculate the Dean equilibrium profile of the unconsolidated sediment h(y) = A * y^(2/3) where h(y) is the distance below the highest point in the profile at a distance y from the landward start of the profile</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;         CalcDeanProfile(&amp;VdParProfileDeanElev, dInc, dParProfCoastElev, dParProfA, <span class="keyword">false</span>, 0, 0);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;         vector&lt;double&gt; dVParProfileNow(nParProfLen, 0);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;         vector&lt;bool&gt; bVProfileValid(nParProfLen, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; nParProfLen; m++)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;         {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keywordtype">int</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;               nX = VPtiParProfile[nParProfLen - m - 1].nGetX(),</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;               nY = VPtiParProfile[nParProfLen - m - 1].nGetY();</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="comment">// Safety check</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="keywordflow">if</span> (! bIsWithinValidGrid(nX, nY))</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">//                LogStream &lt;&lt; WARN &lt;&lt; &quot;03 @@@@ while constructing parallel profile to estimate DOWN-COAST actual beach erosion on coast &quot; &lt;&lt; nCoast &lt;&lt; &quot; polygon &quot; &lt;&lt; nPoly &lt;&lt; &quot;, hit edge of grid at [&quot; &lt;&lt; nX &lt;&lt; &quot;][&quot; &lt;&lt; nY &lt;&lt; &quot;] for parallel profile from coast point &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; at [&quot; &lt;&lt; nCoastX &lt;&lt; &quot;][&quot; &lt;&lt; nCoastY &lt;&lt; &quot;]. Constraining this parallel profile at its seaward end&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;               bVProfileValid[m] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;               <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <span class="comment">// Don&#39;t erode intervention cells</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keywordflow">if</span> (m_pRasterGrid-&gt;m_Cell[nX][nY].<a class="code" href="class_c_geom_cell.html#af1321d6f96845f7933e6d7167267ed41">pGetLandform</a>()-&gt;<a class="code" href="class_c_r_w_cell_landform.html#a5350a7ac48d1eef3a78bef9bcf041b45">nGetLFCategory</a>() == <a class="code" href="cme_8h.html#ad4c91de5db6eb59e27fe49d05080ca6b">LF_CAT_INTERVENTION</a>)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;               bVProfileValid[m] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            dVParProfileNow[m] = m_pRasterGrid-&gt;m_Cell[nX][nY].<a class="code" href="class_c_geom_cell.html#a6387aaac391af63a9f2be1c809ce169c">dGetSedimentTopElev</a>();</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;         }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;         <span class="comment">// Get the total difference in elevation (present profile - Dean profile)</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;         <span class="keywordtype">double</span> dParProfTotDiff = dSubtractProfiles(&amp;dVParProfileNow, &amp;VdParProfileDeanElev, &amp;bVProfileValid);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;         <span class="comment">// DEBUG STUFF -----------------------------------------------------</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">//          LogStream &lt;&lt; m_ulIter&lt;&lt; &quot;: in polygon &quot; &lt;&lt; nPoly &lt;&lt; &quot; at coast point &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; doing DOWN-COAST estimation of actual beach erosion, parallel profile with nInlandOffset = &quot; &lt;&lt; nInlandOffset &lt;&lt; &quot;, from [&quot; &lt;&lt; VPtiParProfile.back().nGetX() &lt;&lt; &quot;][&quot; &lt;&lt; VPtiParProfile.back().nGetY() &lt;&lt; &quot;] = {&quot; &lt;&lt; dGridCentroidXToExtCRSX(VPtiParProfile.back().nGetX()) &lt;&lt; &quot;, &quot; &lt;&lt;  dGridCentroidYToExtCRSY(VPtiParProfile.back().nGetY()) &lt;&lt; &quot;} to [&quot; &lt;&lt; VPtiParProfile[0].nGetX() &lt;&lt; &quot;][&quot; &lt;&lt; VPtiParProfile[0].nGetY() &lt;&lt; &quot;] = {&quot; &lt;&lt; dGridCentroidXToExtCRSX(VPtiParProfile[0].nGetX()) &lt;&lt; &quot;, &quot; &lt;&lt;  dGridCentroidYToExtCRSY(VPtiParProfile[0].nGetY()) &lt;&lt; &quot;}, nParProfLen = &quot; &lt;&lt; nParProfLen &lt;&lt; &quot; dParProfileLen = &quot; &lt;&lt; dParProfileLen &lt;&lt; &quot; dParProfCoastElev = &quot; &lt;&lt; dParProfCoastElev &lt;&lt; &quot; dParProfEndElev = &quot; &lt;&lt; dParProfEndElev &lt;&lt; &quot; dParProfA = &quot; &lt;&lt; dParProfA &lt;&lt; endl;</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">//          LogStream &lt;&lt; &quot;Profile now:&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">//          for (int n = 0; n &lt; nParProfLen; n++)</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">//          {</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">//             if (bVProfileValid[n])</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">//                LogStream &lt;&lt; dVParProfileNow[n] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">//             else</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">//                LogStream &lt;&lt; &quot;XXX &quot;;</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">//          LogStream &lt;&lt; endl &lt;&lt; endl;;</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">//          LogStream &lt;&lt; &quot;Parallel Dean profile for erosion:&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">//          for (int n = 0; n &lt; nParProfLen; n++)</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">//          {</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">//             if (bVProfileValid[n])</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">//                LogStream &lt;&lt; VdParProfileDeanElev[n] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">//             else</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">//                LogStream &lt;&lt; &quot;XXX &quot;;</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">//          LogStream &lt;&lt; endl &lt;&lt; endl;</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">//          LogStream &lt;&lt; &quot;Difference (present profile minus Dean profile):&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">//          for (int n = 0; n &lt; nParProfLen; n++)</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">//          {</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">//             if (bVProfileValid[n])</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">//                LogStream &lt;&lt; dVParProfileNow[n] - VdParProfileDeanElev[n] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">//             else</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">//                LogStream &lt;&lt; &quot;XXX &quot;;</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">//          LogStream &lt;&lt; endl &lt;&lt; endl;</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">//          LogStream &lt;&lt; &quot;dParProfTotDiff = &quot; &lt;&lt; dParProfTotDiff &lt;&lt; &quot; dAllSedimentTargetPerProfile = &quot; &lt;&lt; dAllSedimentTargetPerProfile &lt;&lt; endl;</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;         <span class="comment">// DEBUG STUFF -----------------------------------------------------</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;         <span class="comment">// So will we be able to erode as much as is needed?</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;         <span class="keywordflow">if</span> (dParProfTotDiff &gt; dAllSedimentTargetPerProfile)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;         {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">//             LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: in polygon &quot; &lt;&lt; nPoly &lt;&lt; &quot; at coast point &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; doing DOWN-COAST estimation of actual beach erosion for parallel profile with nInlandOffset = &quot; &lt;&lt; nInlandOffset &lt;&lt; &quot;, can meet erosion target: dParProfTotDiff = &quot; &lt;&lt; dParProfTotDiff &lt;&lt; &quot; dAllSedimentTargetPerProfile = &quot; &lt;&lt; dAllSedimentTargetPerProfile &lt;&lt; endl;</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            bEnoughEroded = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;         }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;         <span class="comment">// We have not been able to reach the erosion target for this parallel profile. Now, if we have moved at least MIN_INLAND_OFFSET_FOR_BEACH_EROSION_ESTIMATION cells inland, and dParProfTotDiff is zero, break out of the loop</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;         <span class="keywordflow">if</span> ((nInlandOffset &gt;= <a class="code" href="cme_8h.html#aefd6cc6a56f74f477743b3990c472ed4">MIN_INLAND_OFFSET_FOR_BEACH_EROSION_ESTIMATION</a>) &amp;&amp; (bFPIsEqual(dParProfTotDiff, 0, <a class="code" href="cme_8h.html#a89311a98397f9d6967d2cb10d5152d77">TOLERANCE</a>)))</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;         <span class="comment">// Save the amount which can be eroded for this offset TODO save other stuff too</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;         VdAmountEachOffset.push_back(dParProfTotDiff);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;         VnParProfLenEachOffset.push_back(nParProfLen);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;         VVPtiParProfileEachOffset.push_back(VPtiParProfile);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;         VVdParProfileDeanElevEachOffset.push_back(VdParProfileDeanElev);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="comment">// If we hit the edge of the grid, or have a zero gradient on the profile, or this is an end profile, then abandon this profile and do the next parallel profile</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="comment">// TODO Improve this, see above</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keywordflow">if</span> (bHitEdge || bEndProfile || bZeroGradient)</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;         <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="comment">// OK we will do some erosion on this parallel profile, set the target for this profile to be the full target amount</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <span class="keywordtype">double</span> dStillToErodeOnProfile = dAllSedimentTargetPerProfile;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">if</span> (! bEnoughEroded)</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;         <span class="comment">// We have not been able to reach the target for erosion on this parallel profile. So find the offset that gives us the largest erosion amount</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;         <span class="keywordtype">int</span> nOffsetForLargestPossible = -1;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;         <span class="keywordtype">double</span> dLargestPossibleErosion = 0;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nn = 0; nn &lt; VdAmountEachOffset.size(); nn++)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;         {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="keywordflow">if</span> (VdAmountEachOffset[nn] &gt; dLargestPossibleErosion)</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;               dLargestPossibleErosion = VdAmountEachOffset[nn];</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;               nOffsetForLargestPossible = nn;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;         }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;         <span class="comment">// If every offset gave zero erosion then abandon this profile and do the next parallel profile</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;         <span class="keywordflow">if</span> (nOffsetForLargestPossible &lt; 0)</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;         <span class="comment">// OK, we have an offset which gives us the largest possible erosion (but less than the full target amount), continue with this</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;         nInlandOffset = nOffsetForLargestPossible;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;         dStillToErodeOnProfile = dLargestPossibleErosion;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;         nParProfLen = VnParProfLenEachOffset[nInlandOffset];</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;         VPtiParProfile = VVPtiParProfileEachOffset[nInlandOffset];</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;         VdParProfileDeanElev = VVdParProfileDeanElevEachOffset[nInlandOffset];</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">//          LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: in polygon &quot; &lt;&lt; nPoly &lt;&lt; &quot; at coast point &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; doing DOWN-COAST estimation of actual beach erosion for parallel profile with nInlandOffset = &quot; &lt;&lt; nInlandOffset &lt;&lt; &quot;, could not meet erosion target dAllSedimentTargetPerProfile = &quot; &lt;&lt; dAllSedimentTargetPerProfile &lt;&lt; &quot;, instead using best possible: nInlandOffset = &quot; &lt;&lt; nInlandOffset &lt;&lt; &quot; which gives dStillToErodeOnProfile = &quot; &lt;&lt; dStillToErodeOnProfile &lt;&lt; endl;</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <span class="comment">// OK, this value of nInlandOffset gives us some (tho&#39; maybe not enough) erosion. So calculate how much fine-, sand-, and coarse sized sediment can be obtained here by working along the parallel profile from the landward end (which is inland from the existing coast, if nInlandOffset &gt; 0)</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <span class="keywordtype">int</span> nRet = nEstimateBeachErosionOnParallelProfile(<span class="comment">/*nPoly, nCoastPoint,*/</span> nCoastX, nCoastY, <span class="comment">/* nInlandOffset, */</span> nParProfLen, &amp;VPtiParProfile, &amp;VdParProfileDeanElev, dStillToErodeOnProfile, dStillToErodeOnPolygon, dTotFineEroded, dTotSandEroded, dTotCoarseEroded);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#a71d8d6db0e41ed2022d0a95b9a70528c">RTN_OK</a>)</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;         <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">//       LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: in polygon &quot; &lt;&lt; nPoly &lt;&lt; &quot; estimating erosion: finished at coast point &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; dStillToErodeOnProfile = &quot; &lt;&lt; dStillToErodeOnProfile &lt;&lt; &quot; dAllSedimentTargetPerProfile = &quot; &lt;&lt; dAllSedimentTargetPerProfile &lt;&lt; &quot; amount eroded = &quot; &lt;&lt; dAllSedimentTargetPerProfile - dStillToErodeOnProfile &lt;&lt; endl;</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="cme_8h.html#a71d8d6db0e41ed2022d0a95b9a70528c">RTN_OK</a>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;}</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">/*===============================================================================================================================</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment"> This routine calculates the supply-limited amount of beach erosion, in three size categories, which can be eroded on this parallel profile. It does not do any actual erosion</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment"> ===============================================================================================================================*/</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keywordtype">int</span> CSimulation::nEstimateBeachErosionOnParallelProfile(<span class="comment">/*int const nPoly, int const nCoastPoint,*/</span> <span class="keywordtype">int</span> <span class="keyword">const</span> nCoastX, <span class="keywordtype">int</span> <span class="keyword">const</span> nCoastY, <span class="comment">/* int const nInlandOffset, */</span> <span class="keywordtype">int</span> <span class="keyword">const</span> nParProfLen, vector&lt;CGeom2DIPoint&gt; <span class="keyword">const</span>* pVPtiParProfile, vector&lt;double&gt; <span class="keyword">const</span>* pVdParProfileDeanElev, <span class="keywordtype">double</span>&amp; dStillToErodeOnProfile, <span class="keywordtype">double</span>&amp; dStillToErodeOnPolygon, <span class="keywordtype">double</span>&amp; dTotFineEroded, <span class="keywordtype">double</span>&amp; dTotSandEroded, <span class="keywordtype">double</span>&amp; dTotCoarseEroded)</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;{</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   <span class="keywordtype">double</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      dFineEroded = 0,                 <span class="comment">// Totals for this parallel profile</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      dSandEroded = 0,</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      dCoarseEroded = 0;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nDistSeawardFromNewCoast = 0; nDistSeawardFromNewCoast &lt; nParProfLen; nDistSeawardFromNewCoast++)</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <span class="comment">// Don&#39;t bother with tiny amounts</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <span class="keywordflow">if</span> (dStillToErodeOnProfile &lt; <a class="code" href="cme_8h.html#ab63e5883f26dfad0f0c3b7cccce87c71">SEDIMENT_ELEV_TOLERANCE</a>)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;         dStillToErodeOnProfile = 0;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="comment">// Leave the loop if we have eroded enough for this polygon</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="keywordflow">if</span> (dStillToErodeOnPolygon &lt;= 0)</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">//          LogStream &lt;&lt; m_ulIter&lt;&lt; &quot;: nPoly = &quot; &lt;&lt; nPoly &lt;&lt; &quot; nCoastPoint = &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; nInlandOffset = &quot; &lt;&lt; nInlandOffset &lt;&lt; &quot;, leaving loop because enough erosion for polygon, dStillToErodeOnPolygon = &quot; &lt;&lt; dStillToErodeOnPolygon &lt;&lt; endl;</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="comment">// Leave the loop if we have done enough erosion for this profile</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="keywordflow">if</span> (dStillToErodeOnProfile &lt;= 0)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">//          LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: in polygon &quot; &lt;&lt; nPoly &lt;&lt; &quot; at coast point &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; nInlandOffset = &quot; &lt;&lt; nInlandOffset &lt;&lt; &quot;, leaving loop because enough erosion for profile, dStillToErodeOnProfile = &quot; &lt;&lt; dStillToErodeOnProfile &lt;&lt; endl;</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <a class="code" href="class_c_geom2_d_i_point.html">CGeom2DIPoint</a> PtiTmp = pVPtiParProfile-&gt;at(nParProfLen - nDistSeawardFromNewCoast - 1);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="keywordtype">int</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;         nX = PtiTmp.<a class="code" href="class_c_geom2_d_i_point.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>(),</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;         nY = PtiTmp.<a class="code" href="class_c_geom2_d_i_point.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>();</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="comment">// Safety check</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keywordflow">if</span> (! bIsWithinValidGrid(nX, nY))</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">//             LogStream &lt;&lt; WARN &lt;&lt; &quot;04 @@@@ while estimating sediment size fractions on eroding polygon &quot; &lt;&lt; nPoly &lt;&lt; &quot;, hit edge of grid at [&quot; &lt;&lt; nParProfEndX &lt;&lt; &quot;][&quot; &lt;&lt; nParProfEndY &lt;&lt; &quot;] for parallel profile from coast point &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; at [&quot; &lt;&lt; nCoastX &lt;&lt; &quot;][&quot; &lt;&lt; nCoastY &lt;&lt; &quot;]. Constraining this parallel profile at its seaward end&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;         KeepWithinValidGrid(nCoastX, nCoastY, nX, nY);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;         PtiTmp.<a class="code" href="class_c_geom2_d_i_point.html#a84c27fdfdfca1e5222a141717ab8f6e4">SetX</a>(nX);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;         PtiTmp.<a class="code" href="class_c_geom2_d_i_point.html#a4350a3410e098a2cb27fbeaa6b12b5e5">SetY</a>(nY);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="comment">// Don&#39;t do anything to intervention cells</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="keywordflow">if</span> (m_pRasterGrid-&gt;m_Cell[nX][nY].<a class="code" href="class_c_geom_cell.html#af1321d6f96845f7933e6d7167267ed41">pGetLandform</a>()-&gt;<a class="code" href="class_c_r_w_cell_landform.html#a5350a7ac48d1eef3a78bef9bcf041b45">nGetLFCategory</a>() == <a class="code" href="cme_8h.html#ad4c91de5db6eb59e27fe49d05080ca6b">LF_CAT_INTERVENTION</a>)</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;         <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      <span class="comment">// Don&#39;t do cells twice</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <span class="keywordflow">if</span> (! m_pRasterGrid-&gt;m_Cell[nX][nY].<a class="code" href="class_c_geom_cell.html#ae655afb832998a438f07595a78c8766a">bGetActualBeachErosionEstimated</a>())</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;         <span class="comment">// Set flag so we don&#39;t estimate erosion/deposition on this cell again</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;         m_pRasterGrid-&gt;m_Cell[nX][nY].<a class="code" href="class_c_geom_cell.html#a78b09fa78835ecf75b4206f77021ce08">SetActualBeachErosionEstimated</a>();</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;         <span class="comment">// Get this cell&#39;s current elevation</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;         <span class="keywordtype">double</span> dThisElevNow = m_pRasterGrid-&gt;m_Cell[nX][nY].<a class="code" href="class_c_geom_cell.html#a6387aaac391af63a9f2be1c809ce169c">dGetSedimentTopElev</a>();</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">//             LogStream &lt;&lt; &quot;\tnPoly = &quot; &lt;&lt; nPoly &lt;&lt; &quot;, [&quot; &lt;&lt; nX &lt;&lt; &quot;][&quot; &lt;&lt; nY &lt;&lt; &quot;] = {&quot; &lt;&lt; dGridCentroidXToExtCRSX(nX) &lt;&lt; &quot;, &quot; &lt;&lt;  dGridCentroidYToExtCRSY(nY) &lt;&lt; &quot;}  nCoastPoint = &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; nDistSeawardFromNewCoast = &quot; &lt;&lt; nDistSeawardFromNewCoast &lt;&lt; &quot; dThisElevNow = &quot; &lt;&lt; dThisElevNow &lt;&lt; &quot; Dean Elev = &quot; &lt;&lt; VdParProfileDeanElev[nDistSeawardFromNewCoast] &lt;&lt; endl;</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;         <span class="comment">// Subtract the two elevations</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;         <span class="keywordtype">double</span> dElevDiff = dThisElevNow - pVdParProfileDeanElev-&gt;at(nDistSeawardFromNewCoast);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;         <span class="keywordflow">if</span> (dElevDiff &gt; <a class="code" href="cme_8h.html#ab63e5883f26dfad0f0c3b7cccce87c71">SEDIMENT_ELEV_TOLERANCE</a>)</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;         {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            <span class="comment">// The current elevation is higher than the Dean elevation, so we have possible beach erosion (i.e. if not constrained by availability of unconsolidated sediment) here</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">//                LogStream &lt;&lt; &quot;\tnPoly = &quot; &lt;&lt; nPoly &lt;&lt; &quot; doing DOWN-COAST, possible beach erosion = &quot; &lt;&lt; dElevDiff &lt;&lt; &quot; at [&quot; &lt;&lt; nX &lt;&lt; &quot;][&quot; &lt;&lt; nY &lt;&lt; &quot;] = {&quot; &lt;&lt; dGridCentroidXToExtCRSX(nX) &lt;&lt; &quot;, &quot; &lt;&lt;  dGridCentroidYToExtCRSY(nY) &lt;&lt; &quot;} nCoastPoint = &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; nDistSeawardFromNewCoast = &quot; &lt;&lt; nDistSeawardFromNewCoast &lt;&lt; &quot; dThisElevNow = &quot; &lt;&lt; dThisElevNow &lt;&lt; &quot; Dean Elev = &quot; &lt;&lt; VdParProfileDeanElev[nDistSeawardFromNewCoast] &lt;&lt; endl;</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <span class="comment">// Now get the number of the highest layer with non-zero thickness</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            <span class="keywordtype">int</span> nThisLayer = m_pRasterGrid-&gt;m_Cell[nX][nY].<a class="code" href="class_c_geom_cell.html#a43434d6fd45da697ae17f7b274ba9a83">nGetTopNonZeroLayerAboveBasement</a>();</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="comment">// Safety check</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            <span class="keywordflow">if</span> (nThisLayer == <a class="code" href="cme_8h.html#aee2e0742555937187504ee86b95bc29c">INT_NODATA</a>)</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;               <span class="keywordflow">return</span> <a class="code" href="cme_8h.html#ac8de8e3c8f526683cf8a372e00bdcde3">RTN_ERR_NO_TOP_LAYER</a>;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            <span class="keywordflow">if</span> (nThisLayer != <a class="code" href="cme_8h.html#a6da5abe13cf250e9663012ef6633d92a">NO_NONZERO_THICKNESS_LAYERS</a>)</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;               <span class="comment">// We still have at least one layer left with non-zero thickness (i.e. we are not down to basement), and the cell&#39;s current elevation is higher than the Dean equilibrium profile elevation. So estimate some beach erosion</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;               <span class="keywordtype">double</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                  dToErode = <a class="code" href="cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a>(dElevDiff, dStillToErodeOnProfile, dStillToErodeOnPolygon),</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                  dFine = 0,</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                  dSand = 0,</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                  dCoarse = 0;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">//                assert(dToErode &gt; 0);</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;               EstimateActualBeachErosionOnCell(nX, nY, nThisLayer, dToErode, dFine, dSand, dCoarse);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;               <span class="comment">// Totals for this parallel profile</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;               dFineEroded += dFine;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;               dSandEroded += dSand;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;               dCoarseEroded += dCoarse;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;               dTotFineEroded += dFine;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;               dTotSandEroded += dSand;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;               dTotCoarseEroded += dCoarse;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;               <span class="keywordtype">double</span> dTmpTot = dFine + dSand + dCoarse;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;               dStillToErodeOnProfile -= dTmpTot;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;               dStillToErodeOnPolygon -= dTmpTot;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">//                   LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: in polygon&quot; &lt;&lt; nPoly &lt;&lt; &quot;, estimated actual beach erosion = &quot; &lt;&lt; dTmpTot &lt;&lt; &quot; at [&quot; &lt;&lt; nX &lt;&lt; &quot;][&quot; &lt;&lt; nY &lt;&lt; &quot;] = {&quot; &lt;&lt; dGridCentroidXToExtCRSX(nX) &lt;&lt; &quot;, &quot; &lt;&lt;  dGridCentroidYToExtCRSY(nY) &lt;&lt; &quot;}  nCoastPoint = &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; nDistSeawardFromNewCoast = &quot; &lt;&lt; nDistSeawardFromNewCoast &lt;&lt; endl;</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;         }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((dElevDiff &lt; -<a class="code" href="cme_8h.html#ab63e5883f26dfad0f0c3b7cccce87c71">SEDIMENT_ELEV_TOLERANCE</a>) &amp;&amp; ((m_pRasterGrid-&gt;m_Cell[nX][nY].<a class="code" href="class_c_geom_cell.html#a28b760b0a9e63afd01e29610888fc7bc">bIsInContiguousSea</a>()) || (m_pRasterGrid-&gt;m_Cell[nX][nY].<a class="code" href="class_c_geom_cell.html#af1321d6f96845f7933e6d7167267ed41">pGetLandform</a>()-&gt;<a class="code" href="class_c_r_w_cell_landform.html#a5350a7ac48d1eef3a78bef9bcf041b45">nGetLFCategory</a>() == <a class="code" href="cme_8h.html#a7abec008cf84fe3fe52ac3158ff7df7d">LF_CAT_DRIFT</a>)))</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;         {</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <span class="comment">// The current elevation is below the Dean elevation, so we have can have beach deposition here provided that we have some previously-eroded unconsolidated sediment (sand and coarse only) to deposit</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <span class="keywordtype">double</span> dTotSandAndCoarseEroded = dTotSandEroded + dTotCoarseEroded;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="keywordflow">if</span> (dTotSandAndCoarseEroded &gt; <a class="code" href="cme_8h.html#ab63e5883f26dfad0f0c3b7cccce87c71">SEDIMENT_ELEV_TOLERANCE</a>)</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;               <span class="comment">// Assume that the sediment size fractions which are deposited are in the same ratios as the previously-eroded sediment</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;               <span class="keywordtype">double</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                  dToDeposit = <a class="code" href="cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a>(-dElevDiff, dTotSandAndCoarseEroded),</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                  dSandProp = dTotSandEroded / dTotSandAndCoarseEroded,</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                  dCoarseProp = 1 - dSandProp,</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                  dSandToDeposit = <a class="code" href="cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a>(dToDeposit * dSandProp, dTotSandEroded),</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                  dCoarseToDeposit = <a class="code" href="cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a>(dToDeposit * dCoarseProp, dTotCoarseEroded);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;               <span class="keywordflow">if</span> (dSandToDeposit &gt; <a class="code" href="cme_8h.html#ab63e5883f26dfad0f0c3b7cccce87c71">SEDIMENT_ELEV_TOLERANCE</a>)</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;               {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                  <span class="comment">// Totals for this parallel profile</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                  dSandEroded -= dSandToDeposit;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                  dStillToErodeOnProfile += dSandToDeposit;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                  <span class="comment">// Totals for the polygon</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                  dTotSandEroded -= dSandToDeposit;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                  dStillToErodeOnPolygon += dSandToDeposit;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;               }</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;               <span class="keywordflow">if</span> (dCoarseToDeposit &gt; <a class="code" href="cme_8h.html#ab63e5883f26dfad0f0c3b7cccce87c71">SEDIMENT_ELEV_TOLERANCE</a>)</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;               {</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                  <span class="comment">// Totals for this parallel profile</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                  dCoarseEroded -= dCoarseToDeposit;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                  dStillToErodeOnProfile += dCoarseToDeposit;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                  <span class="comment">// Totals for the polygon</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                  dTotCoarseEroded -= dCoarseToDeposit;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                  dStillToErodeOnPolygon += dCoarseToDeposit;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;               }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">//                LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: nPoly = &quot; &lt;&lt; nPoly &lt;&lt; &quot; nCoastPoint = &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; nDistSeawardFromNewCoast = &quot; &lt;&lt; nDistSeawardFromNewCoast &lt;&lt; &quot;, beach deposition = &quot; &lt;&lt; dSandToDeposit + dCoarseToDeposit &lt;&lt; &quot; at [&quot; &lt;&lt; nX &lt;&lt; &quot;][&quot; &lt;&lt; nY &lt;&lt; &quot;] = {&quot; &lt;&lt; dGridCentroidXToExtCRSX(nX) &lt;&lt; &quot;, &quot; &lt;&lt;  dGridCentroidYToExtCRSY(nY) &lt;&lt; &quot;}&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;         }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;   }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="cme_8h.html#a71d8d6db0e41ed2022d0a95b9a70528c">RTN_OK</a>;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;}</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">/*===============================================================================================================================</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment"> Estimates actual (supply-limited) erosion of unconsolidated beach sediment on a single cell, returns the depth-equivalents of fine, sand and coarse sediment which could be removed</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">===============================================================================================================================*/</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="keywordtype">void</span> CSimulation::EstimateActualBeachErosionOnCell(<span class="keywordtype">int</span> <span class="keyword">const</span> nX, <span class="keywordtype">int</span> <span class="keyword">const</span> nY, <span class="keywordtype">int</span> <span class="keyword">const</span> nThisLayer, <span class="keywordtype">double</span> <span class="keyword">const</span> dPotentialErosionOnPolygon, <span class="keywordtype">double</span>&amp; dFine, <span class="keywordtype">double</span>&amp; dSand, <span class="keywordtype">double</span>&amp; dCoarse)</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;{</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;   <span class="comment">// Find out how much unconsolidated sediment we have available on this cell</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;   <span class="keywordtype">double</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      dExistingAvailableFine = m_pRasterGrid-&gt;m_Cell[nX][nY].<a class="code" href="class_c_geom_cell.html#a65dc08df7cf712555b94d91157431965">pGetLayerAboveBasement</a>(nThisLayer)-&gt;<a class="code" href="class_c_r_w_cell_layer.html#a6ee086df697edf497ddb97fe2f4adf53">pGetUnconsolidatedSediment</a>()-&gt;<a class="code" href="class_c_r_w_cell_sediment.html#a7b908b50af702464be628e8b96c54542">dGetFine</a>(),</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      dExistingAvailableSand = m_pRasterGrid-&gt;m_Cell[nX][nY].<a class="code" href="class_c_geom_cell.html#a65dc08df7cf712555b94d91157431965">pGetLayerAboveBasement</a>(nThisLayer)-&gt;<a class="code" href="class_c_r_w_cell_layer.html#a6ee086df697edf497ddb97fe2f4adf53">pGetUnconsolidatedSediment</a>()-&gt;<a class="code" href="class_c_r_w_cell_sediment.html#a55ec8f411beef4c724da8da17f9532b1">dGetSand</a>(),</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      dExistingAvailableCoarse = m_pRasterGrid-&gt;m_Cell[nX][nY].<a class="code" href="class_c_geom_cell.html#a65dc08df7cf712555b94d91157431965">pGetLayerAboveBasement</a>(nThisLayer)-&gt;<a class="code" href="class_c_r_w_cell_layer.html#a6ee086df697edf497ddb97fe2f4adf53">pGetUnconsolidatedSediment</a>()-&gt;<a class="code" href="class_c_r_w_cell_sediment.html#a7f2edac8db7d8e47ec400f4b06efd1a5">dGetCoarse</a>();</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;   <span class="comment">// Is there any unconsolidated sediment on this cell?</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   <span class="keywordflow">if</span> ((dExistingAvailableFine + dExistingAvailableSand + dExistingAvailableCoarse) &lt; <a class="code" href="cme_8h.html#ab63e5883f26dfad0f0c3b7cccce87c71">SEDIMENT_ELEV_TOLERANCE</a>)</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   <span class="comment">// We have some unconsolidated sediment, so partition the total lowering for this cell between the three size fractions: do this by relative erodibility</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;   <span class="keywordtype">int</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      nFineWeight = (dExistingAvailableFine &gt; 0 ? 1 : 0),</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      nSandWeight = (dExistingAvailableSand &gt; 0 ? 1 : 0),</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      nCoarseWeight = (dExistingAvailableCoarse &gt; 0 ? 1 : 0);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;   <span class="keywordtype">double</span> dTotErodibility = (nFineWeight * m_dFineErodibilityNormalized) + (nSandWeight * m_dSandErodibilityNormalized) + (nCoarseWeight * m_dCoarseErodibilityNormalized);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   <span class="keywordflow">if</span> (nFineWeight)</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;   {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="comment">// Pretend to erode some fine-sized consolidated sediment</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="keywordtype">double</span> dFineLowering = (m_dFineErodibilityNormalized * dPotentialErosionOnPolygon) / dTotErodibility;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <span class="comment">// Make sure we don&#39;t get -ve amounts left on the cell</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      dFine = <a class="code" href="cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a>(dExistingAvailableFine, dFineLowering);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   }</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;   <span class="keywordflow">if</span> (nSandWeight)</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;   {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <span class="comment">// Pretend to erode some sand-sized consolidated sediment</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="keywordtype">double</span> dSandLowering = (m_dSandErodibilityNormalized * dPotentialErosionOnPolygon) / dTotErodibility;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      <span class="comment">// Make sure we don&#39;t get -ve amounts left on the source cell</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      dSand = <a class="code" href="cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a>(dExistingAvailableSand, dSandLowering);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;   }</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;   <span class="keywordflow">if</span> (nCoarseWeight)</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;   {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <span class="comment">// Erode some coarse-sized consolidated sediment</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="keywordtype">double</span> dCoarseLowering = (m_dCoarseErodibilityNormalized * dPotentialErosionOnPolygon) / dTotErodibility;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <span class="comment">// Make sure we don&#39;t get -ve amounts left on the source cell</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      dCoarse = <a class="code" href="cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a>(dExistingAvailableCoarse, dCoarseLowering);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;   }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">//    LogStream &lt;&lt; &quot;\tEstimating actual erosion on [&quot; &lt;&lt; nX &lt;&lt; &quot;][&quot; &lt;&lt; nY &lt;&lt; &quot;] dPotentialErosionOnPolygon = &quot; &lt;&lt; dPotentialErosionOnPolygon &lt;&lt; &quot; dTotActualErosion = &quot; &lt;&lt; dTotActualErosion &lt;&lt; &quot; dFine = &quot; &lt;&lt; dFine &lt;&lt; &quot; dSand = &quot; &lt;&lt; dSand &lt;&lt; &quot; dCoarse = &quot; &lt;&lt; dCoarse &lt;&lt; endl;</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;}</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclass_c_geom2_d_i_point_html"><div class="ttname"><a href="class_c_geom2_d_i_point.html">CGeom2DIPoint</a></div><div class="ttdoc">Geometry class used to represent 2D point objects with integer co-ordinates.</div><div class="ttdef"><b>Definition:</b> <a href="2di__point_8h_source.html#l00029">2di_point.h:29</a></div></div>
<div class="ttc" id="aclass_c_geom_profile_html_a10971c49bfeae2df1e16899743662fe4"><div class="ttname"><a href="class_c_geom_profile.html#a10971c49bfeae2df1e16899743662fe4">CGeomProfile::nGetCellGivenDepth</a></div><div class="ttdeci">int nGetCellGivenDepth(CGeomRasterGrid const *, double const)</div><div class="ttdoc">Returns the index of the cell on this profile which has a sea depth which is just less than a given d...</div><div class="ttdef"><b>Definition:</b> <a href="profile_8cpp_source.html#l00424">profile.cpp:424</a></div></div>
<div class="ttc" id="aclass_c_geom2_d_point_html"><div class="ttname"><a href="class_c_geom2_d_point.html">CGeom2DPoint</a></div><div class="ttdoc">Geometry class used to represent 2D point objects with floating-point co-ordinates.</div><div class="ttdef"><b>Definition:</b> <a href="2d__point_8h_source.html#l00029">2d_point.h:29</a></div></div>
<div class="ttc" id="acme_8h_html_a068017859403c0629d89f8d348f6c224"><div class="ttname"><a href="cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a></div><div class="ttdeci">T tMin(T a, T b)</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00783">cme.h:783</a></div></div>
<div class="ttc" id="aclass_c_geom2_d_i_point_html_a84c27fdfdfca1e5222a141717ab8f6e4"><div class="ttname"><a href="class_c_geom2_d_i_point.html#a84c27fdfdfca1e5222a141717ab8f6e4">CGeom2DIPoint::SetX</a></div><div class="ttdeci">void SetX(int const)</div><div class="ttdoc">The integer parameter sets a value for the CGeom2DIPoint object's X co-ordinate.</div><div class="ttdef"><b>Definition:</b> <a href="2di__point_8cpp_source.html#l00068">2di_point.cpp:68</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_ae2119674d8d0b78f27bc53ed463fead2"><div class="ttname"><a href="class_c_geom_coast_polygon.html#ae2119674d8d0b78f27bc53ed463fead2">CGeomCoastPolygon::nGetDownCoastProfile</a></div><div class="ttdeci">int nGetDownCoastProfile(void) const</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00137">coast_polygon.cpp:137</a></div></div>
<div class="ttc" id="aclass_c_geom_profile_html_a8a29c3fa364ab1f7b3930b7a9c83f45f"><div class="ttname"><a href="class_c_geom_profile.html#a8a29c3fa364ab1f7b3930b7a9c83f45f">CGeomProfile::nGetNumCellsInProfile</a></div><div class="ttdeci">int nGetNumCellsInProfile(void) const</div><div class="ttdef"><b>Definition:</b> <a href="profile_8cpp_source.html#l00396">profile.cpp:396</a></div></div>
<div class="ttc" id="acme_8h_html_ad4c91de5db6eb59e27fe49d05080ca6b"><div class="ttname"><a href="cme_8h.html#ad4c91de5db6eb59e27fe49d05080ca6b">LF_CAT_INTERVENTION</a></div><div class="ttdeci">const int LF_CAT_INTERVENTION</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00230">cme.h:230</a></div></div>
<div class="ttc" id="acme_8h_html_aee2e0742555937187504ee86b95bc29c"><div class="ttname"><a href="cme_8h.html#aee2e0742555937187504ee86b95bc29c">INT_NODATA</a></div><div class="ttdeci">const int INT_NODATA</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00185">cme.h:185</a></div></div>
<div class="ttc" id="acme_8h_html_a89311a98397f9d6967d2cb10d5152d77"><div class="ttname"><a href="cme_8h.html#a89311a98397f9d6967d2cb10d5152d77">TOLERANCE</a></div><div class="ttdeci">const double TOLERANCE</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00462">cme.h:462</a></div></div>
<div class="ttc" id="aclass_c_geom_profile_html"><div class="ttname"><a href="class_c_geom_profile.html">CGeomProfile</a></div><div class="ttdoc">Geometry class used to represent coast profile objects.</div><div class="ttdef"><b>Definition:</b> <a href="profile_8h_source.html#l00037">profile.h:37</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_aa717d51fde4419cad26236395d047b71"><div class="ttname"><a href="class_c_geom_coast_polygon.html#aa717d51fde4419cad26236395d047b71">CGeomCoastPolygon::nGetUpCoastProfile</a></div><div class="ttdeci">int nGetUpCoastProfile(void) const</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00132">coast_polygon.cpp:132</a></div></div>
<div class="ttc" id="acme_8h_html"><div class="ttname"><a href="cme_8h.html">cme.h</a></div><div class="ttdoc">This file contains global definitions for CoastalME.</div></div>
<div class="ttc" id="aclass_c_geom2_d_i_point_html_a4350a3410e098a2cb27fbeaa6b12b5e5"><div class="ttname"><a href="class_c_geom2_d_i_point.html#a4350a3410e098a2cb27fbeaa6b12b5e5">CGeom2DIPoint::SetY</a></div><div class="ttdeci">void SetY(int const)</div><div class="ttdoc">The integer parameter sets a value for the CGeom2DIPoint object's Y co-ordinate.</div><div class="ttdef"><b>Definition:</b> <a href="2di__point_8cpp_source.html#l00074">2di_point.cpp:74</a></div></div>
<div class="ttc" id="acme_8h_html_acb051023b7bfd97c6178b7e4223bb88a"><div class="ttname"><a href="cme_8h.html#acb051023b7bfd97c6178b7e4223bb88a">RTN_ERR_NO_SEAWARD_END_OF_PROFILE_1</a></div><div class="ttdeci">const int RTN_ERR_NO_SEAWARD_END_OF_PROFILE_1</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00393">cme.h:393</a></div></div>
<div class="ttc" id="aclass_c_geom_profile_html_a0aead517e2105d6c1a14c27126b1fe92"><div class="ttname"><a href="class_c_geom_profile.html#a0aead517e2105d6c1a14c27126b1fe92">CGeomProfile::nGetNumCoastPoint</a></div><div class="ttdeci">int nGetNumCoastPoint(void) const</div><div class="ttdef"><b>Definition:</b> <a href="profile_8cpp_source.html#l00057">profile.cpp:57</a></div></div>
<div class="ttc" id="aclass_c_geom_profile_html_a6d13079f744085f2d132405e0120ca54"><div class="ttname"><a href="class_c_geom_profile.html#a6d13079f744085f2d132405e0120ca54">CGeomProfile::pPtiGetCellInProfile</a></div><div class="ttdeci">CGeom2DIPoint * pPtiGetCellInProfile(int const)</div><div class="ttdef"><b>Definition:</b> <a href="profile_8cpp_source.html#l00390">profile.cpp:390</a></div></div>
<div class="ttc" id="aclass_c_geom2_d_i_point_html_af84c687b2d0be01ab41cbcc0565f4f3f"><div class="ttname"><a href="class_c_geom2_d_i_point.html#af84c687b2d0be01ab41cbcc0565f4f3f">CGeom2DIPoint::nGetX</a></div><div class="ttdeci">int nGetX(void) const</div><div class="ttdoc">Returns the CGeom2DIPoint object's integer X co-ordinate.</div><div class="ttdef"><b>Definition:</b> <a href="2di__point_8cpp_source.html#l00044">2di_point.cpp:44</a></div></div>
<div class="ttc" id="acoast_8h_html"><div class="ttname"><a href="coast_8h.html">coast.h</a></div><div class="ttdoc">Contains CRWCoast definitions.</div></div>
<div class="ttc" id="aclass_c_r_w_cell_layer_html_a6ee086df697edf497ddb97fe2f4adf53"><div class="ttname"><a href="class_c_r_w_cell_layer.html#a6ee086df697edf497ddb97fe2f4adf53">CRWCellLayer::pGetUnconsolidatedSediment</a></div><div class="ttdeci">CRWCellSediment * pGetUnconsolidatedSediment(void)</div><div class="ttdef"><b>Definition:</b> <a href="cell__layer_8cpp_source.html#l00036">cell_layer.cpp:36</a></div></div>
<div class="ttc" id="acme_8h_html_a1c2e8afbb6c48aa6e2ee71105410df4f"><div class="ttname"><a href="cme_8h.html#a1c2e8afbb6c48aa6e2ee71105410df4f">MIN_PAR_PROFILE_SIZE</a></div><div class="ttdeci">const int MIN_PAR_PROFILE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00176">cme.h:176</a></div></div>
<div class="ttc" id="aclass_c_simulation_html_a222962121613613a48f518e0c2110f21"><div class="ttname"><a href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">CSimulation::LogStream</a></div><div class="ttdeci">ofstream LogStream</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00781">simulation.h:781</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html"><div class="ttname"><a href="class_c_geom_coast_polygon.html">CGeomCoastPolygon</a></div><div class="ttdoc">Geometry class used for coast polygon objects.</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8h_source.html#l00031">coast_polygon.h:31</a></div></div>
<div class="ttc" id="acme_8h_html_ac8de8e3c8f526683cf8a372e00bdcde3"><div class="ttname"><a href="cme_8h.html#ac8de8e3c8f526683cf8a372e00bdcde3">RTN_ERR_NO_TOP_LAYER</a></div><div class="ttdeci">const int RTN_ERR_NO_TOP_LAYER</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00398">cme.h:398</a></div></div>
<div class="ttc" id="aclass_c_geom_cell_html_a78b09fa78835ecf75b4206f77021ce08"><div class="ttname"><a href="class_c_geom_cell.html#a78b09fa78835ecf75b4206f77021ce08">CGeomCell::SetActualBeachErosionEstimated</a></div><div class="ttdeci">void SetActualBeachErosionEstimated(void)</div><div class="ttdef"><b>Definition:</b> <a href="cell_8cpp_source.html#l00108">cell.cpp:108</a></div></div>
<div class="ttc" id="aclass_c_r_w_cell_sediment_html_a7f2edac8db7d8e47ec400f4b06efd1a5"><div class="ttname"><a href="class_c_r_w_cell_sediment.html#a7f2edac8db7d8e47ec400f4b06efd1a5">CRWCellSediment::dGetCoarse</a></div><div class="ttdeci">double dGetCoarse(void) const</div><div class="ttdef"><b>Definition:</b> <a href="cell__sediment_8cpp_source.html#l00102">cell_sediment.cpp:102</a></div></div>
<div class="ttc" id="aclass_c_r_w_cell_sediment_html_a55ec8f411beef4c724da8da17f9532b1"><div class="ttname"><a href="class_c_r_w_cell_sediment.html#a55ec8f411beef4c724da8da17f9532b1">CRWCellSediment::dGetSand</a></div><div class="ttdeci">double dGetSand(void) const</div><div class="ttdef"><b>Definition:</b> <a href="cell__sediment_8cpp_source.html#l00089">cell_sediment.cpp:89</a></div></div>
<div class="ttc" id="acme_8h_html_a71d8d6db0e41ed2022d0a95b9a70528c"><div class="ttname"><a href="cme_8h.html#a71d8d6db0e41ed2022d0a95b9a70528c">RTN_OK</a></div><div class="ttdeci">const int RTN_OK</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00351">cme.h:351</a></div></div>
<div class="ttc" id="acme_8h_html_ab0094f1ece3facf8eb8afd210a7a7835"><div class="ttname"><a href="cme_8h.html#ab0094f1ece3facf8eb8afd210a7a7835">ERR</a></div><div class="ttdeci">const string ERR</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00537">cme.h:537</a></div></div>
<div class="ttc" id="aclass_c_geom_cell_html_a65dc08df7cf712555b94d91157431965"><div class="ttname"><a href="class_c_geom_cell.html#a65dc08df7cf712555b94d91157431965">CGeomCell::pGetLayerAboveBasement</a></div><div class="ttdeci">CRWCellLayer * pGetLayerAboveBasement(int const)</div><div class="ttdoc">Return a reference to the Nth sediment layer (layer 0 being just above basement)</div><div class="ttdef"><b>Definition:</b> <a href="cell_8cpp_source.html#l00369">cell.cpp:369</a></div></div>
<div class="ttc" id="aclass_c_geom_cell_html_af1321d6f96845f7933e6d7167267ed41"><div class="ttname"><a href="class_c_geom_cell.html#af1321d6f96845f7933e6d7167267ed41">CGeomCell::pGetLandform</a></div><div class="ttdeci">CRWCellLandform * pGetLandform(void)</div><div class="ttdoc">Returns a pointer to this cell's CRWCellLandform object.</div><div class="ttdef"><b>Definition:</b> <a href="cell_8cpp_source.html#l00254">cell.cpp:254</a></div></div>
<div class="ttc" id="aclass_c_r_w_cell_sediment_html_a7b908b50af702464be628e8b96c54542"><div class="ttname"><a href="class_c_r_w_cell_sediment.html#a7b908b50af702464be628e8b96c54542">CRWCellSediment::dGetFine</a></div><div class="ttdeci">double dGetFine(void) const</div><div class="ttdef"><b>Definition:</b> <a href="cell__sediment_8cpp_source.html#l00075">cell_sediment.cpp:75</a></div></div>
<div class="ttc" id="aclass_c_geom_cell_html_ae655afb832998a438f07595a78c8766a"><div class="ttname"><a href="class_c_geom_cell.html#ae655afb832998a438f07595a78c8766a">CGeomCell::bGetActualBeachErosionEstimated</a></div><div class="ttdeci">bool bGetActualBeachErosionEstimated(void) const</div><div class="ttdef"><b>Definition:</b> <a href="cell_8cpp_source.html#l00113">cell.cpp:113</a></div></div>
<div class="ttc" id="aclass_c_geom_cell_html_a43434d6fd45da697ae17f7b274ba9a83"><div class="ttname"><a href="class_c_geom_cell.html#a43434d6fd45da697ae17f7b274ba9a83">CGeomCell::nGetTopNonZeroLayerAboveBasement</a></div><div class="ttdeci">int nGetTopNonZeroLayerAboveBasement(void) const</div><div class="ttdoc">Returns the index of the topmost sediment layer (layer 0 being the one just above basement) with non-...</div><div class="ttdef"><b>Definition:</b> <a href="cell_8cpp_source.html#l00326">cell.cpp:326</a></div></div>
<div class="ttc" id="acme_8h_html_aefd6cc6a56f74f477743b3990c472ed4"><div class="ttname"><a href="cme_8h.html#aefd6cc6a56f74f477743b3990c472ed4">MIN_INLAND_OFFSET_FOR_BEACH_EROSION_ESTIMATION</a></div><div class="ttdeci">const int MIN_INLAND_OFFSET_FOR_BEACH_EROSION_ESTIMATION</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00178">cme.h:178</a></div></div>
<div class="ttc" id="acme_8h_html_ab63e5883f26dfad0f0c3b7cccce87c71"><div class="ttname"><a href="cme_8h.html#ab63e5883f26dfad0f0c3b7cccce87c71">SEDIMENT_ELEV_TOLERANCE</a></div><div class="ttdeci">const double SEDIMENT_ELEV_TOLERANCE</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00463">cme.h:463</a></div></div>
<div class="ttc" id="aclass_c_r_w_cell_landform_html_a5350a7ac48d1eef3a78bef9bcf041b45"><div class="ttname"><a href="class_c_r_w_cell_landform.html#a5350a7ac48d1eef3a78bef9bcf041b45">CRWCellLandform::nGetLFCategory</a></div><div class="ttdeci">int nGetLFCategory(void) const</div><div class="ttdoc">Get the landform category.</div><div class="ttdef"><b>Definition:</b> <a href="cell__landform_8cpp_source.html#l00050">cell_landform.cpp:50</a></div></div>
<div class="ttc" id="asimulation_8h_html"><div class="ttname"><a href="simulation_8h.html">simulation.h</a></div><div class="ttdoc">Contains CSimulation definitions.</div></div>
<div class="ttc" id="acme_8h_html_abf75660f1852737d3c9eedbb52e8def2"><div class="ttname"><a href="cme_8h.html#abf75660f1852737d3c9eedbb52e8def2">DEAN_POWER</a></div><div class="ttdeci">const double DEAN_POWER</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00456">cme.h:456</a></div></div>
<div class="ttc" id="aclass_c_geom_cell_html_a6387aaac391af63a9f2be1c809ce169c"><div class="ttname"><a href="class_c_geom_cell.html#a6387aaac391af63a9f2be1c809ce169c">CGeomCell::dGetSedimentTopElev</a></div><div class="ttdeci">double dGetSedimentTopElev(void) const</div><div class="ttdoc">Returns the true elevation of the sediment's top surface for this cell (if there is a cliff notch,...</div><div class="ttdef"><b>Definition:</b> <a href="cell_8cpp_source.html#l00389">cell.cpp:389</a></div></div>
<div class="ttc" id="acme_8h_html_a7abec008cf84fe3fe52ac3158ff7df7d"><div class="ttname"><a href="cme_8h.html#a7abec008cf84fe3fe52ac3158ff7df7d">LF_CAT_DRIFT</a></div><div class="ttdeci">const int LF_CAT_DRIFT</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00229">cme.h:229</a></div></div>
<div class="ttc" id="aclass_c_geom2_d_i_point_html_a4d9c20bcca90dcb9d519b664aba09cbd"><div class="ttname"><a href="class_c_geom2_d_i_point.html#a4d9c20bcca90dcb9d519b664aba09cbd">CGeom2DIPoint::nGetY</a></div><div class="ttdeci">int nGetY(void) const</div><div class="ttdoc">Returns the CGeom2DIPoint object's integer Y co-ordinate.</div><div class="ttdef"><b>Definition:</b> <a href="2di__point_8cpp_source.html#l00050">2di_point.cpp:50</a></div></div>
<div class="ttc" id="aclass_c_geom_cell_html_a28b760b0a9e63afd01e29610888fc7bc"><div class="ttname"><a href="class_c_geom_cell.html#a28b760b0a9e63afd01e29610888fc7bc">CGeomCell::bIsInContiguousSea</a></div><div class="ttdeci">bool bIsInContiguousSea(void) const</div><div class="ttdef"><b>Definition:</b> <a href="cell_8cpp_source.html#l00102">cell.cpp:102</a></div></div>
<div class="ttc" id="acme_8h_html_a6da5abe13cf250e9663012ef6633d92a"><div class="ttname"><a href="cme_8h.html#a6da5abe13cf250e9663012ef6633d92a">NO_NONZERO_THICKNESS_LAYERS</a></div><div class="ttdeci">const int NO_NONZERO_THICKNESS_LAYERS</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00421">cme.h:421</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Dec 9 2020 19:46:12 for CoastalME (Coastal Modelling Environment) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
