<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CoastalME (Coastal Modelling Environment): simulation.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CoastalME (Coastal Modelling Environment)
   </div>
   <div id="projectbrief">Simulates the long-term behaviour of complex coastlines</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">simulation.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="simulation_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">/*==============================================================================================================================</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> This file is part of CoastalME, the Coastal Modelling Environment.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> CoastalME is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">==============================================================================================================================*/</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">using</span> std::cout;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">using</span> std::cerr;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">using</span> std::endl;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">using</span> std::ios;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;cfloat&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cme_8h.html">cme.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="simulation_8h.html">simulation.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raster__grid_8h.html">raster_grid.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="coast_8h.html">coast.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">/*==============================================================================================================================</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> The CSimulation constructor</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">==============================================================================================================================*/</span></div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="class_c_simulation.html#a5f5c62e03730a145a32347457d641cad">   46</a></span>&#160;<a class="code" href="class_c_simulation.html#a5f5c62e03730a145a32347457d641cad">CSimulation::CSimulation</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   <span class="comment">// Initialization</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   m_bHaveFineSediment                             =</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   m_bHaveSandSediment                             =</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   m_bHaveCoarseSediment                           =</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   m_bRasterGISSaveAll                             =</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   m_bVectorGISSaveAll                             =</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   m_bBasementElevSave                             =</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   m_bSedimentTopSurfSave                          =</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   m_bTopSurfSave                                  =</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   m_bSliceSave                                    =</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   m_bSeaDepthSave                                 =</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   m_bAvgSeaDepthSave                              =</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   m_bWaveHeightSave                               =</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   m_bAvgWaveHeightSave                            =</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   m_bWaveAngleSave                                =</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   m_bAvgWaveAngleSave                             =</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   m_bWaveAngleAndHeightSave                       =</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   m_bAvgWaveAngleAndHeightSave                    =</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   m_bDeepWaterWaveAngleAndHeightSave              =</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   m_bBeachProtectionSave                          =</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   m_bWaveEnergySinceCollapseSave                  =</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   m_bMeanWaveEnergySave                           =</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   m_bBreakingWaveHeightSave                       =</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   m_bPotentialPlatformErosionSave                 =</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   m_bActualPlatformErosionSave                    =</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   m_bTotalPotentialPlatformErosionSave            =</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   m_bTotalActualPlatformErosionSave               =</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   m_bPotentialBeachErosionSave                    =</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   m_bActualBeachErosionSave                       =</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   m_bTotalPotentialBeachErosionSave               =</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   m_bTotalActualBeachErosionSave                  =</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   m_bBeachDepositionSave                          =</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   m_bTotalBeachDepositionSave                     =</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   m_bLandformSave                                 =</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   m_bLocalSlopeSave                               =</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   m_bInterventionClassSave                        =</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   m_bInterventionHeightSave                       =</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   m_bSuspSedSave                                  =</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   m_bAvgSuspSedSave                               =</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   m_bFineUnconsSedSave                            =</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   m_bSandUnconsSedSave                            =</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   m_bCoarseUnconsSedSave                          =</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   m_bFineConsSedSave                              =</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   m_bSandConsSedSave                              =</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   m_bCoarseConsSedSave                            =</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   m_bRasterCoastlineSave                          =</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   m_bRasterNormalSave                             =</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   m_bDistWeightSave                               =</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   m_bActiveZoneSave                               =</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   m_bCliffCollapseSave                            =</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   m_bTotCliffCollapseSave                         =</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   m_bCliffCollapseDepositionSave                  =</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   m_bTotCliffCollapseDepositionSave               =</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   m_bRasterPolygonSave                            =</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   m_bPotentialPlatformErosionMaskSave             =</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   m_bSeaMaskSave                                  =</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   m_bBeachMaskSave                                =</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   m_bShadowZoneCodesSave                          =</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   m_bSaveRegular                                  =</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   m_bCoastSave                                    =</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   m_bNormalsSave                                  =</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   m_bInvalidNormalsSave                           =</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   m_bCoastCurvatureSave                           =</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   m_bPolygonNodeSave                              =</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   m_bPolygonBoundarySave                          =</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   m_bCliffNotchSave                               =</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   m_bShadowBoundarySave                           =</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   m_bShadowDowndriftBoundarySave                  =</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   m_bDeepWaterWaveAngleSave                       =</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   m_bDeepWaterWaveHeightSave                      =</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   m_bDeepWaterWavePeriodSave                      =</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   m_bPolygonUnconsSedUpOrDownDrift                =</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   m_bPolygonUnconssedGainOrLoss                   =</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   m_bSeaAreaTSSave                                =</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   m_bStillWaterLevelTSSave                        =</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   m_bActualPlatformErosionTSSave                  =</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   m_bSuspSedTSSave                                =</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   m_bCliffCollapseDepositionTSSave                =</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   m_bCliffCollapseErosionTSSave                   =</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   m_bCliffCollapseNetTSSave                       =</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   m_bBeachErosionTSSave                           =</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   m_bBeachDepositionTSSave                        =</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;   m_bBeachSedimentChangeNetTSSave                 =</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   m_bSaveGISThisIter                              =</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   m_bOutputProfileData                            =</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   m_bOutputParallelProfileData                    =</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   m_bOutputLookUpData                             =</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   m_bOmitSearchNorthEdge                          =</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   m_bOmitSearchSouthEdge                          =</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   m_bOmitSearchWestEdge                           =</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   m_bOmitSearchEastEdge                           =</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   m_bErodeShorePlatformAlternateDirection         =</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   m_bDoCoastPlatformErosion                       =</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   m_bDoCliffCollapse                              =</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   m_bDoBeachSedimentTransport                     =</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   m_bGDALCanWriteFloat                            =</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   m_bGDALCanWriteInt32                            =</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   m_bScaleRasterOutput                            =</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   m_bWorldFile                                    =</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   m_bSingleDeepWaterWaveValues                    =</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   m_bHaveWaveStationData                          =</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   m_bSedimentInput                                =</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   m_bSedimentInputAtPoint                         =</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   m_bSedimentInputAtCoast                         =</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   m_bSedimentInputAlongLine                       =</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   m_bSedimentInputThisIter                        = </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   m_bSedimentInputEventSave                       = </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   m_bWaveSetupSave                                = </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   m_bStormSurgeSave                               = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   m_bGDALCanCreate                                = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   m_papszGDALRasterOptions                        =</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   m_papszGDALVectorOptions                        = NULL;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   m_nLayers                                       =</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   m_nCoastSmooth                                  =</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   m_nCoastSmoothWindow                            =</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   m_nSavGolCoastPoly                              =</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   m_nProfileSmoothWindow                          =</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   m_nCoastNormalAvgSpacing                        =</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   m_nCoastCurvatureInterval                       =</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   m_nNaturalCapeNormals                           =</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   m_nGISSave                                      =</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   m_nUSave                                        =</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   m_nThisSave                                     =</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   m_nXGridMax                                     =</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   m_nYGridMax                                     =</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   m_nCoastMax                                     =</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   m_nCoastMin                                     =</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   m_nNThisIterCliffCollapse                       =</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   m_nNTotCliffCollapse                            =</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   m_nCliffCollapseTalusPlanviewWidth              =</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   m_nGlobalPolygonID                              =</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   m_nUnconsSedimentHandlingAtGridEdges            =</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   m_nBeachErosionDepositionEquation               =</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   m_nWavePropagationModel                         =</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   m_nSimStartSec                                  =</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   m_nSimStartMin                                  =</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   m_nSimStartHour                                 =</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   m_nSimStartDay                                  =</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   m_nSimStartMonth                                =</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;   m_nSimStartYear                                 =</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   m_nDeepWaterWaveDataNTimeSteps                  =</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   m_nLogFileDetail                                = 0;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   <span class="comment">// NOTE May wish to make this a user-supplied value</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   m_nMissingValue                                 = <a class="code" href="cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   m_nXMinBoundingBox                              = INT_MAX;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   m_nXMaxBoundingBox                              = INT_MIN;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   m_nYMinBoundingBox                              = INT_MAX;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   m_nYMaxBoundingBox                              = INT_MIN;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   m_GDALWriteIntDataType                          =</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   m_GDALWriteFloatDataType                        = GDT_Unknown;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   m_lGDALMaxCanWrite                              =</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;   m_lGDALMinCanWrite                              = 0;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   m_ulIter                                        =</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   m_ulTotTimestep                                 =</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   m_ulNumCells                                    =</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   m_ulThisIterNumSeaCells                         =</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;   m_ulThisIterNumCoastCells                       =</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   m_ulThisIterNumPotentialPlatformErosionCells    =</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   m_ulThisIterNumActualPlatformErosionCells       =</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   m_ulThisIterNumPotentialBeachErosionCells       =</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   m_ulThisIterNumActualBeachErosionCells          =</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   m_ulThisIterNumBeachDepositionCells             =</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   m_ulTotPotentialPlatformErosionOnProfiles       =</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   m_ulTotPotentialPlatformErosionBetweenProfiles  =</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   m_ulMissingValueBasementCells                   = 0;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="simulation_8h.html#a9a16fa3bd2cdef6c1b57032795dcf9ef">NRNG</a>; i++)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      m_ulRandSeed[i]  = 0;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="simulation_8h.html#a85c01ae87ffab98fdd1ec6fd3d0eff7b">SAVEMAX</a>; i++)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      m_dUSaveTime[i] = 0;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   m_dDurationUnitsMult                            =</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   m_dNorthWestXExtCRS                             =</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   m_dNorthWestYExtCRS                             =</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   m_dSouthEastXExtCRS                             =</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   m_dSouthEastYExtCRS                             =</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   m_dExtCRSGridArea                               =</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   m_dCellSide                                     =</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   m_dCellDiagonal                                 =</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;   m_dInvCellSide                                  =</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   m_dInvCellDiagonal                              =</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   m_dCellArea                                     =</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   m_dSimDuration                                  =</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   m_dTimeStep                                     =</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   m_dSimElapsed                                   =</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   m_dRSaveTime                                    =</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   m_dRSaveInterval                                =</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   m_dClkLast                                      =</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   m_dCPUClock                                     =</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   m_dSeaWaterDensity                              =</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   m_dThisIterSWL                                  =</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;   m_dOrigSWL                                      =</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   m_dFinalSWL                                     =</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   m_dDeltaSWLPerTimestep                          =</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   m_dBreakingWaveHeight                           =</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;   m_dC_0                                          =</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   m_dL_0                                          =</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   m_dWaveDepthRatioForWaveCalcs                   =</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   m_dAllCellsDeepWaterWaveHeight                  =</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   m_dAllCellsDeepWaterWaveAngle                   =</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;   m_dAllCellsDeepWaterWavePeriod                  =</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;   m_dMaxUserInputWaveHeight                       =</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;   m_dMaxUserInputWavePeriod                       =</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   m_dR                                            =</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   m_dD50Fine                                      =</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   m_dD50Sand                                      =</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   m_dD50Coarse                                    =</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;   m_dBeachSedimentDensity                         =</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   m_dBeachSedimentPorosity                        =</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   m_dFineErodibility                              =</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   m_dSandErodibility                              =</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   m_dCoarseErodibility                            =</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   m_dFineErodibilityNormalized                    =</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   m_dSandErodibilityNormalized                    =</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   m_dCoarseErodibilityNormalized                  =</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   m_dKLS                                          =</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   m_dKamphuis                                     =</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   m_dG                                            =</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   m_dInmersedToBulkVolumetric                     =</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   m_dDepthOfClosure                               =</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   m_dCoastNormalAvgSpacing                        =</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   m_dCoastNormalLength                            =</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;   m_dThisIterTotSeaDepth                          =</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   m_dThisIterPotentialSedLostBeachErosion         =</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;   m_dThisIterActualFineSedLostBeachErosion        =</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   m_dThisIterActualSandSedLostBeachErosion        =</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   m_dThisIterActualCoarseSedLostBeachErosion      =</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   m_dThisIterSandSedLostCliffCollapse             =</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   m_dThisIterCoarseSedLostCliffCollapse           =</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   m_dThisIterPotentialPlatformErosion             =</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   m_dThisIterActualPlatformErosionFine            =</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   m_dThisIterActualPlatformErosionSand            =</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   m_dThisIterActualPlatformErosionCoarse          =</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   m_dThisIterPotentialBeachErosion                =</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   m_dThisIterActualBeachErosionFine               =</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   m_dThisIterActualBeachErosionSand               =</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   m_dThisIterActualBeachErosionCoarse             =</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   m_dThisIterBeachDepositionSand                  =</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   m_dThisIterBeachDepositionCoarse                =</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   m_dThisIterEstimatedActualFineBeachErosion      =</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   m_dThisIterEstimatedActualSandBeachErosion      =</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   m_dThisIterEstimatedActualCoarseBeachErosion    =</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   m_dThisIterFineSedimentToSuspension             =</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   m_dThisIterMassBalanceErosionError              =</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   m_dThisIterMassBalanceDepositionError           =</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   m_dDepthOverDBMax                               =</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   m_dTotPotentialPlatformErosionOnProfiles        =</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   m_dTotPotentialPlatformErosionBetweenProfiles   =</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   m_dProfileMaxSlope                              =</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   m_dMaxBeachElevAboveSWL                         =</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   m_dCliffErosionResistance                       =</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   m_dNotchOverhangAtCollapse                      =</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   m_dNotchBaseBelowSWL                            =</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   m_dCliffDepositionA                             =</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   m_dCliffDepositionPlanviewWidth                 =</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   m_dCliffDepositionPlanviewLength                =</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   m_dCliffDepositionHeightFrac                    =</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   m_dThisIterCliffCollapseErosionFine             =</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   m_dThisIterCliffCollapseErosionSand             =</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   m_dThisIterCliffCollapseErosionCoarse           =</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;   m_dThisIterCliffDepositionSand                  =</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   m_dThisIterCliffDepositionCoarse                =</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   m_dThisIterCliffErosionFine                     =</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   m_dThisIterCliffTalusSandErosion                =</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   m_dThisIterCliffTalusCoarseErosion              =</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   m_dCoastNormalRandSpaceFact                     =</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;   m_dDeanProfileStartAboveSWL                     =</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   m_dAccumulatedSeaLevelChange                    =</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   m_dBreakingWaveHeightDepthRatio                 =</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;   m_dWaveDataWrapHours                            =</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;   m_dThisIterTopElevMax                           =</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   m_dThisIterTopElevMin                           =</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;   m_dThisiterFineSedimentInput                    =</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   m_dThisiterSandSedimentInput                    =</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   m_dThisiterCoarseSedimentInput                  = 0;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   m_dMinSWL                                       = DBL_MAX;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   m_dMaxSWL                                       = DBL_MIN;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6; i++)</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      m_dGeoTransform[i] = 0;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   <span class="comment">// NOTE May wish to make this a user-supplied value</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   m_dMissingValue                           = <a class="code" href="cme_8h.html#ac003bdff958dca839f5d274f15786e07">DBL_NODATA</a>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   m_ldGTotPotentialPlatformErosion          =</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   m_ldGTotFineActualPlatformErosion         =</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;   m_ldGTotSandActualPlatformErosion         =</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   m_ldGTotCoarseActualPlatformErosion       =</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   m_ldGTotPotentialSedLostBeachErosion      =</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;   m_ldGTotActualFineSedLostBeachErosion     =</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   m_ldGTotActualSandSedLostBeachErosion     =</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   m_ldGTotActualCoarseSedLostBeachErosion   =</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   m_ldGTotSandSedLostCliffCollapse          =</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   m_ldGTotCoarseSedLostCliffCollapse        =</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;   m_ldGTotCliffCollapseFine                 =</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   m_ldGTotCliffCollapseSand                 =</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   m_ldGTotCliffCollapseCoarse               =</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   m_ldGTotCliffTalusSandDeposition          =</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;   m_ldGTotCliffTalusCoarseDeposition        =</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   m_ldGTotCliffTalusFineErosion             =</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;   m_ldGTotCliffTalusSandErosion             =</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;   m_ldGTotCliffTalusCoarseErosion           =</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;   m_ldGTotPotentialBeachErosion             =</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   m_ldGTotActualFineBeachErosion            =</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   m_ldGTotActualSandBeachErosion            =</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   m_ldGTotActualCoarseBeachErosion          =</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;   m_ldGTotSandBeachDeposition               =</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   m_ldGTotCoarseBeachDeposition             =</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   m_ldGTotSuspendedSediment                 =</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   m_ldGTotMassBalanceErosionError           =</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   m_ldGTotMassBalanceDepositionError        =</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   m_ldGTotFineSedimentInput                 =</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;   m_ldGTotSandSedimentInput                 =</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   m_ldGTotCoarseSedimentInput               = 0;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      m_ulRState[i].s1                       =</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      m_ulRState[i].s2                       =</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      m_ulRState[i].s3                       = 0;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   m_tSysStartTime                           =</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   m_tSysEndTime                             = 0;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   m_pRasterGrid                             = NULL;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;}</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">/*==============================================================================================================================</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment"> The CSimulation destructor</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">==============================================================================================================================*/</span></div>
<div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="class_c_simulation.html#a9657f6315931bb105f99a5ff414b6dbf">  391</a></span>&#160;<a class="code" href="class_c_simulation.html#a9657f6315931bb105f99a5ff414b6dbf">CSimulation::~CSimulation</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;{</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   <span class="comment">// Close output files if open</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &amp;&amp; <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a>.is_open())</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a>.flush();</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a>.close();</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <span class="keywordflow">if</span> (OutStream &amp;&amp; OutStream.is_open())</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      OutStream.flush();</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      OutStream.close();</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;   <span class="keywordflow">if</span> (SeaAreaTSStream &amp;&amp; SeaAreaTSStream.is_open())</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      SeaAreaTSStream.flush();</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      SeaAreaTSStream.close();</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   <span class="keywordflow">if</span> (StillWaterLevelTSStream &amp;&amp; StillWaterLevelTSStream.is_open())</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      StillWaterLevelTSStream.flush();</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      StillWaterLevelTSStream.close();</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   <span class="keywordflow">if</span> (ErosionTSStream &amp;&amp; ErosionTSStream.is_open())</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      ErosionTSStream.flush();</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      ErosionTSStream.close();</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   <span class="keywordflow">if</span> (CliffCollapseErosionTSStream &amp;&amp; CliffCollapseErosionTSStream.is_open())</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      CliffCollapseErosionTSStream.flush();</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      CliffCollapseErosionTSStream.close();</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   <span class="keywordflow">if</span> (CliffCollapseDepositionTSStream &amp;&amp; CliffCollapseDepositionTSStream.is_open())</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      CliffCollapseDepositionTSStream.flush();</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      CliffCollapseDepositionTSStream.close();</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   <span class="keywordflow">if</span> (CliffCollapseNetTSStream &amp;&amp; CliffCollapseNetTSStream.is_open())</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;   {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      CliffCollapseNetTSStream.flush();</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      CliffCollapseNetTSStream.close();</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;   }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   <span class="keywordflow">if</span> (SedLoadTSStream &amp;&amp; SedLoadTSStream.is_open())</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      SedLoadTSStream.flush();</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      SedLoadTSStream.close();</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;   }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;   <span class="keywordflow">if</span> (m_pRasterGrid)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="keyword">delete</span> m_pRasterGrid;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="class_c_simulation.html#a4e7ff288de047e51b653ee0ff747a492">  453</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_c_simulation.html#a4e7ff288de047e51b653ee0ff747a492">CSimulation::dGetMissingValue</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;   <span class="keywordflow">return</span> m_dMissingValue;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;}</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="class_c_simulation.html#acf8084fc9180ae0ec41e04d8dac7c2c0">  459</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_c_simulation.html#acf8084fc9180ae0ec41e04d8dac7c2c0">CSimulation::dGetThisIterSWL</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   <span class="keywordflow">return</span> m_dThisIterSWL;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;}</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno"><a class="line" href="class_c_simulation.html#adc13bc3c8fd4d97cb3e9d34c37ff688f">  465</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_c_simulation.html#adc13bc3c8fd4d97cb3e9d34c37ff688f">CSimulation::dGetMaxBeachElevAboveSWL</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   <span class="keywordflow">return</span> m_dMaxBeachElevAboveSWL;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;}</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">// double CSimulation::dGetCellSide(void) const</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">// {</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">//    return m_dCellSide;</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">// }</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno"><a class="line" href="class_c_simulation.html#a870fb7ffba3db6692998dcbecc37b599">  475</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_c_simulation.html#a870fb7ffba3db6692998dcbecc37b599">CSimulation::nGetGridXMax</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   <span class="keywordflow">return</span> m_nXGridMax;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;}</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno"><a class="line" href="class_c_simulation.html#a46f08f37407a47d10b107f77d86c13c9">  480</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_c_simulation.html#a46f08f37407a47d10b107f77d86c13c9">CSimulation::nGetGridYMax</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;   <span class="keywordflow">return</span> m_nYGridMax;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno"><a class="line" href="class_c_simulation.html#a6c774658534c73605f2f0a12f511b08a">  485</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_c_simulation.html#a6c774658534c73605f2f0a12f511b08a">CSimulation::dGetD50Fine</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   <span class="keywordflow">return</span> m_dD50Fine;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;}</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno"><a class="line" href="class_c_simulation.html#ac02c569e193c122cfb70735c8dfc43bd">  490</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_c_simulation.html#ac02c569e193c122cfb70735c8dfc43bd">CSimulation::dGetD50Sand</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   <span class="keywordflow">return</span> m_dD50Sand;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;}</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno"><a class="line" href="class_c_simulation.html#a5356bdb1798b3397b3f19b69c62c0ddf">  495</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_c_simulation.html#a5356bdb1798b3397b3f19b69c62c0ddf">CSimulation::dGetD50Coarse</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;   <span class="keywordflow">return</span> m_dD50Coarse;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;}</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">/*==============================================================================================================================</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment"> The nDoSimulation member function of CSimulation sets up and runs the simulation</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">==============================================================================================================================*/</span></div>
<div class="line"><a name="l00506"></a><span class="lineno"><a class="line" href="class_c_simulation.html#ac72a34bfb2593d1aa861240ac243962f">  506</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_c_simulation.html#ac72a34bfb2593d1aa861240ac243962f">CSimulation::nDoSimulation</a>(<span class="keywordtype">int</span> nArg, <span class="keywordtype">char</span>* pcArgv[])</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;{</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="preprocessor">#ifdef RANDCHECK</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;   CheckRand();</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   <span class="comment">// ================================================== initialization section ================================================</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <span class="comment">// Hello, World!</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   AnnounceStart();</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;   <span class="comment">// Start the clock ticking</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   StartClock();</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;   <span class="comment">// Find out the folder in which the CoastalME executable sits, in order to open the .ini file (they are assumed to be in the same folder)</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   <span class="keywordflow">if</span> (! bFindExeDir(pcArgv[0]))</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <span class="keywordflow">return</span> (<a class="code" href="cme_8h.html#a988c3a8ded6542349e49376b71be3e7f">RTN_ERR_CMEDIR</a>);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   <span class="comment">// Deal with command-line parameters</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   <span class="keywordtype">int</span> nRet = nHandleCommandLineParams(nArg, pcArgv);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <span class="keywordflow">return</span> (nRet);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   <span class="comment">// OK, we are off, tell the user about the licence and the start time</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;   AnnounceLicence();</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   <span class="comment">// Read the .ini file and get the name of the run-data file, and path for output etc.</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   <span class="keywordflow">if</span> (! bReadIniFile())</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <span class="keywordflow">return</span> (<a class="code" href="cme_8h.html#aa2099564e4b2dd4b6a04a68589fb91c7">RTN_ERR_INI</a>);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   <span class="comment">// We have the name of the run-data input file, so read it</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   <span class="keywordflow">if</span> (! bReadRunDataFile())</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="cme_8h.html#a7542a661b37e38a9fa9544aa963dc262">RTN_ERR_RUNDATA</a>;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   <span class="comment">// Check raster GIS output format</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;   <span class="keywordflow">if</span> (! bCheckRasterGISOutputFormat())</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="keywordflow">return</span> (<a class="code" href="cme_8h.html#a3ee6a825c91b2a64be7c1ac50a04f4c2">RTN_ERR_RASTER_GIS_OUT_FORMAT</a>);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   <span class="comment">// Check vector GIS output format</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   <span class="keywordflow">if</span> (! bCheckVectorGISOutputFormat())</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keywordflow">return</span> (<a class="code" href="cme_8h.html#a925d41f084c87d8a0546558cdc9ca74c">RTN_ERR_VECTOR_GIS_OUT_FORMAT</a>);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   <span class="comment">// Open log file</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   <span class="keywordflow">if</span> (! bOpenLogFile())</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <span class="keywordflow">return</span> (<a class="code" href="cme_8h.html#a2e14aa57bb01856bfb7186c5907a77b7">RTN_ERR_LOGFILE</a>);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   <span class="comment">// Set up the time series output files</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   <span class="keywordflow">if</span> (! bSetUpTSFiles())</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <span class="keywordflow">return</span> (<a class="code" href="cme_8h.html#a88da059dd82bd1da1a6ab9359cc9fedf">RTN_ERR_TSFILE</a>);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   <span class="comment">// Initialize the random number generators</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;   InitRand0(m_ulRandSeed[0]);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;   InitRand1(m_ulRandSeed[1]);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   <span class="comment">// If we are doing Savitzky-Golay smoothing of the vector coastline(s), calculate the filter coefficients</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   <span class="keywordflow">if</span> (m_nCoastSmooth == <a class="code" href="cme_8h.html#a96bda0776b4e4dffdf460b33330c5051">SMOOTH_SAVITZKY_GOLAY</a>)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      CalcSavitzkyGolayCoeffs();</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   <span class="comment">// Create the raster grid object</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   m_pRasterGrid = <span class="keyword">new</span> <a class="code" href="class_c_geom_raster_grid.html">CGeomRasterGrid</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;   <span class="comment">// Read in the basement layer (NOTE MUST HAVE THIS FILE), create the raster grid, then read in the basement DEM data to the array</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   AnnounceReadBasementDEM();</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;   nRet = nReadRasterBasementDEM();</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;   <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   m_ulNumCells = m_nXGridMax * m_nYGridMax;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   <span class="comment">// Mark edge cells, as defined by the basement layer</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   nRet = nMarkBoundingBoxEdgeCells();</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">//    // DEBUG CODE =================================================</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">//    for (int n = 0; n &lt; m_VEdgeCell.size(); n++)</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">//    {</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">//       LogStream &lt;&lt; &quot;[&quot; &lt;&lt; m_VEdgeCell[n].nGetX() &lt;&lt; &quot;][&quot; &lt;&lt; m_VEdgeCell[n].nGetY() &lt;&lt; &quot;] = {&quot; &lt;&lt; dGridCentroidXToExtCRSX(m_VEdgeCell[n].nGetX()) &lt;&lt; &quot;, &quot; &lt;&lt; dGridCentroidYToExtCRSY(m_VEdgeCell[n].nGetY()) &lt;&lt; &quot;} &quot; &lt;&lt; m_VEdgeCellEdge[n] &lt;&lt; endl;</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">//    // DEBUG CODE =================================================</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   <span class="comment">// If we are using the default cell spacing, then now that we know the size of the raster cells, we can set the size of profile spacing in m</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   <span class="keywordflow">if</span> (m_dCoastNormalAvgSpacing == 0)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      m_dCoastNormalAvgSpacing = <a class="code" href="cme_8h.html#ad97c233d5b34c849c78e893ea183119d">MIN_PROFILE_SPACING</a> * m_dCellSide;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <span class="comment">// The user specified a profile spacing, is this too small?</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      m_nCoastNormalAvgSpacing = <a class="code" href="utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(m_dCoastNormalAvgSpacing / m_dCellSide);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <span class="keywordflow">if</span> (m_nCoastNormalAvgSpacing &lt; <a class="code" href="cme_8h.html#ad97c233d5b34c849c78e893ea183119d">MIN_PROFILE_SPACING</a>)</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;         cerr &lt;&lt; <a class="code" href="cme_8h.html#a292fc90846543ca4814daa9f759feb05">ERR</a> &lt;&lt; <span class="stringliteral">&quot;profile spacing was specified as &quot;</span> &lt;&lt; m_dCoastNormalAvgSpacing &lt;&lt; <span class="stringliteral">&quot; m, which is &quot;</span> &lt;&lt; m_nCoastNormalAvgSpacing &lt;&lt; <span class="stringliteral">&quot; cells. Polygon creation works poorly if profile spacing is less than &quot;</span> &lt;&lt; <a class="code" href="cme_8h.html#ad97c233d5b34c849c78e893ea183119d">MIN_PROFILE_SPACING</a> &lt;&lt; <span class="stringliteral">&quot; cells, i.e. &quot;</span> &lt;&lt; <a class="code" href="cme_8h.html#ad97c233d5b34c849c78e893ea183119d">MIN_PROFILE_SPACING</a> * m_dCellSide &lt;&lt; <span class="stringliteral">&quot; m&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;         <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code" href="cme_8h.html#a292fc90846543ca4814daa9f759feb05">ERR</a> &lt;&lt; <span class="stringliteral">&quot;profile spacing was specified as &quot;</span> &lt;&lt; m_dCoastNormalAvgSpacing &lt;&lt; <span class="stringliteral">&quot; m, which is &quot;</span> &lt;&lt; m_nCoastNormalAvgSpacing &lt;&lt; <span class="stringliteral">&quot; cells. Polygon creation works poorly if profile spacing is less than &quot;</span> &lt;&lt; <a class="code" href="cme_8h.html#ad97c233d5b34c849c78e893ea183119d">MIN_PROFILE_SPACING</a> &lt;&lt; <span class="stringliteral">&quot; cells, i.e. &quot;</span> &lt;&lt; <a class="code" href="cme_8h.html#ad97c233d5b34c849c78e893ea183119d">MIN_PROFILE_SPACING</a> * m_dCellSide &lt;&lt; <span class="stringliteral">&quot; m&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="cme_8h.html#a63f6debb865be4b72e0f1911e34cadb1">RTN_ERR_PROFILESPACING</a>;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;   }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;   <span class="comment">// We have at least one filename for the first layer, so add the correct number of layers. Note the the number of layers does not change during the simulation: however layers can decrease in thickness until they have zero thickness</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;   AnnounceAddLayers();</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nX = 0; nX &lt; m_nXGridMax; nX++)</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nY = 0; nY &lt; m_nYGridMax; nY++)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;         m_pRasterGrid-&gt;m_Cell[nX][nY].<a class="code" href="class_c_geom_cell.html#a556db5cb0e1b09d8e3f799f9e66138c0">AppendLayers</a>(m_nLayers);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;   <span class="comment">// Tell the user what is happening then read in the layer files</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;   AnnounceReadRasterFiles();</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nLayer = 0; nLayer &lt; m_nLayers; nLayer++)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;   {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <span class="comment">// Read in the initial fine unconsolidated sediment depth file(s)</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      AnnounceReadInitialFineUnconsSedGIS(nLayer);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      nRet = nReadRasterGISFile(<a class="code" href="cme_8h.html#abc614ab3e34b7523e416dbd9596817c2">FINE_UNCONS_RASTER</a>, nLayer);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;         <span class="keywordflow">return</span> (nRet);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="comment">// Read in the initial sand unconsolidated sediment depth file</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      AnnounceReadInitialSandUnconsSedGIS(nLayer);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      nRet = nReadRasterGISFile(<a class="code" href="cme_8h.html#ab1ebe7d63321af5461a1f4591030db3d">SAND_UNCONS_RASTER</a>, nLayer);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;         <span class="keywordflow">return</span> (nRet);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="comment">// Read in the initial coarse unconsolidated sediment depth file</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      AnnounceReadInitialCoarseUnconsSedGIS(nLayer);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      nRet = nReadRasterGISFile(<a class="code" href="cme_8h.html#abf85b5b7fd25cfc4336178ac649975a2">COARSE_UNCONS_RASTER</a>, nLayer);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;         <span class="keywordflow">return</span> (nRet);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="comment">// Read in the initial fine consolidated sediment depth file</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      AnnounceReadInitialFineConsSedGIS(nLayer);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      nRet = nReadRasterGISFile(<a class="code" href="cme_8h.html#ad5789b44b179b77e10bcb0bbfac0405e">FINE_CONS_RASTER</a>, nLayer);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;         <span class="keywordflow">return</span> (nRet);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="comment">// Read in the initial sand consolidated sediment depth file</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      AnnounceReadInitialSandConsSedGIS(nLayer);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      nRet = nReadRasterGISFile(<a class="code" href="cme_8h.html#a2172da7520364105ea080054fe7127af">SAND_CONS_RASTER</a>, nLayer);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;         <span class="keywordflow">return</span> (nRet);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="comment">// Read in the initial coarse consolidated sediment depth file</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      AnnounceReadInitialCoarseConsSedGIS(nLayer);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      nRet = nReadRasterGISFile(<a class="code" href="cme_8h.html#ad60195967f12b9ece8ad3a437182f254">COARSE_CONS_RASTER</a>, nLayer);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;         <span class="keywordflow">return</span> (nRet);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;   }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;   <span class="comment">// Read in the initial suspended sediment depth file</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;   AnnounceReadInitialSuspSedGIS();</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;   nRet = nReadRasterGISFile(<a class="code" href="cme_8h.html#ad14e0dc7b394b6bdd9dbd3ebd0b745ab">SUSP_SED_RASTER</a>, 0);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;   <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="keywordflow">return</span> (nRet);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;   <span class="comment">// Maybe read in the landform class data, otherwise calculate this during the first timestep using identification rules</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;   <span class="keywordflow">if</span> (! m_strInitialLandformFile.empty())</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;   {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      AnnounceReadLGIS();</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      nRet = nReadRasterGISFile(<a class="code" href="cme_8h.html#ae88dce382d8e29ddf4886ffe139c0ddc">LANDFORM_RASTER</a>, 0);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;         <span class="keywordflow">return</span> (nRet);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;   <span class="comment">// Maybe read in intervention data</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;   <span class="keywordflow">if</span> (! m_strInterventionClassFile.empty())</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;   {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      AnnounceReadICGIS();</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      nRet = nReadRasterGISFile(<a class="code" href="cme_8h.html#a8d9b72aabe736946364e97529cfffc2d">INTERVENTION_CLASS_RASTER</a>, 0);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;         <span class="keywordflow">return</span> (nRet);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      AnnounceReadIHGIS();</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      nRet = nReadRasterGISFile(<a class="code" href="cme_8h.html#af0af8b555af7a1a65f37e4779d575e6f">INTERVENTION_HEIGHT_RASTER</a>, 0);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;         <span class="keywordflow">return</span> (nRet);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   <span class="comment">// Maybe read in the tide data</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">if</span> (! m_strTideDataFile.empty())</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;       AnnounceReadTideData();</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;       nRet = nReadTideDataFile();</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;       <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;          <span class="keywordflow">return</span> (nRet);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;   <span class="comment">// Read in the erosion potential shape function data</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;   AnnounceReadSCAPEShapeFunctionFile();</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;   nRet = nReadShapeFunctionFile();</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;   <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      <span class="keywordflow">return</span> (nRet);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;   <span class="comment">// Do we want to output the erosion potential look-up values, for checking purposes?</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;   <span class="keywordflow">if</span> (m_bOutputLookUpData)</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      WriteLookUpData();</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;   <span class="comment">// OK, now read in the vector files (if any)</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   <span class="keywordflow">if</span> (m_bHaveWaveStationData || m_bSedimentInput)</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      AnnounceReadVectorFiles();</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;   <span class="comment">// Maybe read in deep water wave station data</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;   <span class="keywordflow">if</span> (m_bHaveWaveStationData)</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;   {</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="comment">// We are reading deep water wave height, orientation and period from a file of vector points and file time series</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      AnnounceReadDeepWaterWaveValuesGIS();</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <span class="comment">// Read in vector points</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      nRet = nReadVectorGISFile(<a class="code" href="cme_8h.html#a74c5ed54fcf9b27b5ab23c2f039dac1a">DEEP_WATER_WAVE_STATIONS_VEC</a>);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;         <span class="keywordflow">return</span> (nRet);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="keywordtype">int</span> nWaveStations = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(m_VnDeepWaterWaveStationID.size());</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <span class="keywordflow">if</span> (nWaveStations == 1)</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;         m_bSingleDeepWaterWaveValues = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="comment">// Read in time series values, and initialize the vector which stores each timestep&#39;s deep water wave height, orientation and period</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      nRet = nReadWaveStationTimeSeriesFile(nWaveStations);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;         <span class="keywordflow">return</span> (nRet);</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   }</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;   <span class="comment">// Maybe read in sediment input event data</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;   <span class="keywordflow">if</span> (m_bSedimentInput)</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;   {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      <span class="comment">// We are reading sediment input event data</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      AnnounceReadSedimentEventInputValuesGIS();</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      <span class="comment">// Read in vector points for sediment input events</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      nRet = nReadVectorGISFile(<a class="code" href="cme_8h.html#a263644961c3d206b83d11df64d23677b">SEDIMENT_INPUT_EVENT_LOCATION_VEC</a>);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;         <span class="keywordflow">return</span> (nRet);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="comment">// Read in the time series values for sediment input events</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      nRet = nReadSedimentInputEventTimeSeriesFile();</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;         <span class="keywordflow">return</span> (nRet);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;   }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;   <span class="comment">// Open the main output</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;   OutStream.open(m_strOutFile.c_str(), ios::out | ios::trunc);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;   <span class="keywordflow">if</span> (! OutStream)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;   {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      <span class="comment">// Error, cannot open Out file</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      cerr &lt;&lt; <a class="code" href="cme_8h.html#a292fc90846543ca4814daa9f759feb05">ERR</a> &lt;&lt; <span class="stringliteral">&quot;cannot open &quot;</span> &lt;&lt; m_strOutFile &lt;&lt; <span class="stringliteral">&quot; for output&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <span class="keywordflow">return</span> (<a class="code" href="cme_8h.html#acd78f2ec2fd08b573ac83a930061ffcb">RTN_ERR_OUTFILE</a>);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;   }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;   <span class="comment">// Write beginning-of-run information to Out and Log files</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;   WriteStartRunDetails();</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;   <span class="comment">// Start initializing</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;   AnnounceInitializing();</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   <span class="comment">// Misc initialization calcs</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;   m_nCoastMax = <a class="code" href="cme_8h.html#ad75a3d0b0920b046e92b0632488849d6">COAST_LENGTH_MAX</a> * <a class="code" href="cme_8h.html#a7e895b460cef877dec4d12ead0c74f15">tMax</a>(m_nXGridMax, m_nYGridMax);                                        <span class="comment">// Arbitrary but probably OK</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;   m_nCoastMin = <a class="code" href="utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(<a class="code" href="cme_8h.html#a97e43e4b0e15247a4c69783069937d91">COAST_LENGTH_MIN_X_PROF_SPACE</a> * m_dCoastNormalAvgSpacing / m_dCellSide);           <span class="comment">// Ditto</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;   m_nCoastCurvatureInterval = <a class="code" href="cme_8h.html#a7e895b460cef877dec4d12ead0c74f15">tMax</a>(<a class="code" href="utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(m_dCoastNormalAvgSpacing / (m_dCellSide * 2)), 2);              <span class="comment">// Ditto</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;   <span class="comment">// For beach erosion/deposition, conversion from immersed weight to bulk volumetric (sand and voids) transport rate (Leo Van Rijn)</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;   m_dInmersedToBulkVolumetric = 1 / ((m_dBeachSedimentDensity - m_dSeaWaterDensity) * (1 - m_dBeachSedimentPorosity) * m_dG);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;   m_bConsChangedThisIter.resize(m_nLayers, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   m_bUnconsChangedThisIter.resize(m_nLayers, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;   <span class="comment">// Normalize erodibility values, so that none are &gt; 1</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   <span class="keywordtype">double</span> dTmp = m_dFineErodibility + m_dSandErodibility + m_dCoarseErodibility;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;   m_dFineErodibilityNormalized = m_dFineErodibility / dTmp;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;   m_dSandErodibilityNormalized = m_dSandErodibility / dTmp;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;   m_dCoarseErodibilityNormalized = m_dCoarseErodibility / dTmp;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;   <span class="comment">// Intialise SWL</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;   m_dThisIterSWL = m_dOrigSWL;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;   <span class="comment">// If SWL changes during the simulation, calculate the per-timestep increment (could be -ve)</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;   <span class="keywordflow">if</span> (m_dFinalSWL != m_dOrigSWL)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;   {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      m_dDeltaSWLPerTimestep = (m_dTimeStep * (m_dFinalSWL - m_dOrigSWL)) / m_dSimDuration;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      m_dAccumulatedSeaLevelChange -= m_dDeltaSWLPerTimestep;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;   }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;   <span class="keywordflow">if</span> (m_bDoCliffCollapse)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;   {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      <span class="comment">// Now that we know the cell size, calculate the width of a cliff collapse in cells (must be odd)</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      m_nCliffCollapseTalusPlanviewWidth = <a class="code" href="utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(m_dCliffDepositionPlanviewWidth / m_dCellSide);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <span class="keywordflow">if</span> ((m_nCliffCollapseTalusPlanviewWidth % 2) == 0)</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;         m_nCliffCollapseTalusPlanviewWidth++;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      m_dCliffDepositionPlanviewWidth = m_nCliffCollapseTalusPlanviewWidth * m_dCellSide;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;   }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;   <span class="comment">// ===================================================== The main loop ======================================================</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;   <span class="comment">// Tell the user what is happening</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;   AnnounceIsRunning();</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;   <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;   {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">//       // DEBUG CODE =========================================</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">//       LogStream &lt;&lt; ulGetRand0() &lt;&lt; &quot; &quot; &lt;&lt; ulGetRand1() &lt;&lt; endl;</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">//       // DEBUG CODE =========================================</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="comment">// Check that we haven&#39;t gone on too long: if not then update timestep number etc.</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      <span class="keywordflow">if</span> (bTimeToQuit())</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="comment">// Tell the user how the simulation is progressing</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      AnnounceProgress();</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot;TIMESTEP &quot;</span> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot; ================================================================================================&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <span class="comment">// Check to see if there is a new intervention in place: if so, update it on the RasterGrid array</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      nRet = nUpdateIntervention();</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;         <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <span class="comment">// Calculate changes due to external forcing</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      nRet = nCalcExternalForcing();</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;         <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <span class="comment">// Do per-timestep intialization: set up the grid cells ready for this timestep, also initialize per-timestep totals. Note that in the first timestep, all cells -- including hinterland cells -- are given the deep water wave values TODO re. changing deep water wave values</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      nRet = nInitGridAndCalcStillWaterLevel();</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;         <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      <span class="comment">// Next find out which cells are inundated and locate the coastline(s). This also gives to all sea cells, wave values which are the same as the deep water values. For shallow water sea cells, these wave values will be changed later, in nDoAllPropagateWaves()</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      nRet = nLocateSeaAndCoasts();</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;         <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="keywordflow">if</span> (m_nLogFileDetail &gt;= <a class="code" href="cme_8h.html#a540d8a94fc09b0b14fd8ab657445b67a">LOG_FILE_MIDDLE_DETAIL</a>) <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <span class="comment">// Tell the user how the simulation is progressing</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      AnnounceProgress();</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      <span class="comment">// Locate estuaries</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      nRet = nLocateAllEstuaries();</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;         <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      <span class="comment">// Sort out hinterland landforms</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      nRet = nAssignNonCoastlineLandforms();</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;         <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="comment">// For each coastline, use classification rules to assign landform categories</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      nRet = nAssignAllCoastalLandforms();</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;         <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160; </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <span class="comment">// If we have sediment input events, then check to see whether this is time for an event to occur. If it is, then do it</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      <span class="keywordflow">if</span> (m_bSedimentInput)</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;         m_bSedimentInputThisIter = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;         nRet = nCheckForSedimentInputEvent();</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;         <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <span class="comment">// Create the coastline-normal profiles</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      nRet = nCreateAllProfilesAndCheckForIntersection();</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;         <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      <span class="keywordflow">if</span> (m_nLogFileDetail &gt;= <a class="code" href="cme_8h.html#a540d8a94fc09b0b14fd8ab657445b67a">LOG_FILE_MIDDLE_DETAIL</a>) <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <span class="comment">// Tell the user how the simulation is progressing</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      AnnounceProgress();</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <span class="comment">// Create the coast polygons</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      nRet = nCreateAllPolygons();</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;         <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">//       // DEBUG CODE =========================================</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">//       int nNODATA = 0;</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">//       int nPoly0 = 0;</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">//       for (int nX = 0; nX &lt; m_nXGridMax; nX++)</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">//       {</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">//          for (int nY = 0; nY &lt; m_nYGridMax; nY++)</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">//          {</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">//             int nTmp = m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID();</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">//             if (nTmp == INT_NODATA)</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">//                nNODATA++;</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">//             if (nTmp == 0)</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">//                nPoly0++;</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">//       }</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">//       LogStream &lt;&lt; &quot;Before marking polygon cells, N cells with NODATA polygon ID = &quot; &lt;&lt; nNODATA &lt;&lt; endl;</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">//       LogStream &lt;&lt; &quot;Before marking polygon cells, N cells with zero polygon ID = &quot; &lt;&lt; nPoly0 &lt;&lt; endl;</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">//       // DEBUG CODE =========================================</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="comment">// Mark cells of the raster grid that are within each polygon</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      MarkPolygonCells();</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <span class="comment">// Calculate the length of the shared normal between each polygon and the adjacent polygon(s)</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      nRet = nDoPolygonSharedBoundaries();</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;         <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160; </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      <span class="keywordflow">if</span> (m_nLogFileDetail &gt;= <a class="code" href="cme_8h.html#a540d8a94fc09b0b14fd8ab657445b67a">LOG_FILE_MIDDLE_DETAIL</a>) <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="comment">// Tell the user how the simulation is progressing</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      AnnounceProgress();</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">//       // DEBUG CODE =========================================</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment">//       nNODATA = 0;</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">//       nPoly0 = 0;</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">//       for (int nX = 0; nX &lt; m_nXGridMax; nX++)</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">//       {</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">//          for (int nY = 0; nY &lt; m_nYGridMax; nY++)</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">//          {</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">//             int nTmp = m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID();</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">//             if (nTmp == INT_NODATA)</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">//                nNODATA++;</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">//             if (nTmp == 0)</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">//                nPoly0++;</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">//       }</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment">//       LogStream &lt;&lt; &quot;After marking polygon cells, N cells with NODATA polygon ID = &quot; &lt;&lt; nNODATA &lt;&lt; endl;</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment">//       LogStream &lt;&lt; &quot;After marking polygon cells, N cells with zero polygon ID = &quot; &lt;&lt; nPoly0 &lt;&lt; endl;</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment">//       // DEBUG CODE =========================================</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      <span class="comment">// PropagateWind();</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      <span class="comment">// Give every coast point a value for deep water wave height and direction</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      nRet = nSetAllCoastpointDeepWaterWaveValues();</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;         <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      <span class="comment">// Change the wave properties in all shallow water sea cells: propagate waves and define the active zone, also locate wave shadow zones</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      nRet = nDoAllPropagateWaves();</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;         <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <span class="keywordflow">if</span> (m_nLogFileDetail &gt;= <a class="code" href="cme_8h.html#a540d8a94fc09b0b14fd8ab657445b67a">LOG_FILE_MIDDLE_DETAIL</a>) <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      <span class="comment">// Tell the user how the simulation is progressing</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      AnnounceProgress();</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">//       // DEBUG CODE ===========================================</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">//       string strOutFile = m_strOutPath;</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">//       strOutFile += &quot;sea_wave_height_CHECKPOINT_&quot;;</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">//       strOutFile += std::to_string(m_ulIter);</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">//       strOutFile += &quot;.tif&quot;;</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">//       GDALDriver* pDriver = GetGDALDriverManager()-&gt;GetDriverByName(&quot;gtiff&quot;);</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">//       GDALDataset* pDataSet = pDriver-&gt;Create(strOutFile.c_str(), m_nXGridMax, m_nYGridMax, 1, GDT_Float64, m_papszGDALRasterOptions);</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">//       pDataSet-&gt;SetProjection(m_strGDALBasementDEMProjection.c_str());</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">//       pDataSet-&gt;SetGeoTransform(m_dGeoTransform);</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">//       int nn = 0;</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">//       double* pdRaster = new double[m_nXGridMax * m_nYGridMax];</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">//       for (int nY = 0; nY &lt; m_nYGridMax; nY++)</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">//       {</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">//          for (int nX = 0; nX &lt; m_nXGridMax; nX++)</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">//          {</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">//             pdRaster[nn++] = m_pRasterGrid-&gt;m_Cell[nX][nY].dGetWaveHeight();</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">//       }</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">//       GDALRasterBand* pBand = pDataSet-&gt;GetRasterBand(1);</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">//       pBand-&gt;SetNoDataValue(m_dMissingValue);</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">//       int nRet = pBand-&gt;RasterIO(GF_Write, 0, 0, m_nXGridMax, m_nYGridMax, pdRaster, m_nXGridMax, m_nYGridMax, GDT_Float64, 0, 0, NULL);</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">//       if (nRet == CE_Failure)</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">//          return RTN_ERR_GRIDCREATE;</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">//       GDALClose(pDataSet);</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">//       delete[] pdRaster;</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">//       // DEBUG CODE ===========================================</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">//       // DEBUG CODE ===========================================</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">//       strOutFile = m_strOutPath;</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">//       strOutFile += &quot;sea_wave_angle_CHECKPOINT_&quot;;</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">//       strOutFile += std::to_string(m_ulIter);</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">//       strOutFile += &quot;.tif&quot;;</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">//       pDriver = GetGDALDriverManager()-&gt;GetDriverByName(&quot;gtiff&quot;);</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">//       pDataSet = pDriver-&gt;Create(strOutFile.c_str(), m_nXGridMax, m_nYGridMax, 1, GDT_Float64, m_papszGDALRasterOptions);</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">//       pDataSet-&gt;SetProjection(m_strGDALBasementDEMProjection.c_str());</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">//       pDataSet-&gt;SetGeoTransform(m_dGeoTransform);</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">//       nn = 0;</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">//       pdRaster = new double[m_nXGridMax * m_nYGridMax];</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">//       for (int nY = 0; nY &lt; m_nYGridMax; nY++)</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">//       {</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">//          for (int nX = 0; nX &lt; m_nXGridMax; nX++)</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">//          {</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">//             pdRaster[nn++] = m_pRasterGrid-&gt;m_Cell[nX][nY].dGetWaveAngle();</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">//       }</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">//       pBand = pDataSet-&gt;GetRasterBand(1);</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">//       pBand-&gt;SetNoDataValue(m_dMissingValue);</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">//       nRet = pBand-&gt;RasterIO(GF_Write, 0, 0, m_nXGridMax, m_nYGridMax, pdRaster, m_nXGridMax, m_nYGridMax, GDT_Float64, 0, 0, NULL);</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">//       if (nRet == CE_Failure)</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">//          return RTN_ERR_GRIDCREATE;</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">//       GDALClose(pDataSet);</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">//       delete[] pdRaster;</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">//       // DEBUG CODE ===========================================</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      <span class="keywordflow">if</span> (m_bDoCoastPlatformErosion)</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;         <span class="comment">// Calculate elevation change on the consolidated sediment which comprises the coastal platform</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;         nRet = nDoAllShorePlatFormErosion();</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;         <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      }</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      <span class="keywordflow">if</span> (m_bDoCliffCollapse)</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      {</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;         <span class="comment">// Do all cliff collapses for this timestep (if any)</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;         nRet = nDoAllWaveEnergyToCoastLandforms();</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;         <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      <span class="comment">// Tell the user how the simulation is progressing</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      AnnounceProgress();</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      <span class="keywordflow">if</span> (m_bDoBeachSedimentTransport)</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;         <span class="comment">// Next simulate beach erosion and deposition i.e. simulate alongshore transport of unconsolidated sediment (longshore drift) between polygons. First calculate potential sediment movement between polygons</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;         DoAllPotentialBeachErosion();</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;         <span class="comment">// Do within-sediment redistribution of unconsolidated sediment, constraining potential sediment movement to give actual (i.e. supply-limited) sediment movement to/from each polygon in three size clases</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;         nRet = nDoAllActualBeachErosionAndDeposition();</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;         <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      }</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="comment">// Add the fine sediment that was eroded this timestep (from the shore platform, from beach erosion, and cliff collapse talus deposition, minus the fine that went off-grid) to the suspended sediment load</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <span class="keywordtype">double</span> dFineThisIter = m_dThisIterActualPlatformErosionFine + m_dThisIterActualBeachErosionFine + m_dThisIterCliffErosionFine - m_dThisIterActualFineSedLostBeachErosion;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      m_dThisIterFineSedimentToSuspension += dFineThisIter;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="comment">// Tell the user how the simulation is progressing</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      AnnounceProgress();</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">//       // DEBUG CODE ===========================================</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">//       string strOutFile = m_strOutPath;</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">//       strOutFile += &quot;sea_wave_height_CHECKPOINT_&quot;;</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">//       strOutFile += std::to_string(m_ulIter);</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">//       strOutFile += &quot;.tif&quot;;</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">//       GDALDriver* pDriver = GetGDALDriverManager()-&gt;GetDriverByName(&quot;gtiff&quot;);</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">//       GDALDataset* pDataSet = pDriver-&gt;Create(strOutFile.c_str(), m_nXGridMax, m_nYGridMax, 1, GDT_Float64, m_papszGDALRasterOptions);</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">//       pDataSet-&gt;SetProjection(m_strGDALBasementDEMProjection.c_str());</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">//       pDataSet-&gt;SetGeoTransform(m_dGeoTransform);</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">//       int nn = 0;</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">//       double* pdRaster = new double[m_nXGridMax * m_nYGridMax];</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">//       for (int nY = 0; nY &lt; m_nYGridMax; nY++)</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">//       {</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">//          for (int nX = 0; nX &lt; m_nXGridMax; nX++)</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">//          {</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment">//             pdRaster[nn++] = m_pRasterGrid-&gt;m_Cell[nX][nY].dGetWaveHeight();</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">//       }</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment">//       GDALRasterBand* pBand = pDataSet-&gt;GetRasterBand(1);</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">//       pBand-&gt;SetNoDataValue(m_dMissingValue);</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment">//       int nRet = pBand-&gt;RasterIO(GF_Write, 0, 0, m_nXGridMax, m_nYGridMax, pdRaster, m_nXGridMax, m_nYGridMax, GDT_Float64, 0, 0, NULL);</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment">//       if (nRet == CE_Failure)</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">//          return RTN_ERR_GRIDCREATE;</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">//       GDALClose(pDataSet);</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">//       delete[] pdRaster;</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">//       // DEBUG CODE ===========================================</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">//       // DEBUG CODE ===========================================</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">//       strOutFile = m_strOutPath;</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">//       strOutFile += &quot;sea_wave_angle_CHECKPOINT_&quot;;</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">//       strOutFile += std::to_string(m_ulIter);</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">//       strOutFile += &quot;.tif&quot;;</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">//       pDriver = GetGDALDriverManager()-&gt;GetDriverByName(&quot;gtiff&quot;);</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">//       pDataSet = pDriver-&gt;Create(strOutFile.c_str(), m_nXGridMax, m_nYGridMax, 1, GDT_Float64, m_papszGDALRasterOptions);</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">//       pDataSet-&gt;SetProjection(m_strGDALBasementDEMProjection.c_str());</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">//       pDataSet-&gt;SetGeoTransform(m_dGeoTransform);</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment">//       nn = 0;</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">//       pdRaster = new double[m_nXGridMax * m_nYGridMax];</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">//       for (int nY = 0; nY &lt; m_nYGridMax; nY++)</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">//       {</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">//          for (int nX = 0; nX &lt; m_nXGridMax; nX++)</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">//          {</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">//             pdRaster[nn++] = m_pRasterGrid-&gt;m_Cell[nX][nY].dGetWaveAngle();</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">//       }</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">//       pBand = pDataSet-&gt;GetRasterBand(1);</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">//       pBand-&gt;SetNoDataValue(m_dMissingValue);</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">//       nRet = pBand-&gt;RasterIO(GF_Write, 0, 0, m_nXGridMax, m_nYGridMax, pdRaster, m_nXGridMax, m_nYGridMax, GDT_Float64, 0, 0, NULL);</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">//       if (nRet == CE_Failure)</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">//          return RTN_ERR_GRIDCREATE;</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">//       GDALClose(pDataSet);</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">//       delete[] pdRaster;</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">//       // DEBUG CODE ===========================================</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <span class="comment">// Do some end-of-timestep updates to the raster grid, also update per-timestep and running totals</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      nRet = nUpdateGrid();</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;         <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;      <span class="comment">// Now save results, first the raster and vector GIS files if required</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      m_bSaveGISThisIter = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      <span class="keywordflow">if</span> ((m_bSaveRegular &amp;&amp; (m_dSimElapsed &gt;= m_dRSaveTime) &amp;&amp; (m_dSimElapsed &lt; m_dSimDuration)) || (! m_bSaveRegular &amp;&amp; (m_dSimElapsed &gt;= m_dUSaveTime[m_nThisSave])))</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      {</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;         m_bSaveGISThisIter = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160; </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;         <span class="comment">// Save the values from the RasterGrid array into raster GIS files</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;         <span class="keywordflow">if</span> (! bSaveAllRasterGISFiles())</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;            <span class="keywordflow">return</span> (<a class="code" href="cme_8h.html#a430336a4fc67ffc27f4bf042e5c634bb">RTN_ERR_RASTER_FILE_WRITE</a>);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; </div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;         <span class="comment">// Tell the user how the simulation is progressing</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;         AnnounceProgress();</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160; </div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;         <span class="comment">// Save the vector GIS files</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;         <span class="keywordflow">if</span> (! bSaveAllVectorGISFiles())</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            <span class="keywordflow">return</span> (<a class="code" href="cme_8h.html#aac3c7a3e7d0567e93cd89d8a8e138c15">RTN_ERR_VECTOR_FILE_WRITE</a>);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; </div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;         <span class="comment">// Tell the user how the simulation is progressing</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;         AnnounceProgress();</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      }</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; </div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      <span class="comment">// Output per-timestep results to the .out file</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      <span class="keywordflow">if</span> (! bWritePerTimestepResults())</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;         <span class="keywordflow">return</span> (<a class="code" href="cme_8h.html#aa8e6a1882e2ece597b1b515f0848f39a">RTN_ERR_TEXT_FILE_WRITE</a>);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      <span class="comment">// Now output time series CSV stuff</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      <span class="keywordflow">if</span> (! bWriteTSFiles())</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;         <span class="keywordflow">return</span> (<a class="code" href="cme_8h.html#afe9f5d6d7c392abcdd78d9e08d032a6a">RTN_ERR_TIMESERIES_FILE_WRITE</a>);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      <span class="comment">// Tell the user how the simulation is progressing</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      AnnounceProgress();</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      <span class="comment">// Update grand totals</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      UpdateGrandTotals();</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;   }  <span class="comment">// ================================================ End of main loop ======================================================</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;   <span class="comment">// =================================================== post-loop tidying =====================================================</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;   <span class="comment">// Tell the user what is happening</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;   AnnounceSimEnd();</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;   <span class="comment">// Write end-of-run information to Out, Log and time-series files</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;   nRet = nWriteEndRunDetails();</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;   <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      <span class="keywordflow">return</span> (nRet);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;}</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160; </div>
<div class="ttc" id="aclass_c_geom_cell_html_a556db5cb0e1b09d8e3f799f9e66138c0"><div class="ttname"><a href="class_c_geom_cell.html#a556db5cb0e1b09d8e3f799f9e66138c0">CGeomCell::AppendLayers</a></div><div class="ttdeci">void AppendLayers(int const)</div><div class="ttdoc">Appends sediment layers.</div><div class="ttdef"><b>Definition:</b> <a href="cell_8cpp_source.html#l00458">cell.cpp:458</a></div></div>
<div class="ttc" id="aclass_c_geom_raster_grid_html"><div class="ttname"><a href="class_c_geom_raster_grid.html">CGeomRasterGrid</a></div><div class="ttdoc">Geometry cass used to represent the raster grid of cell objects.</div><div class="ttdef"><b>Definition:</b> <a href="raster__grid_8h_source.html#l00037">raster_grid.h:38</a></div></div>
<div class="ttc" id="aclass_c_simulation_html_a222962121613613a48f518e0c2110f21"><div class="ttname"><a href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">CSimulation::LogStream</a></div><div class="ttdeci">ofstream LogStream</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00806">simulation.h:806</a></div></div>
<div class="ttc" id="aclass_c_simulation_html_a46f08f37407a47d10b107f77d86c13c9"><div class="ttname"><a href="class_c_simulation.html#a46f08f37407a47d10b107f77d86c13c9">CSimulation::nGetGridYMax</a></div><div class="ttdeci">int nGetGridYMax(void) const</div><div class="ttdoc">Returns the size of the grid in the Y direction.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8cpp_source.html#l00480">simulation.cpp:480</a></div></div>
<div class="ttc" id="aclass_c_simulation_html_a4e7ff288de047e51b653ee0ff747a492"><div class="ttname"><a href="class_c_simulation.html#a4e7ff288de047e51b653ee0ff747a492">CSimulation::dGetMissingValue</a></div><div class="ttdeci">double dGetMissingValue(void) const</div><div class="ttdoc">Returns the NODATA value.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8cpp_source.html#l00453">simulation.cpp:453</a></div></div>
<div class="ttc" id="aclass_c_simulation_html_a5356bdb1798b3397b3f19b69c62c0ddf"><div class="ttname"><a href="class_c_simulation.html#a5356bdb1798b3397b3f19b69c62c0ddf">CSimulation::dGetD50Coarse</a></div><div class="ttdeci">double dGetD50Coarse(void) const</div><div class="ttdoc">Returns the global d50 value for coarse sediment.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8cpp_source.html#l00495">simulation.cpp:495</a></div></div>
<div class="ttc" id="aclass_c_simulation_html_a5f5c62e03730a145a32347457d641cad"><div class="ttname"><a href="class_c_simulation.html#a5f5c62e03730a145a32347457d641cad">CSimulation::CSimulation</a></div><div class="ttdeci">CSimulation(void)</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8cpp_source.html#l00046">simulation.cpp:46</a></div></div>
<div class="ttc" id="aclass_c_simulation_html_a6c774658534c73605f2f0a12f511b08a"><div class="ttname"><a href="class_c_simulation.html#a6c774658534c73605f2f0a12f511b08a">CSimulation::dGetD50Fine</a></div><div class="ttdeci">double dGetD50Fine(void) const</div><div class="ttdoc">Returns the global d50 value for fine sediment.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8cpp_source.html#l00485">simulation.cpp:485</a></div></div>
<div class="ttc" id="aclass_c_simulation_html_a870fb7ffba3db6692998dcbecc37b599"><div class="ttname"><a href="class_c_simulation.html#a870fb7ffba3db6692998dcbecc37b599">CSimulation::nGetGridXMax</a></div><div class="ttdeci">int nGetGridXMax(void) const</div><div class="ttdoc">Returns the cell size.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8cpp_source.html#l00475">simulation.cpp:475</a></div></div>
<div class="ttc" id="aclass_c_simulation_html_a9657f6315931bb105f99a5ff414b6dbf"><div class="ttname"><a href="class_c_simulation.html#a9657f6315931bb105f99a5ff414b6dbf">CSimulation::~CSimulation</a></div><div class="ttdeci">~CSimulation(void)</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8cpp_source.html#l00391">simulation.cpp:391</a></div></div>
<div class="ttc" id="aclass_c_simulation_html_ac02c569e193c122cfb70735c8dfc43bd"><div class="ttname"><a href="class_c_simulation.html#ac02c569e193c122cfb70735c8dfc43bd">CSimulation::dGetD50Sand</a></div><div class="ttdeci">double dGetD50Sand(void) const</div><div class="ttdoc">Returns the global d50 value for sand sediment.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8cpp_source.html#l00490">simulation.cpp:490</a></div></div>
<div class="ttc" id="aclass_c_simulation_html_ac72a34bfb2593d1aa861240ac243962f"><div class="ttname"><a href="class_c_simulation.html#ac72a34bfb2593d1aa861240ac243962f">CSimulation::nDoSimulation</a></div><div class="ttdeci">int nDoSimulation(int, char *[])</div><div class="ttdoc">Runs the simulation.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8cpp_source.html#l00506">simulation.cpp:506</a></div></div>
<div class="ttc" id="aclass_c_simulation_html_acf8084fc9180ae0ec41e04d8dac7c2c0"><div class="ttname"><a href="class_c_simulation.html#acf8084fc9180ae0ec41e04d8dac7c2c0">CSimulation::dGetThisIterSWL</a></div><div class="ttdeci">double dGetThisIterSWL(void) const</div><div class="ttdoc">Returns this timestep's still water level.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8cpp_source.html#l00459">simulation.cpp:459</a></div></div>
<div class="ttc" id="aclass_c_simulation_html_adc13bc3c8fd4d97cb3e9d34c37ff688f"><div class="ttname"><a href="class_c_simulation.html#adc13bc3c8fd4d97cb3e9d34c37ff688f">CSimulation::dGetMaxBeachElevAboveSWL</a></div><div class="ttdeci">double dGetMaxBeachElevAboveSWL(void) const</div><div class="ttdoc">Returns the vertical tolerance for beach cells to be included in smoothing.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8cpp_source.html#l00465">simulation.cpp:465</a></div></div>
<div class="ttc" id="acme_8h_html"><div class="ttname"><a href="cme_8h.html">cme.h</a></div><div class="ttdoc">This file contains global definitions for CoastalME.</div></div>
<div class="ttc" id="acme_8h_html_a01aa8b423260b337ddff2016107b51a0"><div class="ttname"><a href="cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a></div><div class="ttdeci">int const INT_NODATA</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00188">cme.h:188</a></div></div>
<div class="ttc" id="acme_8h_html_a2172da7520364105ea080054fe7127af"><div class="ttname"><a href="cme_8h.html#a2172da7520364105ea080054fe7127af">SAND_CONS_RASTER</a></div><div class="ttdeci">int const SAND_CONS_RASTER</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00252">cme.h:252</a></div></div>
<div class="ttc" id="acme_8h_html_a263644961c3d206b83d11df64d23677b"><div class="ttname"><a href="cme_8h.html#a263644961c3d206b83d11df64d23677b">SEDIMENT_INPUT_EVENT_LOCATION_VEC</a></div><div class="ttdeci">int const SEDIMENT_INPUT_EVENT_LOCATION_VEC</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00279">cme.h:279</a></div></div>
<div class="ttc" id="acme_8h_html_a292fc90846543ca4814daa9f759feb05"><div class="ttname"><a href="cme_8h.html#a292fc90846543ca4814daa9f759feb05">ERR</a></div><div class="ttdeci">string const ERR</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00543">cme.h:543</a></div></div>
<div class="ttc" id="acme_8h_html_a2e14aa57bb01856bfb7186c5907a77b7"><div class="ttname"><a href="cme_8h.html#a2e14aa57bb01856bfb7186c5907a77b7">RTN_ERR_LOGFILE</a></div><div class="ttdeci">int const RTN_ERR_LOGFILE</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00368">cme.h:368</a></div></div>
<div class="ttc" id="acme_8h_html_a3ee6a825c91b2a64be7c1ac50a04f4c2"><div class="ttname"><a href="cme_8h.html#a3ee6a825c91b2a64be7c1ac50a04f4c2">RTN_ERR_RASTER_GIS_OUT_FORMAT</a></div><div class="ttdeci">int const RTN_ERR_RASTER_GIS_OUT_FORMAT</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00375">cme.h:375</a></div></div>
<div class="ttc" id="acme_8h_html_a430336a4fc67ffc27f4bf042e5c634bb"><div class="ttname"><a href="cme_8h.html#a430336a4fc67ffc27f4bf042e5c634bb">RTN_ERR_RASTER_FILE_WRITE</a></div><div class="ttdeci">int const RTN_ERR_RASTER_FILE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00378">cme.h:378</a></div></div>
<div class="ttc" id="acme_8h_html_a540d8a94fc09b0b14fd8ab657445b67a"><div class="ttname"><a href="cme_8h.html#a540d8a94fc09b0b14fd8ab657445b67a">LOG_FILE_MIDDLE_DETAIL</a></div><div class="ttdeci">int const LOG_FILE_MIDDLE_DETAIL</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00180">cme.h:180</a></div></div>
<div class="ttc" id="acme_8h_html_a63f6debb865be4b72e0f1911e34cadb1"><div class="ttname"><a href="cme_8h.html#a63f6debb865be4b72e0f1911e34cadb1">RTN_ERR_PROFILESPACING</a></div><div class="ttdeci">int const RTN_ERR_PROFILESPACING</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00382">cme.h:382</a></div></div>
<div class="ttc" id="acme_8h_html_a74c5ed54fcf9b27b5ab23c2f039dac1a"><div class="ttname"><a href="cme_8h.html#a74c5ed54fcf9b27b5ab23c2f039dac1a">DEEP_WATER_WAVE_STATIONS_VEC</a></div><div class="ttdeci">int const DEEP_WATER_WAVE_STATIONS_VEC</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00276">cme.h:276</a></div></div>
<div class="ttc" id="acme_8h_html_a7542a661b37e38a9fa9544aa963dc262"><div class="ttname"><a href="cme_8h.html#a7542a661b37e38a9fa9544aa963dc262">RTN_ERR_RUNDATA</a></div><div class="ttdeci">int const RTN_ERR_RUNDATA</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00365">cme.h:365</a></div></div>
<div class="ttc" id="acme_8h_html_a7e895b460cef877dec4d12ead0c74f15"><div class="ttname"><a href="cme_8h.html#a7e895b460cef877dec4d12ead0c74f15">tMax</a></div><div class="ttdeci">T tMax(T a, T b)</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00839">cme.h:839</a></div></div>
<div class="ttc" id="acme_8h_html_a88da059dd82bd1da1a6ab9359cc9fedf"><div class="ttname"><a href="cme_8h.html#a88da059dd82bd1da1a6ab9359cc9fedf">RTN_ERR_TSFILE</a></div><div class="ttdeci">int const RTN_ERR_TSFILE</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00370">cme.h:370</a></div></div>
<div class="ttc" id="acme_8h_html_a8d9b72aabe736946364e97529cfffc2d"><div class="ttname"><a href="cme_8h.html#a8d9b72aabe736946364e97529cfffc2d">INTERVENTION_CLASS_RASTER</a></div><div class="ttdeci">int const INTERVENTION_CLASS_RASTER</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00259">cme.h:259</a></div></div>
<div class="ttc" id="acme_8h_html_a925d41f084c87d8a0546558cdc9ca74c"><div class="ttname"><a href="cme_8h.html#a925d41f084c87d8a0546558cdc9ca74c">RTN_ERR_VECTOR_GIS_OUT_FORMAT</a></div><div class="ttdeci">int const RTN_ERR_VECTOR_GIS_OUT_FORMAT</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00376">cme.h:376</a></div></div>
<div class="ttc" id="acme_8h_html_a96bda0776b4e4dffdf460b33330c5051"><div class="ttname"><a href="cme_8h.html#a96bda0776b4e4dffdf460b33330c5051">SMOOTH_SAVITZKY_GOLAY</a></div><div class="ttdeci">int const SMOOTH_SAVITZKY_GOLAY</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00433">cme.h:433</a></div></div>
<div class="ttc" id="acme_8h_html_a97e43e4b0e15247a4c69783069937d91"><div class="ttname"><a href="cme_8h.html#a97e43e4b0e15247a4c69783069937d91">COAST_LENGTH_MIN_X_PROF_SPACE</a></div><div class="ttdeci">int const COAST_LENGTH_MIN_X_PROF_SPACE</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00166">cme.h:166</a></div></div>
<div class="ttc" id="acme_8h_html_a988c3a8ded6542349e49376b71be3e7f"><div class="ttname"><a href="cme_8h.html#a988c3a8ded6542349e49376b71be3e7f">RTN_ERR_CMEDIR</a></div><div class="ttdeci">int const RTN_ERR_CMEDIR</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00364">cme.h:364</a></div></div>
<div class="ttc" id="acme_8h_html_aa2099564e4b2dd4b6a04a68589fb91c7"><div class="ttname"><a href="cme_8h.html#aa2099564e4b2dd4b6a04a68589fb91c7">RTN_ERR_INI</a></div><div class="ttdeci">int const RTN_ERR_INI</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00363">cme.h:363</a></div></div>
<div class="ttc" id="acme_8h_html_aa768cb14b5c6123ee95e6e4ebd9fe331"><div class="ttname"><a href="cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a></div><div class="ttdeci">int const RTN_OK</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00358">cme.h:358</a></div></div>
<div class="ttc" id="acme_8h_html_aa8e6a1882e2ece597b1b515f0848f39a"><div class="ttname"><a href="cme_8h.html#aa8e6a1882e2ece597b1b515f0848f39a">RTN_ERR_TEXT_FILE_WRITE</a></div><div class="ttdeci">int const RTN_ERR_TEXT_FILE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00377">cme.h:377</a></div></div>
<div class="ttc" id="acme_8h_html_aac3c7a3e7d0567e93cd89d8a8e138c15"><div class="ttname"><a href="cme_8h.html#aac3c7a3e7d0567e93cd89d8a8e138c15">RTN_ERR_VECTOR_FILE_WRITE</a></div><div class="ttdeci">int const RTN_ERR_VECTOR_FILE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00379">cme.h:379</a></div></div>
<div class="ttc" id="acme_8h_html_ab1ebe7d63321af5461a1f4591030db3d"><div class="ttname"><a href="cme_8h.html#ab1ebe7d63321af5461a1f4591030db3d">SAND_UNCONS_RASTER</a></div><div class="ttdeci">int const SAND_UNCONS_RASTER</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00255">cme.h:255</a></div></div>
<div class="ttc" id="acme_8h_html_abc614ab3e34b7523e416dbd9596817c2"><div class="ttname"><a href="cme_8h.html#abc614ab3e34b7523e416dbd9596817c2">FINE_UNCONS_RASTER</a></div><div class="ttdeci">int const FINE_UNCONS_RASTER</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00254">cme.h:254</a></div></div>
<div class="ttc" id="acme_8h_html_abf85b5b7fd25cfc4336178ac649975a2"><div class="ttname"><a href="cme_8h.html#abf85b5b7fd25cfc4336178ac649975a2">COARSE_UNCONS_RASTER</a></div><div class="ttdeci">int const COARSE_UNCONS_RASTER</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00256">cme.h:256</a></div></div>
<div class="ttc" id="acme_8h_html_ac003bdff958dca839f5d274f15786e07"><div class="ttname"><a href="cme_8h.html#ac003bdff958dca839f5d274f15786e07">DBL_NODATA</a></div><div class="ttdeci">double const DBL_NODATA</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00476">cme.h:476</a></div></div>
<div class="ttc" id="acme_8h_html_acd78f2ec2fd08b573ac83a930061ffcb"><div class="ttname"><a href="cme_8h.html#acd78f2ec2fd08b573ac83a930061ffcb">RTN_ERR_OUTFILE</a></div><div class="ttdeci">int const RTN_ERR_OUTFILE</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00369">cme.h:369</a></div></div>
<div class="ttc" id="acme_8h_html_ad14e0dc7b394b6bdd9dbd3ebd0b745ab"><div class="ttname"><a href="cme_8h.html#ad14e0dc7b394b6bdd9dbd3ebd0b745ab">SUSP_SED_RASTER</a></div><div class="ttdeci">int const SUSP_SED_RASTER</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00257">cme.h:257</a></div></div>
<div class="ttc" id="acme_8h_html_ad5789b44b179b77e10bcb0bbfac0405e"><div class="ttname"><a href="cme_8h.html#ad5789b44b179b77e10bcb0bbfac0405e">FINE_CONS_RASTER</a></div><div class="ttdeci">int const FINE_CONS_RASTER</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00251">cme.h:251</a></div></div>
<div class="ttc" id="acme_8h_html_ad60195967f12b9ece8ad3a437182f254"><div class="ttname"><a href="cme_8h.html#ad60195967f12b9ece8ad3a437182f254">COARSE_CONS_RASTER</a></div><div class="ttdeci">int const COARSE_CONS_RASTER</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00253">cme.h:253</a></div></div>
<div class="ttc" id="acme_8h_html_ad75a3d0b0920b046e92b0632488849d6"><div class="ttname"><a href="cme_8h.html#ad75a3d0b0920b046e92b0632488849d6">COAST_LENGTH_MAX</a></div><div class="ttdeci">int const COAST_LENGTH_MAX</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00165">cme.h:165</a></div></div>
<div class="ttc" id="acme_8h_html_ad97c233d5b34c849c78e893ea183119d"><div class="ttname"><a href="cme_8h.html#ad97c233d5b34c849c78e893ea183119d">MIN_PROFILE_SPACING</a></div><div class="ttdeci">int const MIN_PROFILE_SPACING</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00169">cme.h:169</a></div></div>
<div class="ttc" id="acme_8h_html_ae88dce382d8e29ddf4886ffe139c0ddc"><div class="ttname"><a href="cme_8h.html#ae88dce382d8e29ddf4886ffe139c0ddc">LANDFORM_RASTER</a></div><div class="ttdeci">int const LANDFORM_RASTER</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00258">cme.h:258</a></div></div>
<div class="ttc" id="acme_8h_html_af0af8b555af7a1a65f37e4779d575e6f"><div class="ttname"><a href="cme_8h.html#af0af8b555af7a1a65f37e4779d575e6f">INTERVENTION_HEIGHT_RASTER</a></div><div class="ttdeci">int const INTERVENTION_HEIGHT_RASTER</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00260">cme.h:260</a></div></div>
<div class="ttc" id="acme_8h_html_afe9f5d6d7c392abcdd78d9e08d032a6a"><div class="ttname"><a href="cme_8h.html#afe9f5d6d7c392abcdd78d9e08d032a6a">RTN_ERR_TIMESERIES_FILE_WRITE</a></div><div class="ttdeci">int const RTN_ERR_TIMESERIES_FILE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00380">cme.h:380</a></div></div>
<div class="ttc" id="acoast_8h_html"><div class="ttname"><a href="coast_8h.html">coast.h</a></div><div class="ttdoc">Contains CRWCoast definitions.</div></div>
<div class="ttc" id="araster__grid_8h_html"><div class="ttname"><a href="raster__grid_8h.html">raster_grid.h</a></div><div class="ttdoc">Contains CGeomRasterGrid definitions.</div></div>
<div class="ttc" id="asimulation_8h_html"><div class="ttname"><a href="simulation_8h.html">simulation.h</a></div><div class="ttdoc">Contains CSimulation definitions.</div></div>
<div class="ttc" id="asimulation_8h_html_a85c01ae87ffab98fdd1ec6fd3d0eff7b"><div class="ttname"><a href="simulation_8h.html#a85c01ae87ffab98fdd1ec6fd3d0eff7b">SAVEMAX</a></div><div class="ttdeci">int const SAVEMAX</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00053">simulation.h:53</a></div></div>
<div class="ttc" id="asimulation_8h_html_a9a16fa3bd2cdef6c1b57032795dcf9ef"><div class="ttname"><a href="simulation_8h.html#a9a16fa3bd2cdef6c1b57032795dcf9ef">NRNG</a></div><div class="ttdeci">int const NRNG</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00052">simulation.h:52</a></div></div>
<div class="ttc" id="autils__global_8cpp_html_a20842d0a19d0ca952c91f3e1eb175fee"><div class="ttname"><a href="utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a></div><div class="ttdeci">int nRound(double const d)</div><div class="ttdef"><b>Definition:</b> <a href="utils__global_8cpp_source.html#l00054">utils_global.cpp:54</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 29 2021 15:52:59 for CoastalME (Coastal Modelling Environment) by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
