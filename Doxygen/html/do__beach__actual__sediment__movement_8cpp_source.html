<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CoastalME (Coastal Modelling Environment): do_beach_actual_sediment_movement.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CoastalME (Coastal Modelling Environment)
   </div>
   <div id="projectbrief">Simulates the long-term behaviour of complex coastlines</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">do_beach_actual_sediment_movement.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="do__beach__actual__sediment__movement_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">/*==============================================================================================================================</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> This file is part of CoastalME, the Coastal Modelling Environment.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> CoastalME is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">==============================================================================================================================*/</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// #include &lt;assert.h&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;cfloat&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">using</span> std::cout;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">using</span> std::endl;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">using</span> std::stable_sort;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cme_8h.html">cme.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="simulation_8h.html">simulation.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="coast_8h.html">coast.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">/*===============================================================================================================================</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> Function used to sort polygons before doing the polygon-to-polygon sediment budget</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> For both LH and RH arguments, the first value is the polygon coast ID, the second value is the down- or up-coast direction, and subsequent numbers are adjacent polygon coastIDs in that direction. If the first argument must be ordered before the second, return true</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">===============================================================================================================================*/</span></div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="do__beach__actual__sediment__movement_8cpp.html#a0a8801fe3da215959bcf6352e5331b91">   48</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="do__beach__actual__sediment__movement_8cpp.html#a0a8801fe3da215959bcf6352e5331b91">bPolygonAndAdjCompare</a>(<span class="keyword">const</span> vector&lt;int&gt;&amp; nVLeft, <span class="keyword">const</span> vector&lt;int&gt;&amp; nVRight)</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   <span class="comment">// For safety, check that the LHS polygon has at least one adjacent polygon (it should have, apart from the bad situation where just one big polygon is created)</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   <span class="keywordflow">if</span> ((nVLeft.size() &gt;= 3) &amp;&amp; (nVRight.size() &gt;= 3))</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="comment">// Polygons at the grid edge are processed last, so put LHS grid-edge polygons on the RHS</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="keywordflow">if</span> (nVLeft[2] == <a class="code" href="cme_8h.html#aee2e0742555937187504ee86b95bc29c">INT_NODATA</a>)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;         <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="comment">// Polygons at the grid edge are processed last, so keep RHS grid-edge polygons where they are</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordflow">if</span> (nVRight[2] == <a class="code" href="cme_8h.html#aee2e0742555937187504ee86b95bc29c">INT_NODATA</a>)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;         <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="comment">// Now sort out polygon-to-polygon dependencies. We need to put &#39;target&#39; polygons after &#39;source&#39; polygons, so that the source id processed before the target. So does the LHS polygon have the RHS polygon as one of its adjacent polygons?</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 2; n &lt; nVLeft.size(); n++)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;         <span class="keywordflow">if</span> (nVRight[0] == nVLeft[n])</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <span class="comment">// It does, so keep the existing sequence</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="comment">// Does the RHS polygon have the LHS polygon as one of its adjacent polygons?</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 2; n &lt; nVRight.size(); n++)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;         <span class="keywordflow">if</span> (nVLeft[0] == nVRight[n])</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="comment">// It does, so swap them</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   <span class="keywordtype">bool</span> bDownCoast = nVLeft[1];</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   <span class="keywordflow">if</span> (bDownCoast)</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="comment">// Sediment going down-coast</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keywordflow">return</span> nVLeft &lt; nVRight;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="comment">// Sediment going up-coast</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keywordflow">return</span> nVLeft &gt; nVRight;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   <span class="comment">// Default return value, should never get here</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;}</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">/*===============================================================================================================================</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"> Does between-polygon and within-polygon actual (supply-limited) redistribution of transported beach sediment</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">===============================================================================================================================*/</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="keywordtype">int</span> CSimulation::nDoAllActualBeachErosionAndDeposition(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;{</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   <span class="keywordtype">int</span> nRet = <a class="code" href="cme_8h.html#a71d8d6db0e41ed2022d0a95b9a70528c">RTN_OK</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; endl &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: unconsolidated sediment transport. Adjacent polygons, polygon-to-polygon shares (non-dimensional), and polygon D50 values (mm)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot;Note: a zero D50 value means that there is no unconsolidated sediment on that polygon&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot;Num \tGlobal\tCoast\t\tUncons\t(Dirn Adj Share)...&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot;    \tID    \tID   \t\td50&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; m_pVCoastPolygon.size(); n++)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;nGetGlobalID() &lt;&lt; <span class="stringliteral">&quot;\t\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;nGetCoastID() &lt;&lt; <span class="stringliteral">&quot;\t\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;dGetAvgUnconsD50() &lt;&lt; <span class="stringliteral">&quot;\t\t&quot;</span>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; m_pVCoastPolygon[n]-&gt;nGetNumUpCoastAdjacentPolygons(); m++)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;         <span class="keywordflow">if</span> (! m_pVCoastPolygon[n]-&gt;bDownCoastThisTimestep())</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot;(UP  \t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;nGetUpCoastAdjacentPolygon(m) &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;dGetUpCoastAdjacentPolygonBoundaryShare(m) &lt;&lt; <span class="stringliteral">&quot;)\t&quot;</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; m_pVCoastPolygon[n]-&gt;nGetNumDownCoastAdjacentPolygons(); m++)</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;         <span class="keywordflow">if</span> (m_pVCoastPolygon[n]-&gt;bDownCoastThisTimestep())</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot;(DOWN\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;nGetDownCoastAdjacentPolygon(m) &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;dGetDownCoastAdjacentPolygonBoundaryShare(m) &lt;&lt; <span class="stringliteral">&quot;)\t&quot;</span>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: unconsolidated sediment transport. Per-polygon potential beach erosion, and actual deposition from shore platform erosion (all m^3)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot;Num \tGlobal\tCoast\t\tPotential\tActual\t\tFine\t\t\tSand\t\t\tCoarse&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot;    \tID    \tID   \t\tErosion\t\tDeposition\tDeposition\tDeposition\tDeposition&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; m_pVCoastPolygon.size(); n++)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;nGetGlobalID() &lt;&lt; <span class="stringliteral">&quot;\t\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;nGetCoastID() &lt;&lt; <span class="stringliteral">&quot;\t\t\t&quot;</span> &lt;&lt; -m_pVCoastPolygon[n]-&gt;dGetDeltaPotentialErosion() * m_dCellArea &lt;&lt; <span class="stringliteral">&quot;\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;dGetDeltaActualTotalSediment() * m_dCellArea &lt;&lt; <span class="stringliteral">&quot;\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;dGetDeltaActualUnconsFine() * m_dCellArea &lt;&lt;  <span class="stringliteral">&quot;\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;dGetDeltaActualUnconsSand() * m_dCellArea &lt;&lt; <span class="stringliteral">&quot;\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;dGetDeltaActualUnconsCoarse() * m_dCellArea &lt;&lt; endl;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   <span class="comment">// OK, we know the potential (unconstrained) depth of erosion on each polygon, but we do not yet know the actual, supply-limited, depth. Nor do we know how much of the sediment which is to be removed is fine, sand or coarse. So next we estimate supply-limited sediment removal from each polygon, however we don&#39;t actually erode the polygon</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoast = 0; nCoast &lt; static_cast&lt;int&gt;(m_VCoast.size()); nCoast++)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;   {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nPoly = 0; nPoly &lt; m_VCoast[nCoast].nGetNumPolygons(); nPoly++)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;         <span class="comment">// Get the potential erosion on this polygon (is a depth in m)</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;         <span class="keywordtype">double</span> dSedChange = m_VCoast[nCoast].pGetPolygon(nPoly)-&gt;dGetDeltaPotentialErosion();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;         m_dThisTimestepPotentialBeachErosion -= dSedChange;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;         <span class="keywordflow">if</span> (! bFPIsEqual(dSedChange, 0, <a class="code" href="cme_8h.html#a89311a98397f9d6967d2cb10d5152d77">TOLERANCE</a>))</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;         {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="comment">// Potential erosion on this polygon is not zero, so determine actual erosion on this polygon, in sediment size categories</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="keywordtype">double</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;               dTotFineEroded = 0,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;               dTotSandEroded = 0,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;               dTotCoarseEroded = 0;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="comment">// Estimate how much we can erode on this polygon: traverse the polygon&#39;s shoreline in a down-coast direction (i.e. in the direction of increasing coastpoint indices), with profiles which are parallel to the polygon&#39;s up-coast boundary</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="comment">// NOTE also tried doing a second traverse, going up-coast, with profiles parallel to the down-coast boundary, if the down-coast routine was unable to reach its erosion target. But this second traverse almost always produced zero erosion, so seems not worth doing</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            nRet = nTraversePolygonAndEstimateBeachErosion(nCoast, nPoly, -dSedChange, dTotFineEroded, dTotSandEroded, dTotCoarseEroded);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#a71d8d6db0e41ed2022d0a95b9a70528c">RTN_OK</a>)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;               <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="comment">// Save these values</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <a class="code" href="class_c_geom_coast_polygon.html">CGeomCoastPolygon</a>* pPolygon = m_VCoast[nCoast].pGetPolygon(nPoly);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a933ae271f4fbbd54f765eb57087e76ed">SetDeltaEstimatedUnconsFine</a>(-dTotFineEroded);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a09273914c8d276d558180faabf2c1303">SetDeltaEstimatedUnconsSand</a>(-dTotSandEroded);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#ac0824d25b4cc838ea4381799cfc912de">SetDeltaEstimatedUnconsCoarse</a>(-dTotCoarseEroded);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="comment">// Save the estimated values</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            m_dThisTimestepEstimatedActualFineBeachErosion   += dTotFineEroded;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            m_dThisTimestepEstimatedActualSandBeachErosion   += dTotSandEroded;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            m_dThisTimestepEstimatedActualCoarseBeachErosion += dTotCoarseEroded;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;         }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: unconsolidated sediment transport. Before between-polygon beach sediment routing (all m^3): per-polygon supply-limited beach erosion (-ve) and deposition (+ve)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot;Note: this does not include any unconsolidated sediment from platform erosion&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot;Num \t\tGlobal\tCoast&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot;    \t\tID    \tID   \t\tTotal    \t\tFine     \tSand     \tCoarse&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   <span class="keywordtype">double</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      dCheckTotErosion = 0,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      dCheckFineErosion = 0,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      dCheckSandErosion = 0,</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      dCheckCoarseErosion = 0,</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      dCheckTotDeposition = 0,</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      dCheckFineDeposition = 0,</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      dCheckSandDeposition = 0,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      dCheckCoarseDeposition = 0;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; m_pVCoastPolygon.size(); n++)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;\t\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;nGetGlobalID() &lt;&lt; <span class="stringliteral">&quot;\t\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;nGetCoastID() &lt;&lt; <span class="stringliteral">&quot;\t\t\t&quot;</span> &lt;&lt; (m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsFine() + m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsSand() + m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsCoarse()) * m_dCellArea &lt;&lt; <span class="stringliteral">&quot;\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsFine() * m_dCellArea &lt;&lt;  <span class="stringliteral">&quot;\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsSand() * m_dCellArea &lt;&lt;  <span class="stringliteral">&quot;\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsCoarse() * m_dCellArea &lt;&lt; endl;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keywordflow">if</span> ((m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsFine() + m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsSand() + m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsCoarse()) &lt; 0)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;         dCheckTotErosion += (m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsFine() + m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsSand() + m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsCoarse());</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;         dCheckTotDeposition += (m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsFine() + m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsSand() + m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsCoarse());</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">if</span> (m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsFine() &lt; 0)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;         dCheckFineErosion += m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsFine();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;         dCheckFineDeposition += m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsFine();</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">if</span> (m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsSand() &lt; 0)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;         dCheckSandErosion += m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsSand();</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;         dCheckSandDeposition += m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsSand();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordflow">if</span> (m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsCoarse() &lt; 0)</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;         dCheckCoarseErosion += m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsCoarse();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;         dCheckCoarseDeposition += m_pVCoastPolygon[n]-&gt;dGetDeltaEstimatedUnconsCoarse();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">//    double dActualSedimentDeliveryRatio = 0;</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">//    if (dCheckTotErosion != 0)</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">//       dActualSedimentDeliveryRatio = (-dCheckTotErosion - dCheckTotDeposition) / -dCheckTotErosion;</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">//    LogStream &lt;&lt; endl &lt;&lt; m_ulIter &lt;&lt; &quot;: total supply-limited erosion = &quot; &lt;&lt; dCheckTotErosion * m_dCellArea &lt;&lt; &quot; total estimated deposition = &quot; &lt;&lt; dCheckTotDeposition * m_dCellArea &lt;&lt; &quot; (sediment delivery ratio = &quot; &lt;&lt; dActualSedimentDeliveryRatio &lt;&lt; &quot;)&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">//    LogStream &lt;&lt; m_ulIter&lt;&lt; &quot;: supply-limited fine erosion = &quot; &lt;&lt; -dCheckFineErosion * m_dCellArea &lt;&lt; &quot; estimated fine deposition = &quot; &lt;&lt; dCheckFineDeposition * m_dCellArea &lt;&lt; endl;</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">//    LogStream &lt;&lt; m_ulIter&lt;&lt; &quot;: supply-limited sand erosion = &quot; &lt;&lt; -dCheckSandErosion * m_dCellArea &lt;&lt; &quot; estimated sand deposition = &quot; &lt;&lt; dCheckSandDeposition * m_dCellArea &lt;&lt; endl;</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">//    LogStream &lt;&lt; m_ulIter&lt;&lt; &quot;: supply-limited coarse erosion = &quot; &lt;&lt; -dCheckCoarseErosion * m_dCellArea &lt;&lt; &quot; estimated coarse deposition = &quot; &lt;&lt; dCheckCoarseDeposition * m_dCellArea &lt;&lt; endl &lt;&lt; endl;;</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   <span class="comment">// Now route actually-eroded sand/coarse sediment to adjacent polygons (or off-grid)</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoast = 0; nCoast &lt; static_cast&lt;int&gt;(m_VCoast.size()); nCoast++)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="comment">// Sort first</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      vector&lt;vector&lt;int&gt; &gt; nVVPolyAndAdjacent;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">//      for (int nPoly = 0; nPoly &lt; m_VCoast[nCoast].nGetNumPolygons(); nPoly++)</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nPoly = m_VCoast[nCoast].nGetNumPolygons()-1; nPoly &gt;= 0; nPoly--)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;         <a class="code" href="class_c_geom_coast_polygon.html">CGeomCoastPolygon</a>* pPoly = m_VCoast[nCoast].pGetPolygon(nPoly);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;         vector&lt;int&gt; nVPolyAndAdj;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;         <span class="comment">// The first array item is the polygon coast ID</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;         nVPolyAndAdj.push_back(pPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#ae97ed135e92d392e9b72f83feee59b2b">nGetCoastID</a>());</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;         <span class="keywordflow">if</span> (pPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a85b82592328fd281191d00808f8d9789">bDownCoastThisTimestep</a>())</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;         {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="comment">// Sediment is leaving this polygon in a down-coast direction: so set this as the second array item</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            nVPolyAndAdj.push_back(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="comment">// Set subsequent array items to be the IDs of adjacent polygons</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nAdj = 0; nAdj &lt; pPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aa9ef391813543b0260b2174e063d80e2">nGetNumDownCoastAdjacentPolygons</a>(); nAdj++)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;               <span class="keywordtype">int</span> nAdjPolyID = pPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aa53fed4b7165494360840b7bef504a3a">nGetDownCoastAdjacentPolygon</a>(nAdj);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;               nVPolyAndAdj.push_back(nAdjPolyID);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;         }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;         {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="comment">// Sediment is leaving this polygon in an up-coast direction: so set this as the second array item</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            nVPolyAndAdj.push_back(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="comment">// Set subsequent array items to be the IDs of adjacent polygons</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nAdj = 0; nAdj &lt; pPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a6bb0df831ea85fb62da1d1df60f8c0ee">nGetNumUpCoastAdjacentPolygons</a>(); nAdj++)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;               <span class="keywordtype">int</span> nAdjPolyID = pPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a52ad4ee9d9013fd1616649e4c0cde407">nGetUpCoastAdjacentPolygon</a>(nAdj);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;               nVPolyAndAdj.push_back(nAdjPolyID);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;         }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;         nVVPolyAndAdjacent.push_back(nVPolyAndAdj);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="comment">// DEBUG CODE ======================================================</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">//       LogStream &lt;&lt; &quot;UNSORTED SEQUENCE OF POLYGON PROCESSING&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">//       for (int n = 0; n &lt; nVVPolyAndAdjacent.size(); n++)</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">//       {</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">//          for (int m = 0; m &lt; nVVPolyAndAdjacent[n].size(); m++)</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">//             LogStream &lt;&lt; nVVPolyAndAdjacent[n][m] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">//          LogStream &lt;&lt; endl;</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">//       }</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">//       LogStream &lt;&lt; endl;</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="comment">// DEBUG CODE ======================================================</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="comment">// Sort the array using bPolygonAndAdjCompare(), so that &#39;target&#39; polygons are processed after &#39;source&#39; polygons</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      stable_sort(nVVPolyAndAdjacent.begin(), nVVPolyAndAdjacent.end(), <a class="code" href="do__beach__actual__sediment__movement_8cpp.html#a0a8801fe3da215959bcf6352e5331b91">bPolygonAndAdjCompare</a>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="comment">// DEBUG CODE ======================================================</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">//       LogStream &lt;&lt; &quot;SORTED SEQUENCE OF POLYGON PROCESSING&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">//       for (int n = 0; n &lt; nVVPolyAndAdjacent.size(); n++)</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">//       {</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">//          for (int m = 0; m &lt; nVVPolyAndAdjacent[n].size(); m++)</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">//             LogStream &lt;&lt; nVVPolyAndAdjacent[n][m] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">//          LogStream &lt;&lt; endl;</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">//       }</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">//       LogStream &lt;&lt; endl;</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="comment">// DEBUG CODE ======================================================</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="comment">// Now go through the polygons in the sorted sequence</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; endl &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: unconsolidated sediment transport. Polygon-to-polygon routing (m^3)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; m_VCoast[nCoast].nGetNumPolygons(); n++)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;         <span class="comment">// And route this to adjacent polygons</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;         <span class="keywordtype">int</span> nPoly = nVVPolyAndAdjacent[n][0];</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;         nRet = nRouteActualBeachErosionToAdjacentPolygons(nCoast, nPoly);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;         <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#a71d8d6db0e41ed2022d0a95b9a70528c">RTN_OK</a>)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; endl &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: unconsolidated sediment transport. Per-polygon net erosion/deposition (m^3)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot;Note: this includes deposition of unconsolidated sediment from shore platform erosion&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot;Num \tGlobal\tCoast\t\tActual\t\tFine  \t\tSand  \t\tCoarse&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot;    \tID    \tID   \t\tTotal \t\tTotal \t\tTotal \t\tTotal&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   <span class="keywordtype">double</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      dCheckActualErosion = 0,</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      dCheckActualDeposition = 0,</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      dCheckActualFineErosion = 0,</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      dCheckActualFineDeposition = 0,</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      dCheckActualSandErosion = 0,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      dCheckActualSandDeposition = 0,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      dCheckActualCoarseErosion = 0,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      dCheckActualCoarseDeposition = 0;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; m_pVCoastPolygon.size(); n++)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;nGetGlobalID() &lt;&lt; <span class="stringliteral">&quot;\t\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;nGetCoastID() &lt;&lt; <span class="stringliteral">&quot;\t\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;dGetDeltaActualTotalSediment() * m_dCellArea &lt;&lt; <span class="stringliteral">&quot;\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;dGetDeltaActualUnconsFine() * m_dCellArea &lt;&lt;  <span class="stringliteral">&quot;\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;dGetDeltaActualUnconsSand() * m_dCellArea &lt;&lt; <span class="stringliteral">&quot;\t\t&quot;</span> &lt;&lt; m_pVCoastPolygon[n]-&gt;dGetDeltaActualUnconsCoarse() * m_dCellArea &lt;&lt; endl;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="keywordflow">if</span> (m_pVCoastPolygon[n]-&gt;dGetDeltaActualTotalSediment() &gt; 0)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;         dCheckActualDeposition += m_pVCoastPolygon[n]-&gt;dGetDeltaActualTotalSediment();</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_pVCoastPolygon[n]-&gt;dGetDeltaActualTotalSediment() &lt; 0)</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;         dCheckActualErosion += m_pVCoastPolygon[n]-&gt;dGetDeltaActualTotalSediment();</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keywordflow">if</span> (m_pVCoastPolygon[n]-&gt;dGetDeltaActualUnconsFine() &gt; 0)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;         dCheckActualFineDeposition += m_pVCoastPolygon[n]-&gt;dGetDeltaActualUnconsFine();</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_pVCoastPolygon[n]-&gt;dGetDeltaActualUnconsFine() &lt; 0)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;         dCheckActualFineErosion += m_pVCoastPolygon[n]-&gt;dGetDeltaActualUnconsFine();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordflow">if</span> (m_pVCoastPolygon[n]-&gt;dGetDeltaActualUnconsSand() &gt; 0)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;         dCheckActualSandDeposition += m_pVCoastPolygon[n]-&gt;dGetDeltaActualUnconsSand();</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_pVCoastPolygon[n]-&gt;dGetDeltaActualUnconsSand() &lt; 0)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;         dCheckActualSandErosion += m_pVCoastPolygon[n]-&gt;dGetDeltaActualUnconsSand();</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keywordflow">if</span> (m_pVCoastPolygon[n]-&gt;dGetDeltaActualUnconsCoarse() &gt; 0)</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;         dCheckActualCoarseDeposition += m_pVCoastPolygon[n]-&gt;dGetDeltaActualUnconsCoarse();</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_pVCoastPolygon[n]-&gt;dGetDeltaActualUnconsCoarse() &lt; 0)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;         dCheckActualCoarseErosion += m_pVCoastPolygon[n]-&gt;dGetDeltaActualUnconsCoarse();</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   <span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: all-polygon actual beach erosion = &quot; &lt;&lt; dCheckActualErosion * m_dCellArea &lt;&lt; &quot; all-polygon actual beach deposition = &quot; &lt;&lt; dCheckActualDeposition * m_dCellArea &lt;&lt; &quot; all-polygon actual beach loss from grid = &quot; &lt;&lt; (m_dThisTimestepActualFineSedLostBeachErosion + m_dThisTimestepActualSandSedLostBeachErosion + m_dThisTimestepActualCoarseSedLostBeachErosion) * m_dCellArea &lt;&lt; endl;</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   <span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: all-polygon fine beach erosion = &quot; &lt;&lt; dCheckActualFineErosion * m_dCellArea &lt;&lt; &quot; all-polygon actual fine beach deposition = &quot; &lt;&lt; dCheckActualFineDeposition * m_dCellArea &lt;&lt; &quot; all-polygon actual fine beach loss from grid = &quot; &lt;&lt; m_dThisTimestepActualFineSedLostBeachErosion * m_dCellArea &lt;&lt; endl;</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;   <span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: all-polygon sand beach erosion = &quot; &lt;&lt; dCheckActualSandErosion * m_dCellArea &lt;&lt; &quot; all-polygon actual sand beach deposition = &quot; &lt;&lt; dCheckActualSandDeposition * m_dCellArea &lt;&lt; &quot; all-polygon actual sand beach loss from grid = &quot; &lt;&lt; m_dThisTimestepActualSandSedLostBeachErosion * m_dCellArea &lt;&lt; endl;</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   <span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: all-polygon coarse beach erosion = &quot; &lt;&lt; dCheckActualCoarseErosion * m_dCellArea &lt;&lt; &quot; all-polygon actual coarse beach deposition = &quot; &lt;&lt; dCheckActualCoarseDeposition * m_dCellArea &lt;&lt; &quot; all-polygon actual coarse beach loss from grid = &quot; &lt;&lt; m_dThisTimestepActualCoarseSedLostBeachErosion * m_dCellArea &lt;&lt; endl &lt;&lt; endl;</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   <span class="comment">// We have an actual sediment budget, in sediment size categories, for all polygons: so process all polygons. First do polygons with net erosion</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoast = 0; nCoast &lt; static_cast&lt;int&gt;(m_VCoast.size()); nCoast++)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordtype">int</span> nNumPolygons = m_VCoast[nCoast].nGetNumPolygons();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nPoly = 0; nPoly &lt; m_VCoast[nCoast].nGetNumPolygons(); nPoly++)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;         <span class="comment">// Get the depth of sediment to be redistributed on this polygon. Is a depth in m: -ve for erosion, +ve for deposition</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;         <span class="keywordtype">double</span> dSedChange = m_VCoast[nCoast].pGetPolygon(nPoly)-&gt;dGetDeltaActualTotalSediment();</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="cme_8h.html#ae3b6dc50cfc97050529faa5e0bd66136">tAbs</a>(dSedChange) &lt; <a class="code" href="cme_8h.html#ab63e5883f26dfad0f0c3b7cccce87c71">SEDIMENT_ELEV_TOLERANCE</a>)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;         {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="comment">// Do nothing for tiny amounts</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot; has no change in unconsolidated sediment&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;         }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;         <span class="keywordflow">if</span> (dSedChange &lt; 0)</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;         {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="comment">// Net erosion on this polygon, so calculate a net decrease in depth of unconsolidated sediment (fine, sand, coarse) on the cells within the polygon. Note however that some cells may gain in elevation (i.e. have some unconsolidated sediment deposition)</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keywordtype">double</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;               dFineError = 0,</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;               dSandError = 0,</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;               dCoarseError = 0;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            nRet = nDoBeachErosionOnPolygon(nCoast, nPoly, -dSedChange, dFineError, dSandError, dCoarseError);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#a71d8d6db0e41ed2022d0a95b9a70528c">RTN_OK</a>)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;               <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <span class="keywordflow">if</span> ((dFineError + dSandError + dCoarseError) != 0)</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">//                LogStream &lt;&lt; &quot;dFineError = &quot; &lt;&lt; -dFineError &lt;&lt; &quot; dSandError = &quot; &lt;&lt; -dSandError&lt;&lt; &quot; dCoarseError = &quot; &lt;&lt; -dCoarseError &lt;&lt; endl;</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;               <a class="code" href="class_c_geom_coast_polygon.html">CGeomCoastPolygon</a>* pPolygon = m_VCoast[nCoast].pGetPolygon(nPoly);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;               <span class="keywordflow">if</span> (pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a85b82592328fd281191d00808f8d9789">bDownCoastThisTimestep</a>())</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;               {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                  <span class="comment">// Moving eroded sediment down-coast</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                  <span class="keywordtype">int</span> nNumAdjPoly = pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aa9ef391813543b0260b2174e063d80e2">nGetNumDownCoastAdjacentPolygons</a>();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                  <span class="keywordtype">double</span> dCheckTotal = 0;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nNumAdjPoly; n++)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                  {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                     <span class="keywordtype">int</span> nAdjPoly = pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aa53fed4b7165494360840b7bef504a3a">nGetDownCoastAdjacentPolygon</a>(n);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                     <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot; moves sediment down-coast to polygon &quot;</span> &lt;&lt; nAdjPoly &lt;&lt; endl;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                     <span class="keywordflow">if</span> (nAdjPoly == <a class="code" href="cme_8h.html#aee2e0742555937187504ee86b95bc29c">INT_NODATA</a>)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                     {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                        <span class="comment">// This polygon is at the grid edge</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                        <span class="keywordflow">if</span> (nPoly == 0)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                        {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                           <span class="comment">// This is the polygon at the up-coast end of the coastline: uncons sediment movement is down-coast but there is no adjacent polygon!</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                           <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; <a class="code" href="cme_8h.html#ab0094f1ece3facf8eb8afd210a7a7835">ERR</a> &lt;&lt; <span class="stringliteral">&quot;when adjusting sediment export. Polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot; is at the up-coast end of the coastline, actual sediment movement is DOWN-COAST. But there is no adjacent coast-end polygon!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nPoly == nNumPolygons-1)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                        {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                           <span class="comment">// This is the polygon at the down-coast end of the coastline, and uncons sediment movement is down-coast. Decide what to do based on the user setting m_nUnconsSedimentHandlingAtGridEdges</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                           <span class="keywordflow">if</span> (m_nUnconsSedimentHandlingAtGridEdges == <a class="code" href="cme_8h.html#a6200ae183b054ee5f56256c5adcf2bd8">GRID_EDGE_CLOSED</a>)</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                           {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                              <span class="comment">// Closed grid edges: no uncons sediment moves off-grid, nothing is removed from this polygon, so cannot adjust sediment export</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                              <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: when adjusting sediment export, polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot; is at the down-coast end of the coastline, and actual sediment movement is DOWN-COAST. Since grid edges are closed, no sand or coarse unconsolidated sediment goes off-grid so cannot adjust sediment export&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                           }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_nUnconsSedimentHandlingAtGridEdges == <a class="code" href="cme_8h.html#a175a581d557d1d54a477be9e2cb75759">GRID_EDGE_OPEN</a>)</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                           {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                              <span class="comment">// Open grid edges, so this sediment goes off-grid</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                              <span class="keywordflow">if</span> (dFineError != 0)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                              {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                                 m_dThisTimestepActualFineSedLostBeachErosion -= dFineError;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                 m_dThisTimestepMassBalanceErosionError -= dFineError;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                                 dCheckTotal += dFineError;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                              }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                              <span class="keywordflow">if</span> (dSandError != 0)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                              {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                 m_dThisTimestepActualSandSedLostBeachErosion += dSandError;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                                 m_dThisTimestepMassBalanceErosionError -= dSandError;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                 dCheckTotal += dSandError;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                              }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                              <span class="keywordflow">if</span> (dCoarseError != 0)</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                              {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                                 m_dThisTimestepActualCoarseSedLostBeachErosion += dCoarseError;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                                 m_dThisTimestepMassBalanceErosionError -= dCoarseError;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                 dCheckTotal += dCoarseError;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                              }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                           }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_nUnconsSedimentHandlingAtGridEdges == <a class="code" href="cme_8h.html#a409c1bddc62b57c4c20f804212dac0e2">GRID_EDGE_RECIRCULATE</a>)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                           {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                              <span class="comment">// Re-circulating grid edges, so adjust the sediment exported to the polygon at the up-coast end of this coastline TODO Check whether this causes mass balance problems, depending on the sequence of polygon processing</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                              <span class="keywordtype">int</span> nOtherEndPoly = 0;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                              <a class="code" href="class_c_geom_coast_polygon.html">CGeomCoastPolygon</a>* pOtherEndPoly = m_VCoast[nCoast].pGetPolygon(nOtherEndPoly);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                              <span class="keywordflow">if</span> (dFineError != 0)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                              {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                                 pOtherEndPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a436b956d1e85378508b619263a62ee35">AddDeltaActualUnconsFine</a>(-dFineError);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                                 m_dThisTimestepActualFineSedLostBeachErosion -= dFineError;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                                 m_dThisTimestepMassBalanceErosionError -= dFineError;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                                 dCheckTotal += dFineError;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                              }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                              <span class="keywordflow">if</span> (dSandError != 0)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                              {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                                 pOtherEndPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a39ab4be5fcc324eba92db69597e31b42">AddDeltaActualUnconsSand</a>(-dSandError);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                 m_dThisTimestepActualSandSedLostBeachErosion -= dSandError;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                                 m_dThisTimestepMassBalanceErosionError -= dSandError;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                 dCheckTotal += dSandError;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                              }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                              <span class="keywordflow">if</span> (dCoarseError != 0)</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                              {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                                 pOtherEndPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aab2739774232953d4f7ae3c9f77ac206">AddDeltaActualUnconsCoarse</a>(-dCoarseError);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                                 m_dThisTimestepActualCoarseSedLostBeachErosion -= dCoarseError;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                 m_dThisTimestepMassBalanceErosionError -= dCoarseError;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                                 dCheckTotal += dCoarseError;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                              }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                           }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                        }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                     }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                     <span class="keywordflow">else</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                     {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                        <span class="comment">// This polygon is not at the grid edge</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                        <a class="code" href="class_c_geom_coast_polygon.html">CGeomCoastPolygon</a>* pAdjPolygon = m_VCoast[nCoast].pGetPolygon(nAdjPoly);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                        <span class="keywordtype">double</span> dBoundaryShare = pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a82b0f745264c8783d883afe5f9b15deb">dGetDownCoastAdjacentPolygonBoundaryShare</a>(n);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                        <span class="keywordflow">if</span> (dFineError != 0)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                        {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                           <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: on polygon &quot;</span> &lt;&lt; nAdjPoly &lt;&lt; <span class="stringliteral">&quot;, dDeltaFine was = &quot;</span> &lt;&lt; pAdjPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a27f100b224c73c609ed36e89bfb2188d">dGetDeltaActualUnconsFine</a>() &lt;&lt; <span class="stringliteral">&quot; m_dThisTimestepMassBalanceErosionError WAS = &quot;</span> &lt;&lt; m_dThisTimestepMassBalanceErosionError;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                           pAdjPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a436b956d1e85378508b619263a62ee35">AddDeltaActualUnconsFine</a>(-dFineError * dBoundaryShare);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                           m_dThisTimestepMassBalanceErosionError -= (dFineError * dBoundaryShare);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                           <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot; dDeltaFine NOW = &quot;</span> &lt;&lt; pAdjPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a27f100b224c73c609ed36e89bfb2188d">dGetDeltaActualUnconsFine</a>() &lt;&lt; <span class="stringliteral">&quot; m_dThisTimestepMassBalanceErosionError = &quot;</span> &lt;&lt; m_dThisTimestepMassBalanceErosionError &lt;&lt; endl;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                           dCheckTotal += (dFineError * dBoundaryShare);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                        }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                        <span class="keywordflow">if</span> (dSandError != 0)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                        {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                           <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: on polygon &quot;</span> &lt;&lt; nAdjPoly &lt;&lt; <span class="stringliteral">&quot;, dDeltaSand was = &quot;</span> &lt;&lt; pAdjPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#ae6f4df07e5e732fe2b82a361c2ddbf5b">dGetDeltaActualUnconsSand</a>() &lt;&lt; <span class="stringliteral">&quot; m_dThisTimestepMassBalanceErosionError WAS = &quot;</span> &lt;&lt; m_dThisTimestepMassBalanceErosionError;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                           pAdjPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a39ab4be5fcc324eba92db69597e31b42">AddDeltaActualUnconsSand</a>(-dSandError * dBoundaryShare);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                           m_dThisTimestepMassBalanceErosionError -= (dSandError * dBoundaryShare);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                           <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot; dDeltaSand NOW = &quot;</span> &lt;&lt; pAdjPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#ae6f4df07e5e732fe2b82a361c2ddbf5b">dGetDeltaActualUnconsSand</a>() &lt;&lt; <span class="stringliteral">&quot; m_dThisTimestepMassBalanceErosionError = &quot;</span> &lt;&lt; m_dThisTimestepMassBalanceErosionError &lt;&lt; endl;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                           dCheckTotal += (dSandError * dBoundaryShare);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                        }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                        <span class="keywordflow">if</span> (dCoarseError != 0)</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                        {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                           <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: on polygon &quot;</span> &lt;&lt; nAdjPoly &lt;&lt; <span class="stringliteral">&quot;, dDeltaCoarse was = &quot;</span> &lt;&lt; pAdjPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#af4f5f84ba32c7a53cfb64d1a03a89bf7">dGetDeltaActualUnconsCoarse</a>() &lt;&lt; <span class="stringliteral">&quot; m_dThisTimestepMassBalanceErosionError WAS = &quot;</span> &lt;&lt; m_dThisTimestepMassBalanceErosionError;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                           pAdjPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aab2739774232953d4f7ae3c9f77ac206">AddDeltaActualUnconsCoarse</a>(-dCoarseError * dBoundaryShare);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                           m_dThisTimestepMassBalanceErosionError -= (dCoarseError * dBoundaryShare);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                           <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot; dDeltaCoarse NOW = &quot;</span> &lt;&lt; pAdjPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#af4f5f84ba32c7a53cfb64d1a03a89bf7">dGetDeltaActualUnconsCoarse</a>() &lt;&lt; <span class="stringliteral">&quot; m_dThisTimestepMassBalanceErosionError = &quot;</span> &lt;&lt; m_dThisTimestepMassBalanceErosionError &lt;&lt; endl;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                           dCheckTotal += (dCoarseError * dBoundaryShare);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                        }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                     }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                  }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                  <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot;dCheckTotal = &quot;</span> &lt;&lt; dCheckTotal &lt;&lt; <span class="stringliteral">&quot; dFineError = &quot;</span> &lt;&lt; dFineError &lt;&lt; <span class="stringliteral">&quot; dSandError = &quot;</span> &lt;&lt; dSandError &lt;&lt; <span class="stringliteral">&quot; dCoarse Error = &quot;</span> &lt;&lt; dCoarseError &lt;&lt; endl;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;               }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;               <span class="keywordflow">else</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;               {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                  <span class="comment">// Moving eroded sediment up-coast</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                  <span class="keywordtype">int</span> nNumAdjPoly = pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a6bb0df831ea85fb62da1d1df60f8c0ee">nGetNumUpCoastAdjacentPolygons</a>();</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                  <span class="keywordtype">double</span> dCheckTotal = 0;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nNumAdjPoly; n++)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                  {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                     <span class="keywordtype">int</span> nAdjPoly = pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a52ad4ee9d9013fd1616649e4c0cde407">nGetUpCoastAdjacentPolygon</a>(n);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                     <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot; moves sediment up-coast to polygon &quot;</span> &lt;&lt; nAdjPoly &lt;&lt; endl;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                     <span class="keywordflow">if</span> (nAdjPoly == <a class="code" href="cme_8h.html#aee2e0742555937187504ee86b95bc29c">INT_NODATA</a>)</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                     {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                        <span class="comment">// This polygon is at the grid edge</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                        <span class="keywordflow">if</span> (nPoly == nNumPolygons-1)</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                        {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                           <span class="comment">// This is the polygon at the down-coast end of the coastline: uncons sediment movement is up-coast but there is no adjacent polygon!</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                           <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; <a class="code" href="cme_8h.html#ab0094f1ece3facf8eb8afd210a7a7835">ERR</a> &lt;&lt; <span class="stringliteral">&quot;when adjusting sediment export. Polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot; is at the down-coast end of the coastline, actual sediment movement is UP-COAST. But there is no adjacent coast-end polygon!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                        }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nPoly == 0)</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                        {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                           <span class="comment">// This is the polygon at the up-coast end of the coastline, and uncons sediment movement is up-coast. Decide what to do based on the user setting m_nUnconsSedimentHandlingAtGridEdges</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                           <span class="keywordflow">if</span> (m_nUnconsSedimentHandlingAtGridEdges == <a class="code" href="cme_8h.html#a6200ae183b054ee5f56256c5adcf2bd8">GRID_EDGE_CLOSED</a>)</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                           {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                              <span class="comment">// Closed grid edges: no uncons sediment moves off-grid, nothing is removed from this polygon, so cannot adjust sediment export</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                              <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: when adjusting sediment export, polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot; is at the up-coast end of the coastline, and actual sediment movement is UP-COAST. Since grid edges are closed, no sand or coarse unconsolidated sediment goes off-grid so cannot adjust sediment export&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                           }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_nUnconsSedimentHandlingAtGridEdges == <a class="code" href="cme_8h.html#a175a581d557d1d54a477be9e2cb75759">GRID_EDGE_OPEN</a>)</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                           {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                              <span class="comment">// Open grid edges, so this sediment goes off-grid</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                              <span class="keywordflow">if</span> (dFineError != 0)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                              {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                                 m_dThisTimestepActualFineSedLostBeachErosion -= dFineError;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                 m_dThisTimestepMassBalanceErosionError -= dFineError;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                 dCheckTotal += dFineError;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                              }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                              <span class="keywordflow">if</span> (dSandError != 0)</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                              {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                 m_dThisTimestepActualSandSedLostBeachErosion += dSandError;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                                 m_dThisTimestepMassBalanceErosionError -= dSandError;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                                 dCheckTotal += dSandError;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                              }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                              <span class="keywordflow">if</span> (dCoarseError != 0)</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                              {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                 m_dThisTimestepActualCoarseSedLostBeachErosion += dCoarseError;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                 m_dThisTimestepMassBalanceErosionError -= dCoarseError;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                                 dCheckTotal += dCoarseError;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                              }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                           }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_nUnconsSedimentHandlingAtGridEdges == <a class="code" href="cme_8h.html#a409c1bddc62b57c4c20f804212dac0e2">GRID_EDGE_RECIRCULATE</a>)</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                           {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                              <span class="comment">// Re-circulating grid edges, so adjust the sediment exported to the polygon at the up-coast end of this coastline TODO Check whether this causes mass balance problems, depending on the sequence of polygon processing</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                              <span class="keywordtype">int</span> nOtherEndPoly = 0;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                              <a class="code" href="class_c_geom_coast_polygon.html">CGeomCoastPolygon</a>* pOtherEndPoly = m_VCoast[nCoast].pGetPolygon(nOtherEndPoly);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                              <span class="keywordflow">if</span> (dFineError != 0)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                              {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                                 pOtherEndPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a436b956d1e85378508b619263a62ee35">AddDeltaActualUnconsFine</a>(-dFineError);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                                 m_dThisTimestepActualFineSedLostBeachErosion -= dFineError;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                                 m_dThisTimestepMassBalanceErosionError -= dFineError;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                 dCheckTotal += dFineError;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                              }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                              <span class="keywordflow">if</span> (dSandError != 0)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                              {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                                 pOtherEndPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a39ab4be5fcc324eba92db69597e31b42">AddDeltaActualUnconsSand</a>(-dSandError);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                                 m_dThisTimestepActualSandSedLostBeachErosion -= dSandError;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                                 m_dThisTimestepMassBalanceErosionError -= dSandError;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                                 dCheckTotal += dSandError;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                              }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                              <span class="keywordflow">if</span> (dCoarseError != 0)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                              {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                 pOtherEndPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aab2739774232953d4f7ae3c9f77ac206">AddDeltaActualUnconsCoarse</a>(-dCoarseError);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                 m_dThisTimestepActualCoarseSedLostBeachErosion -= dCoarseError;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                                 m_dThisTimestepMassBalanceErosionError -= dCoarseError;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                                 dCheckTotal += dCoarseError;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                              }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                           }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                        }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                     }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                     <span class="keywordflow">else</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                     {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                        <span class="comment">// This polygon is not at the grid edge</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                        <a class="code" href="class_c_geom_coast_polygon.html">CGeomCoastPolygon</a>* pAdjPolygon = m_VCoast[nCoast].pGetPolygon(nAdjPoly);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                        <span class="keywordtype">double</span> dBoundaryShare = pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a4d40ff07551c2cf1a5404f6ec391a97a">dGetUpCoastAdjacentPolygonBoundaryShare</a>(n);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                        <span class="keywordflow">if</span> (dFineError != 0)</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                        {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                           <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: on polygon &quot;</span> &lt;&lt; nAdjPoly &lt;&lt; <span class="stringliteral">&quot;, dDeltaFine was = &quot;</span> &lt;&lt; pAdjPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a27f100b224c73c609ed36e89bfb2188d">dGetDeltaActualUnconsFine</a>() &lt;&lt; <span class="stringliteral">&quot; m_dThisTimestepMassBalanceErosionError WAS = &quot;</span> &lt;&lt; m_dThisTimestepMassBalanceErosionError;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                           pAdjPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a436b956d1e85378508b619263a62ee35">AddDeltaActualUnconsFine</a>(-dFineError * dBoundaryShare);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                           m_dThisTimestepMassBalanceErosionError -= (dFineError * dBoundaryShare);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                           <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot; dDeltaFine NOW = &quot;</span> &lt;&lt; pAdjPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a27f100b224c73c609ed36e89bfb2188d">dGetDeltaActualUnconsFine</a>() &lt;&lt; <span class="stringliteral">&quot; m_dThisTimestepMassBalanceErosionError = &quot;</span> &lt;&lt; m_dThisTimestepMassBalanceErosionError &lt;&lt; endl;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                           dCheckTotal += (dFineError * dBoundaryShare);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                        }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                        <span class="keywordflow">if</span> (dSandError != 0)</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                        {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                           <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: on polygon &quot;</span> &lt;&lt; nAdjPoly &lt;&lt; <span class="stringliteral">&quot;, dDeltaSand was = &quot;</span> &lt;&lt; pAdjPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#ae6f4df07e5e732fe2b82a361c2ddbf5b">dGetDeltaActualUnconsSand</a>() &lt;&lt; <span class="stringliteral">&quot; m_dThisTimestepMassBalanceErosionError WAS = &quot;</span> &lt;&lt; m_dThisTimestepMassBalanceErosionError;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                           pAdjPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a39ab4be5fcc324eba92db69597e31b42">AddDeltaActualUnconsSand</a>(-dSandError * dBoundaryShare);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                           m_dThisTimestepMassBalanceErosionError -= (dSandError * dBoundaryShare);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                           <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot; dDeltaSand NOW = &quot;</span> &lt;&lt; pAdjPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#ae6f4df07e5e732fe2b82a361c2ddbf5b">dGetDeltaActualUnconsSand</a>() &lt;&lt; <span class="stringliteral">&quot; m_dThisTimestepMassBalanceErosionError = &quot;</span> &lt;&lt; m_dThisTimestepMassBalanceErosionError &lt;&lt; endl;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                           dCheckTotal += (dSandError * dBoundaryShare);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                        }</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                        <span class="keywordflow">if</span> (dCoarseError != 0)</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                        {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                           <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: on polygon &quot;</span> &lt;&lt; nAdjPoly &lt;&lt; <span class="stringliteral">&quot;, dDeltaCoarse was = &quot;</span> &lt;&lt; pAdjPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#af4f5f84ba32c7a53cfb64d1a03a89bf7">dGetDeltaActualUnconsCoarse</a>() &lt;&lt; <span class="stringliteral">&quot; m_dThisTimestepMassBalanceErosionError WAS = &quot;</span> &lt;&lt; m_dThisTimestepMassBalanceErosionError;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                           pAdjPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aab2739774232953d4f7ae3c9f77ac206">AddDeltaActualUnconsCoarse</a>(-dCoarseError * dBoundaryShare);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                           m_dThisTimestepMassBalanceErosionError -= (dCoarseError * dBoundaryShare);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                           <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot; dDeltaCoarse NOW = &quot;</span> &lt;&lt; pAdjPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#af4f5f84ba32c7a53cfb64d1a03a89bf7">dGetDeltaActualUnconsCoarse</a>() &lt;&lt; <span class="stringliteral">&quot; m_dThisTimestepMassBalanceErosionError = &quot;</span> &lt;&lt; m_dThisTimestepMassBalanceErosionError &lt;&lt; endl;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                           dCheckTotal += (dCoarseError * dBoundaryShare);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                        }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                     }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                  }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                  <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot;dCheckTotal = &quot;</span> &lt;&lt; dCheckTotal &lt;&lt; <span class="stringliteral">&quot; dFineError = &quot;</span> &lt;&lt; dFineError &lt;&lt; <span class="stringliteral">&quot; dSandError = &quot;</span> &lt;&lt; dSandError &lt;&lt; <span class="stringliteral">&quot; dCoarse Error = &quot;</span> &lt;&lt; dCoarseError &lt;&lt; endl;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;               }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;         }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;   <span class="comment">// Now do polygons with net deposition</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoast = 0; nCoast &lt; static_cast&lt;int&gt;(m_VCoast.size()); nCoast++)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nPoly = 0; nPoly &lt; m_VCoast[nCoast].nGetNumPolygons(); nPoly++)</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;         <span class="comment">// Get the depth of sediment to be redistributed on this polygon. Is a depth in m: -ve for erosion, +ve for deposition</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;         <span class="keywordtype">double</span> dSedChange = m_VCoast[nCoast].pGetPolygon(nPoly)-&gt;dGetDeltaActualTotalSediment();</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="cme_8h.html#ae3b6dc50cfc97050529faa5e0bd66136">tAbs</a>(dSedChange) &lt; <a class="code" href="cme_8h.html#ab63e5883f26dfad0f0c3b7cccce87c71">SEDIMENT_ELEV_TOLERANCE</a>)</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;         {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="comment">// Do nothing for tiny amounts</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot; has no change in unconsolidated sediment&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;         }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;         <span class="keywordflow">if</span> (dSedChange &gt; 0)</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;         {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            <span class="comment">// Net deposition on this polygon: we will be depositing sand and coarse sediment</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            dSedChange = m_VCoast[nCoast].pGetPolygon(nPoly)-&gt;dGetDeltaActualUnconsSand() + m_VCoast[nCoast].pGetPolygon(nPoly)-&gt;dGetDeltaActualUnconsCoarse();</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="comment">// Calculate a net increase in depth of unconsolidated sediment on the cells within the polygon by depositing fine and sand. Note that some cells may decrease in elevation (i.e. have some unconsolidated sediment erosion) however</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            nRet = nDoBeachDepositionOnPolygon(nCoast, nPoly, dSedChange);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            <span class="keywordflow">if</span> (nRet != <a class="code" href="cme_8h.html#a71d8d6db0e41ed2022d0a95b9a70528c">RTN_OK</a>)</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;               <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;         }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;   }</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="cme_8h.html#a71d8d6db0e41ed2022d0a95b9a70528c">RTN_OK</a>;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;}</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">/*===============================================================================================================================</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment"> Distribute the change in actual (supply-limited) unconsolidated beach sediment from this polygon to adjacent polygons</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">===============================================================================================================================*/</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="keywordtype">int</span> CSimulation::nRouteActualBeachErosionToAdjacentPolygons(<span class="keywordtype">int</span> <span class="keyword">const</span> nCoast, <span class="keywordtype">int</span> <span class="keyword">const</span> nPoly)</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;{</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;   <span class="keywordtype">int</span> nNumPolygons = m_VCoast[nCoast].nGetNumPolygons() ;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;   <a class="code" href="class_c_geom_coast_polygon.html">CGeomCoastPolygon</a>* pPolygon = m_VCoast[nCoast].pGetPolygon(nPoly);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;   <span class="keywordtype">double</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      dTotFineEroded = 0,</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      dTotSandEroded = 0,</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      dTotCoarseEroded = 0,</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      dTotFineToPoly = 0,</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      dTotSandToPoly = 0,</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      dTotCoarseToPoly = 0;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;   <span class="comment">// &#39;Actual&#39; includes sediment from platform erosion and cliff collapse, &#39;estimated&#39; was estimated in nEstimateBeachErosionOnPolygon()</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;   <span class="keywordtype">double</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      dTotFineChange = pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aba136d4cea6530fef743214da1c177c0">dGetDeltaEstimatedUnconsFine</a>() + pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a27f100b224c73c609ed36e89bfb2188d">dGetDeltaActualUnconsFine</a>(),</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      dTotSandChange = pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a1f1ec023bc3fcbf57af6ec4aa5738cd0">dGetDeltaEstimatedUnconsSand</a>() + pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#ae6f4df07e5e732fe2b82a361c2ddbf5b">dGetDeltaActualUnconsSand</a>(),</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      dTotCoarseChange = pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a012684fc9e6cda15517c1996f5e8f45e">dGetDeltaEstimatedUnconsCoarse</a>() + pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#af4f5f84ba32c7a53cfb64d1a03a89bf7">dGetDeltaActualUnconsCoarse</a>();</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: polygon &quot; &lt;&lt; nPoly &lt;&lt; &quot; has actual delta unconsolidated sediment (from platform erosion and cliff collapse): fine = &quot; &lt;&lt; pPolygon-&gt;dGetDeltaActualUnconsFine() &lt;&lt; &quot; sand = &quot; &lt;&lt; pPolygon-&gt;dGetDeltaActualUnconsSand() &lt;&lt; &quot; coarse = &quot; &lt;&lt; pPolygon-&gt;dGetDeltaActualUnconsCoarse() &lt;&lt; &quot; TOTAL = &quot; &lt;&lt; pPolygon-&gt;dGetDeltaActualUnconsFine() + pPolygon-&gt;dGetDeltaActualUnconsSand() + pPolygon-&gt;dGetDeltaActualUnconsCoarse() &lt;&lt; endl;</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: polygon &quot; &lt;&lt; nPoly &lt;&lt; &quot; has estimated delta unconsolidated sediment (from beach erosion): fine = &quot; &lt;&lt; pPolygon-&gt;dGetDeltaEstimatedUnconsFine() &lt;&lt; &quot; sand = &quot; &lt;&lt; pPolygon-&gt;dGetDeltaEstimatedUnconsSand() &lt;&lt; &quot; coarse = &quot; &lt;&lt; pPolygon-&gt;dGetDeltaEstimatedUnconsCoarse() &lt;&lt; &quot; TOTAL = &quot; &lt;&lt; pPolygon-&gt;dGetDeltaEstimatedUnconsFine() + pPolygon-&gt;dGetDeltaEstimatedUnconsSand() + pPolygon-&gt;dGetDeltaEstimatedUnconsCoarse() &lt;&lt; &quot; (potential erosion = &quot; &lt;&lt; -pPolygon-&gt;dGetDeltaPotentialErosion() &lt;&lt; &quot;)&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: polygon &quot; &lt;&lt; nPoly &lt;&lt; &quot; has total delta unconsolidated sediment (actual plus estimated): fine = &quot; &lt;&lt; dTotFineChange &lt;&lt; &quot; sand = &quot; &lt;&lt; dTotSandChange &lt;&lt; &quot; coarse = &quot; &lt;&lt; dTotCoarseChange &lt;&lt; &quot; TOTAL = &quot; &lt;&lt; dTotFineChange + dTotSandChange + dTotCoarseChange &lt;&lt; endl;</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;   <span class="comment">// If any of these total change values are +ve, it means deposition on this polygon. So ignore these values in terms of routing sediment off this polygon</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;   <span class="keywordflow">if</span> (dTotFineChange &lt; 0)</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      dTotFineEroded = -dTotFineChange;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;   <span class="keywordflow">if</span> (dTotSandChange &lt; 0)</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      dTotSandEroded = -dTotSandChange;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;   <span class="keywordflow">if</span> (dTotCoarseChange &lt; 0)</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      dTotCoarseEroded = -dTotCoarseChange;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: dTotFineEroded = &quot; &lt;&lt; dTotFineEroded &lt;&lt; &quot; dTotSandEroded = &quot; &lt;&lt; dTotSandEroded &lt;&lt; &quot; dTotCoarseEroded = &quot; &lt;&lt; dTotCoarseEroded &lt;&lt; endl;</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;   <span class="comment">// Now calculate actual unconsolidated sediment movement to adjacent polygons</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;   <span class="keywordflow">if</span> (pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a85b82592328fd281191d00808f8d9789">bDownCoastThisTimestep</a>())</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;   {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="comment">// Moving eroded sediment down-coast</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <span class="keywordtype">int</span> nNumAdjPoly = pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aa9ef391813543b0260b2174e063d80e2">nGetNumDownCoastAdjacentPolygons</a>();</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nNumAdjPoly; n++)</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;         <span class="keywordtype">int</span> nAdjPoly = pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aa53fed4b7165494360840b7bef504a3a">nGetDownCoastAdjacentPolygon</a>(n);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;         <span class="keywordtype">double</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            dBoundaryShare = pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a82b0f745264c8783d883afe5f9b15deb">dGetDownCoastAdjacentPolygonBoundaryShare</a>(n),</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            dFineToPoly = dTotFineEroded * dBoundaryShare,</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            dSandToPoly = dTotSandEroded * dBoundaryShare,</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            dCoarseToPoly = dTotCoarseEroded * dBoundaryShare;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;         dTotFineToPoly += dFineToPoly;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;         dTotSandToPoly += dSandToPoly;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;         dTotCoarseToPoly += dCoarseToPoly;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;         <span class="keywordflow">if</span> (nAdjPoly == <a class="code" href="cme_8h.html#aee2e0742555937187504ee86b95bc29c">INT_NODATA</a>)</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;         {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            <span class="keywordflow">if</span> (nPoly == 0)</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;               <span class="comment">// This is the polygon at the up-coast end of the coastline: uncons sediment movement is down-coast but there is no adjacent polygon!</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;               <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter&lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; <a class="code" href="cme_8h.html#ab0094f1ece3facf8eb8afd210a7a7835">ERR</a> &lt;&lt; <span class="stringliteral">&quot;polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot; is at the up-coast end of the coastline, actual sediment movement is DOWN-COAST. But there is no adjacent coast-end polygon!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">//                return RTN_ERR_NO_ADJACENT_POLYGON;</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nPoly == nNumPolygons-1)</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            {</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;               <span class="comment">// TEST DFM  Could make this a user option: add in uncons sediment at end of coastline, however need to make further changes to keep maintain mass balance</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">//                pPolygon-&gt;AddDeltaActualUnconsSand(1);</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;               <span class="comment">// This is the polygon at the down-coast end of the coastline, and uncons sediment movement is down-coast. Decide what to do based on the user setting m_nUnconsSedimentHandlingAtGridEdges</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;               <span class="keywordflow">if</span> (m_nUnconsSedimentHandlingAtGridEdges == <a class="code" href="cme_8h.html#a6200ae183b054ee5f56256c5adcf2bd8">GRID_EDGE_CLOSED</a>)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;               {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                  <span class="comment">// Closed grid edges: no uncons sediment moves off-grid, nothing is removed from this polygon</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                  <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot; is at the down-coast end of the coastline, actual sediment movement is DOWN-COAST. With closed grid edges, no sand or coarse unconsolidated sediment goes off-grid&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;               }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_nUnconsSedimentHandlingAtGridEdges == <a class="code" href="cme_8h.html#a175a581d557d1d54a477be9e2cb75759">GRID_EDGE_OPEN</a>)</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;               {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                  <span class="comment">// Open grid edges, so this sediment goes off-grid</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                  m_dThisTimestepActualFineSedLostBeachErosion += dFineToPoly;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                  m_dThisTimestepActualSandSedLostBeachErosion += dSandToPoly;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                  m_dThisTimestepActualCoarseSedLostBeachErosion += dCoarseToPoly;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                  <span class="comment">// Remove the sediment from this polygon</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                  pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a436b956d1e85378508b619263a62ee35">AddDeltaActualUnconsFine</a>(-dTotFineToPoly);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                  pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a39ab4be5fcc324eba92db69597e31b42">AddDeltaActualUnconsSand</a>(-dTotSandToPoly);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                  pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aab2739774232953d4f7ae3c9f77ac206">AddDeltaActualUnconsCoarse</a>(-dTotCoarseToPoly);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                  <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot; is at the down-coast end of the coastline, actual sediment movement is DOWN-COAST. With open grid edges, sediment goes off-grid: fine = &quot;</span> &lt;&lt; dFineToPoly &lt;&lt; <span class="stringliteral">&quot; sand = &quot;</span> &lt;&lt; dSandToPoly &lt;&lt; <span class="stringliteral">&quot; coarse = &quot;</span> &lt;&lt; dCoarseToPoly &lt;&lt; endl;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;               }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_nUnconsSedimentHandlingAtGridEdges == <a class="code" href="cme_8h.html#a409c1bddc62b57c4c20f804212dac0e2">GRID_EDGE_RECIRCULATE</a>)</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;               {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                  <span class="comment">// Re-circulating grid edges, so send the sediment to the polygon at the up-coast end of this coastline TODO Check whether this causes mass balance problems, depending on the sequence of polygon processing</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                  <span class="keywordtype">int</span> nOtherEndPoly = 0;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                  <a class="code" href="class_c_geom_coast_polygon.html">CGeomCoastPolygon</a>* pOtherEndPoly = m_VCoast[nCoast].pGetPolygon(nOtherEndPoly);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                  pOtherEndPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a436b956d1e85378508b619263a62ee35">AddDeltaActualUnconsFine</a>(dFineToPoly);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                  pOtherEndPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a39ab4be5fcc324eba92db69597e31b42">AddDeltaActualUnconsSand</a>(dSandToPoly);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                  pOtherEndPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aab2739774232953d4f7ae3c9f77ac206">AddDeltaActualUnconsCoarse</a>(dCoarseToPoly);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                  <span class="comment">// Add to the off-grid totals even tho&#39; it is not really moving off-grid</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                  m_dThisTimestepActualFineSedLostBeachErosion += dFineToPoly;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                  m_dThisTimestepActualSandSedLostBeachErosion += dSandToPoly;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                  m_dThisTimestepActualCoarseSedLostBeachErosion += dCoarseToPoly;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                  <span class="comment">// And remove the sediment from this polygon</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                  pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a436b956d1e85378508b619263a62ee35">AddDeltaActualUnconsFine</a>(-dTotFineToPoly);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                  pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a39ab4be5fcc324eba92db69597e31b42">AddDeltaActualUnconsSand</a>(-dTotSandToPoly);</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                  pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aab2739774232953d4f7ae3c9f77ac206">AddDeltaActualUnconsCoarse</a>(-dTotCoarseToPoly);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                  <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot; is at the down-coast end of the coastline, actual sediment movement is DOWN-COAST. With re-circulating option this goes to up-coast coast-end polygon &quot;</span> &lt;&lt; nOtherEndPoly &lt;&lt; <span class="stringliteral">&quot;: fine = &quot;</span> &lt;&lt; dFineToPoly &lt;&lt; <span class="stringliteral">&quot; sand = &quot;</span> &lt;&lt; dSandToPoly &lt;&lt; <span class="stringliteral">&quot; coarse = &quot;</span> &lt;&lt; dCoarseToPoly &lt;&lt; endl;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;               }</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            }</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;         }</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;         {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            <span class="comment">// This isn&#39;t a coast-end polygon, so just move the sediment to the adjacent polygon</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            <a class="code" href="class_c_geom_coast_polygon.html">CGeomCoastPolygon</a>* pAdjPoly = m_VCoast[nCoast].pGetPolygon(nAdjPoly);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            pAdjPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a436b956d1e85378508b619263a62ee35">AddDeltaActualUnconsFine</a>(dFineToPoly);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            pAdjPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a39ab4be5fcc324eba92db69597e31b42">AddDeltaActualUnconsSand</a>(dSandToPoly);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            pAdjPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aab2739774232953d4f7ae3c9f77ac206">AddDeltaActualUnconsCoarse</a>(dCoarseToPoly);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160; </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="comment">// And remove the sediment from this polygon</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a436b956d1e85378508b619263a62ee35">AddDeltaActualUnconsFine</a>(-dTotFineToPoly);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a39ab4be5fcc324eba92db69597e31b42">AddDeltaActualUnconsSand</a>(-dTotSandToPoly);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aab2739774232953d4f7ae3c9f77ac206">AddDeltaActualUnconsCoarse</a>(-dTotCoarseToPoly);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot; has sediment movement (m^3) DOWN-COAST to polygon &quot;</span> &lt;&lt; nAdjPoly &lt;&lt; <span class="stringliteral">&quot; fine = &quot;</span> &lt;&lt; dFineToPoly * m_dCellArea &lt;&lt; <span class="stringliteral">&quot; sand = &quot;</span> &lt;&lt; dSandToPoly * m_dCellArea &lt;&lt; <span class="stringliteral">&quot; coarse = &quot;</span> &lt;&lt; dCoarseToPoly * m_dCellArea &lt;&lt; endl;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;         }</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;   }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;   {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <span class="comment">// Moving eroded sediment up-coast</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <span class="keywordtype">int</span> nNumAdjPoly = pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a6bb0df831ea85fb62da1d1df60f8c0ee">nGetNumUpCoastAdjacentPolygons</a>();</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nNumAdjPoly; n++)</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;         <span class="keywordtype">int</span> nAdjPoly = pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a52ad4ee9d9013fd1616649e4c0cde407">nGetUpCoastAdjacentPolygon</a>(n);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;         <span class="keywordtype">double</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            dBoundaryShare = pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a4d40ff07551c2cf1a5404f6ec391a97a">dGetUpCoastAdjacentPolygonBoundaryShare</a>(n),</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            dFineToPoly = dTotFineEroded * dBoundaryShare,</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            dSandToPoly = dTotSandEroded * dBoundaryShare,</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            dCoarseToPoly = dTotCoarseEroded * dBoundaryShare;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;         dTotFineToPoly += dFineToPoly;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;         dTotSandToPoly += dSandToPoly;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;         dTotCoarseToPoly += dCoarseToPoly;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;         <span class="keywordflow">if</span> (nAdjPoly == <a class="code" href="cme_8h.html#aee2e0742555937187504ee86b95bc29c">INT_NODATA</a>)</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;         {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            <span class="keywordflow">if</span> (nPoly == nNumPolygons-1)</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;               <span class="comment">// This is the polygon at the down-coast end of the coastline: uncons sediment movement is up-coast but there is no adjacent polygon!</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;               <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; <a class="code" href="cme_8h.html#ab0094f1ece3facf8eb8afd210a7a7835">ERR</a> &lt;&lt; <span class="stringliteral">&quot;polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot; is at the down-coast end of the coastline, actual sediment movement is UP-COAST. But there is no adjacent coast-end polygon!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">//                return RTN_ERR_NO_ADJACENT_POLYGON;</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nPoly == 0)</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            {</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;               <span class="comment">// TEST DFM Could make this a user option: add in uncons sediment at beginning of coastline, however need to make further changes to keep maintain mass balance</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">//                pPolygon-&gt;AddDeltaActualUnconsSand(1);</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;               <span class="comment">// This is the polygon at the up-coast end of the coastline, and uncons sediment movement is up-coast. Decide what to do based on the user setting m_nUnconsSedimentHandlingAtGridEdges</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;               <span class="keywordflow">if</span> (m_nUnconsSedimentHandlingAtGridEdges == <a class="code" href="cme_8h.html#a6200ae183b054ee5f56256c5adcf2bd8">GRID_EDGE_CLOSED</a>)</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;               {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                  <span class="comment">// Closed grid edges: no sand or coarse uncons sediment moves off-grid, nothing is removed from this polygon</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                  <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: pPolygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot; is at the up-coast end of the coastline, actual sediment movement is UP-COAST. With closed grid edges, no sand or coarse unconsolidated sediment goes off-grid&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;               }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_nUnconsSedimentHandlingAtGridEdges == <a class="code" href="cme_8h.html#a175a581d557d1d54a477be9e2cb75759">GRID_EDGE_OPEN</a>)</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;               {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                  <span class="comment">// Open grid edges, so this sediment goes off-grid</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                  m_dThisTimestepActualFineSedLostBeachErosion += dFineToPoly;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                  m_dThisTimestepActualSandSedLostBeachErosion += dSandToPoly;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                  m_dThisTimestepActualCoarseSedLostBeachErosion += dCoarseToPoly;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160; </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                  <span class="comment">// Remove the sediment from this polygon</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                  pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a436b956d1e85378508b619263a62ee35">AddDeltaActualUnconsFine</a>(-dTotFineToPoly);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                  pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a39ab4be5fcc324eba92db69597e31b42">AddDeltaActualUnconsSand</a>(-dTotSandToPoly);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                  pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aab2739774232953d4f7ae3c9f77ac206">AddDeltaActualUnconsCoarse</a>(-dTotCoarseToPoly);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                  <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot; is at the up-coast end of the coastline, actual sediment movement is UP-COAST. With open grid edges, sediment goes off-grid: fine = &quot;</span> &lt;&lt; dFineToPoly &lt;&lt; <span class="stringliteral">&quot; sand = &quot;</span> &lt;&lt; dSandToPoly &lt;&lt; <span class="stringliteral">&quot; coarse = &quot;</span> &lt;&lt; dCoarseToPoly &lt;&lt; endl;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;               }</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_nUnconsSedimentHandlingAtGridEdges == <a class="code" href="cme_8h.html#a409c1bddc62b57c4c20f804212dac0e2">GRID_EDGE_RECIRCULATE</a>)</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;               {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                  <span class="comment">// Re-circulating grid edges, so send the sediment to the polygon at the down-coast end of this coastline TODO Check whether this causes mass balance problems, depending on the sequence of polygon processing</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                  <span class="keywordtype">int</span> nOtherEndPoly = nNumPolygons-1;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                  <a class="code" href="class_c_geom_coast_polygon.html">CGeomCoastPolygon</a>* pOtherEndPoly = m_VCoast[nCoast].pGetPolygon(nOtherEndPoly);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                  pOtherEndPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a436b956d1e85378508b619263a62ee35">AddDeltaActualUnconsFine</a>(dFineToPoly);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                  pOtherEndPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a39ab4be5fcc324eba92db69597e31b42">AddDeltaActualUnconsSand</a>(dSandToPoly);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                  pOtherEndPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aab2739774232953d4f7ae3c9f77ac206">AddDeltaActualUnconsCoarse</a>(dCoarseToPoly);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                  <span class="comment">// Add to the off-grid totals even tho&#39; it is not really moving off-grid</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                  m_dThisTimestepActualFineSedLostBeachErosion += dFineToPoly;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                  m_dThisTimestepActualSandSedLostBeachErosion += dSandToPoly;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                  m_dThisTimestepActualCoarseSedLostBeachErosion += dCoarseToPoly;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                  <span class="comment">// And remove the sediment from this polygon</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                  pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a436b956d1e85378508b619263a62ee35">AddDeltaActualUnconsFine</a>(-dTotFineToPoly);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                  pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a39ab4be5fcc324eba92db69597e31b42">AddDeltaActualUnconsSand</a>(-dTotSandToPoly);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                  pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aab2739774232953d4f7ae3c9f77ac206">AddDeltaActualUnconsCoarse</a>(-dTotCoarseToPoly);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                  <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot; is at the up-coast end of the coastline, actual sediment movement is UP-COAST. With re-circulating option this goes to down-coast coast-end polygon &quot;</span> &lt;&lt; nOtherEndPoly &lt;&lt; <span class="stringliteral">&quot;: fine = &quot;</span> &lt;&lt; dFineToPoly &lt;&lt; <span class="stringliteral">&quot; sand = &quot;</span> &lt;&lt; dSandToPoly &lt;&lt; <span class="stringliteral">&quot; coarse = &quot;</span> &lt;&lt; dCoarseToPoly &lt;&lt; endl;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;               }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            }</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;         }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;         {</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            <span class="comment">// This isn&#39;t a coast-end polygon, so just move the sediment to the adjacent polygon</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            <a class="code" href="class_c_geom_coast_polygon.html">CGeomCoastPolygon</a>* pAdjPoly = m_VCoast[nCoast].pGetPolygon(nAdjPoly);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            pAdjPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a436b956d1e85378508b619263a62ee35">AddDeltaActualUnconsFine</a>(dFineToPoly);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            pAdjPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a39ab4be5fcc324eba92db69597e31b42">AddDeltaActualUnconsSand</a>(dSandToPoly);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            pAdjPoly-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aab2739774232953d4f7ae3c9f77ac206">AddDeltaActualUnconsCoarse</a>(dCoarseToPoly);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            <span class="comment">// And remove the sediment from this polygon</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a436b956d1e85378508b619263a62ee35">AddDeltaActualUnconsFine</a>(-dTotFineToPoly);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#a39ab4be5fcc324eba92db69597e31b42">AddDeltaActualUnconsSand</a>(-dTotSandToPoly);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            pPolygon-&gt;<a class="code" href="class_c_geom_coast_polygon.html#aab2739774232953d4f7ae3c9f77ac206">AddDeltaActualUnconsCoarse</a>(-dTotCoarseToPoly);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            <a class="code" href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; m_ulIter &lt;&lt; <span class="stringliteral">&quot;: polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; <span class="stringliteral">&quot; has sediment movement (m^3) UP-COAST to polygon &quot;</span> &lt;&lt; nAdjPoly &lt;&lt; <span class="stringliteral">&quot; fine = &quot;</span> &lt;&lt; dFineToPoly * m_dCellArea &lt;&lt; <span class="stringliteral">&quot; sand = &quot;</span> &lt;&lt; dSandToPoly * m_dCellArea &lt;&lt; <span class="stringliteral">&quot; coarse = &quot;</span> &lt;&lt; dCoarseToPoly * m_dCellArea &lt;&lt; endl;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;         }</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      }</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;   }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">//    LogStream &lt;&lt; &quot;\tPolygon &quot; &lt;&lt; nPoly &lt;&lt; &quot; now has delta unconsolidated sediment: fine = &quot; &lt;&lt; pPolygon-&gt;dGetDeltaActualUnconsFine() &lt;&lt; &quot; sand = &quot; &lt;&lt; pPolygon-&gt;dGetDeltaActualUnconsSand() &lt;&lt; &quot; coarse = &quot; &lt;&lt; pPolygon-&gt;dGetDeltaActualUnconsCoarse() &lt;&lt; endl &lt;&lt; endl;</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="cme_8h.html#a71d8d6db0e41ed2022d0a95b9a70528c">RTN_OK</a>;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclass_c_geom_coast_polygon_html_aa53fed4b7165494360840b7bef504a3a"><div class="ttname"><a href="class_c_geom_coast_polygon.html#aa53fed4b7165494360840b7bef504a3a">CGeomCoastPolygon::nGetDownCoastAdjacentPolygon</a></div><div class="ttdeci">int nGetDownCoastAdjacentPolygon(int const) const</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00314">coast_polygon.cpp:314</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_a6bb0df831ea85fb62da1d1df60f8c0ee"><div class="ttname"><a href="class_c_geom_coast_polygon.html#a6bb0df831ea85fb62da1d1df60f8c0ee">CGeomCoastPolygon::nGetNumUpCoastAdjacentPolygons</a></div><div class="ttdeci">int nGetNumUpCoastAdjacentPolygons(void) const</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00303">coast_polygon.cpp:303</a></div></div>
<div class="ttc" id="acme_8h_html_aee2e0742555937187504ee86b95bc29c"><div class="ttname"><a href="cme_8h.html#aee2e0742555937187504ee86b95bc29c">INT_NODATA</a></div><div class="ttdeci">const int INT_NODATA</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00185">cme.h:185</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_ac0824d25b4cc838ea4381799cfc912de"><div class="ttname"><a href="class_c_geom_coast_polygon.html#ac0824d25b4cc838ea4381799cfc912de">CGeomCoastPolygon::SetDeltaEstimatedUnconsCoarse</a></div><div class="ttdeci">void SetDeltaEstimatedUnconsCoarse(double const)</div><div class="ttdoc">Sets a value for this timestep's estimate of total change in depth of coarse unconsolidated sediment ...</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00223">coast_polygon.cpp:223</a></div></div>
<div class="ttc" id="acme_8h_html_a89311a98397f9d6967d2cb10d5152d77"><div class="ttname"><a href="cme_8h.html#a89311a98397f9d6967d2cb10d5152d77">TOLERANCE</a></div><div class="ttdeci">const double TOLERANCE</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00462">cme.h:462</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_a09273914c8d276d558180faabf2c1303"><div class="ttname"><a href="class_c_geom_coast_polygon.html#a09273914c8d276d558180faabf2c1303">CGeomCoastPolygon::SetDeltaEstimatedUnconsSand</a></div><div class="ttdeci">void SetDeltaEstimatedUnconsSand(double const)</div><div class="ttdoc">Sets a value for this timestep's estimated total change in depth of sand-sized unconsolidated sedimen...</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00211">coast_polygon.cpp:211</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_aa9ef391813543b0260b2174e063d80e2"><div class="ttname"><a href="class_c_geom_coast_polygon.html#aa9ef391813543b0260b2174e063d80e2">CGeomCoastPolygon::nGetNumDownCoastAdjacentPolygons</a></div><div class="ttdeci">int nGetNumDownCoastAdjacentPolygons(void) const</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00320">coast_polygon.cpp:320</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_a39ab4be5fcc324eba92db69597e31b42"><div class="ttname"><a href="class_c_geom_coast_polygon.html#a39ab4be5fcc324eba92db69597e31b42">CGeomCoastPolygon::AddDeltaActualUnconsSand</a></div><div class="ttdeci">void AddDeltaActualUnconsSand(double const)</div><div class="ttdoc">Adds a change in erosion or deposition to this timestep's total actual change in depth of unconsolida...</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00252">coast_polygon.cpp:252</a></div></div>
<div class="ttc" id="acme_8h_html"><div class="ttname"><a href="cme_8h.html">cme.h</a></div><div class="ttdoc">This file contains global definitions for CoastalME.</div></div>
<div class="ttc" id="acoast_8h_html"><div class="ttname"><a href="coast_8h.html">coast.h</a></div><div class="ttdoc">Contains CRWCoast definitions.</div></div>
<div class="ttc" id="acme_8h_html_a6200ae183b054ee5f56256c5adcf2bd8"><div class="ttname"><a href="cme_8h.html#a6200ae183b054ee5f56256c5adcf2bd8">GRID_EDGE_CLOSED</a></div><div class="ttdeci">const int GRID_EDGE_CLOSED</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00429">cme.h:429</a></div></div>
<div class="ttc" id="aclass_c_simulation_html_a222962121613613a48f518e0c2110f21"><div class="ttname"><a href="class_c_simulation.html#a222962121613613a48f518e0c2110f21">CSimulation::LogStream</a></div><div class="ttdeci">ofstream LogStream</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00781">simulation.h:781</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_aab2739774232953d4f7ae3c9f77ac206"><div class="ttname"><a href="class_c_geom_coast_polygon.html#aab2739774232953d4f7ae3c9f77ac206">CGeomCoastPolygon::AddDeltaActualUnconsCoarse</a></div><div class="ttdeci">void AddDeltaActualUnconsCoarse(double const)</div><div class="ttdoc">Adds a change in erosion or deposition to this timestep's total actual change in depth of unconsolida...</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00269">coast_polygon.cpp:269</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html"><div class="ttname"><a href="class_c_geom_coast_polygon.html">CGeomCoastPolygon</a></div><div class="ttdoc">Geometry class used for coast polygon objects.</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8h_source.html#l00031">coast_polygon.h:31</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_a4d40ff07551c2cf1a5404f6ec391a97a"><div class="ttname"><a href="class_c_geom_coast_polygon.html#a4d40ff07551c2cf1a5404f6ec391a97a">CGeomCoastPolygon::dGetUpCoastAdjacentPolygonBoundaryShare</a></div><div class="ttdeci">double dGetUpCoastAdjacentPolygonBoundaryShare(int const) const</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00331">coast_polygon.cpp:331</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_af4f5f84ba32c7a53cfb64d1a03a89bf7"><div class="ttname"><a href="class_c_geom_coast_polygon.html#af4f5f84ba32c7a53cfb64d1a03a89bf7">CGeomCoastPolygon::dGetDeltaActualUnconsCoarse</a></div><div class="ttdeci">double dGetDeltaActualUnconsCoarse(void) const</div><div class="ttdoc">Returns this timestep's actual total change in depth of coarse unconsolidated sediment on this polygo...</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00280">coast_polygon.cpp:280</a></div></div>
<div class="ttc" id="acme_8h_html_a71d8d6db0e41ed2022d0a95b9a70528c"><div class="ttname"><a href="cme_8h.html#a71d8d6db0e41ed2022d0a95b9a70528c">RTN_OK</a></div><div class="ttdeci">const int RTN_OK</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00351">cme.h:351</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_a82b0f745264c8783d883afe5f9b15deb"><div class="ttname"><a href="class_c_geom_coast_polygon.html#a82b0f745264c8783d883afe5f9b15deb">CGeomCoastPolygon::dGetDownCoastAdjacentPolygonBoundaryShare</a></div><div class="ttdeci">double dGetDownCoastAdjacentPolygonBoundaryShare(int const) const</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00343">coast_polygon.cpp:343</a></div></div>
<div class="ttc" id="acme_8h_html_ab0094f1ece3facf8eb8afd210a7a7835"><div class="ttname"><a href="cme_8h.html#ab0094f1ece3facf8eb8afd210a7a7835">ERR</a></div><div class="ttdeci">const string ERR</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00537">cme.h:537</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_a012684fc9e6cda15517c1996f5e8f45e"><div class="ttname"><a href="class_c_geom_coast_polygon.html#a012684fc9e6cda15517c1996f5e8f45e">CGeomCoastPolygon::dGetDeltaEstimatedUnconsCoarse</a></div><div class="ttdeci">double dGetDeltaEstimatedUnconsCoarse(void) const</div><div class="ttdoc">Returns this timestep's estimate of total change in depth of coarse unconsolidated sediment on this p...</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00229">coast_polygon.cpp:229</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_aba136d4cea6530fef743214da1c177c0"><div class="ttname"><a href="class_c_geom_coast_polygon.html#aba136d4cea6530fef743214da1c177c0">CGeomCoastPolygon::dGetDeltaEstimatedUnconsFine</a></div><div class="ttdeci">double dGetDeltaEstimatedUnconsFine(void) const</div><div class="ttdoc">Returns this timestep's estimate of total change in depth of fine unconsolidated sediment on this pol...</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00205">coast_polygon.cpp:205</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_a436b956d1e85378508b619263a62ee35"><div class="ttname"><a href="class_c_geom_coast_polygon.html#a436b956d1e85378508b619263a62ee35">CGeomCoastPolygon::AddDeltaActualUnconsFine</a></div><div class="ttdeci">void AddDeltaActualUnconsFine(double const)</div><div class="ttdoc">Adds a change in erosion or deposition to this timestep's total actual change in depth of unconsolida...</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00235">coast_polygon.cpp:235</a></div></div>
<div class="ttc" id="acme_8h_html_a175a581d557d1d54a477be9e2cb75759"><div class="ttname"><a href="cme_8h.html#a175a581d557d1d54a477be9e2cb75759">GRID_EDGE_OPEN</a></div><div class="ttdeci">const int GRID_EDGE_OPEN</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00430">cme.h:430</a></div></div>
<div class="ttc" id="acme_8h_html_ab63e5883f26dfad0f0c3b7cccce87c71"><div class="ttname"><a href="cme_8h.html#ab63e5883f26dfad0f0c3b7cccce87c71">SEDIMENT_ELEV_TOLERANCE</a></div><div class="ttdeci">const double SEDIMENT_ELEV_TOLERANCE</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00463">cme.h:463</a></div></div>
<div class="ttc" id="acme_8h_html_a409c1bddc62b57c4c20f804212dac0e2"><div class="ttname"><a href="cme_8h.html#a409c1bddc62b57c4c20f804212dac0e2">GRID_EDGE_RECIRCULATE</a></div><div class="ttdeci">const int GRID_EDGE_RECIRCULATE</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00431">cme.h:431</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_a27f100b224c73c609ed36e89bfb2188d"><div class="ttname"><a href="class_c_geom_coast_polygon.html#a27f100b224c73c609ed36e89bfb2188d">CGeomCoastPolygon::dGetDeltaActualUnconsFine</a></div><div class="ttdeci">double dGetDeltaActualUnconsFine(void) const</div><div class="ttdoc">Returns this timestep's actual total change in depth of fine unconsolidated sediment on this polygon ...</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00246">coast_polygon.cpp:246</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_a1f1ec023bc3fcbf57af6ec4aa5738cd0"><div class="ttname"><a href="class_c_geom_coast_polygon.html#a1f1ec023bc3fcbf57af6ec4aa5738cd0">CGeomCoastPolygon::dGetDeltaEstimatedUnconsSand</a></div><div class="ttdeci">double dGetDeltaEstimatedUnconsSand(void) const</div><div class="ttdoc">Returns this timestep's estimate of total change in depth of sand-sized unconsolidated sediment on th...</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00217">coast_polygon.cpp:217</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_a52ad4ee9d9013fd1616649e4c0cde407"><div class="ttname"><a href="class_c_geom_coast_polygon.html#a52ad4ee9d9013fd1616649e4c0cde407">CGeomCoastPolygon::nGetUpCoastAdjacentPolygon</a></div><div class="ttdeci">int nGetUpCoastAdjacentPolygon(int const) const</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00297">coast_polygon.cpp:297</a></div></div>
<div class="ttc" id="asimulation_8h_html"><div class="ttname"><a href="simulation_8h.html">simulation.h</a></div><div class="ttdoc">Contains CSimulation definitions.</div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_ae6f4df07e5e732fe2b82a361c2ddbf5b"><div class="ttname"><a href="class_c_geom_coast_polygon.html#ae6f4df07e5e732fe2b82a361c2ddbf5b">CGeomCoastPolygon::dGetDeltaActualUnconsSand</a></div><div class="ttdeci">double dGetDeltaActualUnconsSand(void) const</div><div class="ttdoc">Returns this timestep's actual total change in depth of sand-sized unconsolidated sediment on this po...</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00263">coast_polygon.cpp:263</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_a85b82592328fd281191d00808f8d9789"><div class="ttname"><a href="class_c_geom_coast_polygon.html#a85b82592328fd281191d00808f8d9789">CGeomCoastPolygon::bDownCoastThisTimestep</a></div><div class="ttdeci">bool bDownCoastThisTimestep(void) const</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00081">coast_polygon.cpp:81</a></div></div>
<div class="ttc" id="ado__beach__actual__sediment__movement_8cpp_html_a0a8801fe3da215959bcf6352e5331b91"><div class="ttname"><a href="do__beach__actual__sediment__movement_8cpp.html#a0a8801fe3da215959bcf6352e5331b91">bPolygonAndAdjCompare</a></div><div class="ttdeci">bool bPolygonAndAdjCompare(const vector&lt; int &gt; &amp;nVLeft, const vector&lt; int &gt; &amp;nVRight)</div><div class="ttdef"><b>Definition:</b> <a href="do__beach__actual__sediment__movement_8cpp_source.html#l00048">do_beach_actual_sediment_movement.cpp:48</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_ae97ed135e92d392e9b72f83feee59b2b"><div class="ttname"><a href="class_c_geom_coast_polygon.html#ae97ed135e92d392e9b72f83feee59b2b">CGeomCoastPolygon::nGetCoastID</a></div><div class="ttdeci">int nGetCoastID(void) const</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00092">coast_polygon.cpp:92</a></div></div>
<div class="ttc" id="acme_8h_html_ae3b6dc50cfc97050529faa5e0bd66136"><div class="ttname"><a href="cme_8h.html#ae3b6dc50cfc97050529faa5e0bd66136">tAbs</a></div><div class="ttdeci">T tAbs(T a)</div><div class="ttdef"><b>Definition:</b> <a href="cme_8h_source.html#l00793">cme.h:793</a></div></div>
<div class="ttc" id="aclass_c_geom_coast_polygon_html_a933ae271f4fbbd54f765eb57087e76ed"><div class="ttname"><a href="class_c_geom_coast_polygon.html#a933ae271f4fbbd54f765eb57087e76ed">CGeomCoastPolygon::SetDeltaEstimatedUnconsFine</a></div><div class="ttdeci">void SetDeltaEstimatedUnconsFine(double const)</div><div class="ttdoc">Sets a value for this timestep's estimated total change in depth of fine unconsolidated sediment on t...</div><div class="ttdef"><b>Definition:</b> <a href="coast__polygon_8cpp_source.html#l00199">coast_polygon.cpp:199</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Dec 9 2020 19:46:12 for CoastalME (Coastal Modelling Environment) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
